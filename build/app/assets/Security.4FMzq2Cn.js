import{n as e,o as n,a as t,r as a,Z as i,d as r,F as o,j as s,I as c,T as l,a0 as d,h as m,B as h,am as u,u as p,X as g,ar as b,H as C,A as w,e as f,ao as v,aq as y}from"./index.mlCxaiYE.js";import{C as S}from"./Item.dGEOVRdT.js";import{I as k}from"./InputSelectNew.MYEDp3D-.js";import{P as j}from"./PluginIcon.pb6swma8.js";import{S as A}from"./Scene.tZk0YIWv.js";import{S as x}from"./Switch.3DOmHSIs.js";import{u as D}from"./useCurrentTeam.fRZpnoZU.js";import{c as E}from"./DocumentContext.hhTeDqBR.js";import{S as I}from"./SettingRow.96ERny3f.js";import"./InputSelectPermission.lb2lIKIy.js";import"./PopoverDisclosure.OO70kItq.js";import"./PlaceholderText.UNfhMHoO.js";import"./LoadingIndicatorBar.mGaD64ZX.js";import"./TeamLogo.qV1feKYB.js";import"./useBoolean.4JQO1FDN.js";import"./useCurrentUser.zlImhYTS.js";import"./Badge.sHfYRIgC.js";import"./Time.rp9cc_zo.js";import"./index.esm.XsAbwjVB.js";import"./usePolicy.wYF8wJNp.js";import"./SharedLayoutContext.2BBc39h7.js";const R=e("div").withConfig({componentId:"sc-134nhk8-0"})(["margin-top:6px;"]),M=n((function DomainManagement({onSuccess:e}){const n=D(),{t:p}=t(),[g,b]=a.useState([...n.allowedDomains??[]]),[C,w]=a.useState(g.length),[f,v]=a.useState(!1),y=a.useCallback((async()=>{try{await n.save({allowedDomains:g}),e(),v(!1),w(g.length)}catch(t){i.error(t.message)}}),[n,g,e]),createOnDomainChangedHandler=e=>n=>{const t=g.slice();t[e]=n.currentTarget.value,b(t);e<C&&v(!0)},S=f||g.filter((e=>""!==e)).length>C;return r(I,{label:p("Allowed domains"),name:"allowedDomains",description:p("The domains which should be allowed to create new accounts using SSO. Changing this setting does not affect existing user accounts."),children:[g.map(((e,n)=>r(o,{gap:4,children:[s(c,{id:`allowedDomains${n}`,value:e,autoFocus:!e,placeholder:"example.com",required:!0,flex:!0,onChange:createOnDomainChangedHandler(n)},n),s(R,{children:s(l,{content:p("Remove domain"),placement:"top",children:s(d,{onClick:()=>(async e=>{const n=g.filter(((n,t)=>e!==t));b(n),e<C&&v(!0)})(n),children:s(m.CloseIcon,{})})})})]},n))),r(o,{justify:"space-between",gap:4,style:{flexWrap:"wrap"},children:[g.length&&""===g[g.length-1]?s("span",{}):s(h,{type:"button",onClick:()=>{const e=[...g,""];b(e)},neutral:!0,children:g.length?s(u,{children:"Add another"}):s(u,{children:"Add a domain"})}),S&&s(h,{type:"button",onClick:y,disabled:n.isSaving,children:s(u,{children:"Save changes"})})]})]})}));const P=n((function Security(){const{authenticationProviders:e,dialogs:n}=p(),c=D(),{t:l}=t(),d=g(),[h,R]=a.useState({sharing:c.sharing,documentEmbeds:c.documentEmbeds,guestSignin:c.guestSignin,defaultUserRole:c.defaultUserRole,memberCollectionCreate:c.memberCollectionCreate,memberTeamCreate:c.memberTeamCreate,inviteRequired:c.inviteRequired}),{data:P,loading:T,request:q}=E(e.fetchPage),L=a.useMemo((()=>[{type:"item",label:l("Editor"),value:"member"},{type:"item",label:l("Viewer"),value:"viewer"}]),[l]);a.useEffect((()=>{P||T||q()}),[T,P,q]);const B=a.useMemo((()=>b((()=>{i.success(l("Settings saved"))}),250)),[l]),U=a.useCallback((async e=>{try{R((n=>({...n,...e}))),await c.save(e),B()}catch(n){i.error(n.message)}}),[c,B]),N=a.useCallback((async e=>{await U({[e.target.id]:e.target.checked})}),[U]),W=a.useCallback((async e=>{await U({defaultUserRole:e})}),[U]),V=a.useCallback((async e=>{const n={...c.preferences,[e.target.id]:e.target.checked};await U({preferences:n})}),[U,c.preferences]),F=a.useCallback((async e=>{const t=e.target.checked,a={...h,inviteRequired:t};t?n.openModal({title:l("Are you sure you want to require invites?"),content:s(S,{onSubmit:async()=>{await U(a)},savingText:`${l("Saving")}â€¦`,danger:!0,children:s(u,{defaults:"New users will first need to be invited to create an account. <em>Default role</em> and <em>Allowed domains</em> will no longer apply.",values:{authenticationMethods:c.signinMethods},components:{em:s("strong",{})}})})}):await U(a)}),[h,U,l,n,c.signinMethods]);return r(A,{title:l("Security"),icon:s(m.PadlockIcon,{}),children:[s(C,{children:l("Security")}),s(w,{as:"p",type:"secondary",children:s(u,{children:"Settings that impact the access, security, and content of your workspace."})}),s("h2",{children:l("Sign In")}),e.orderedData.filter((e=>e.isConnected)).map((e=>s(I,{label:r(o,{gap:8,align:"center",children:[s(j,{id:e.name})," ",e.displayName]}),name:e.name,description:l("Allow members to sign-in with {{ authProvider }}",{authProvider:e.displayName}),children:r(o,{align:"center",children:[s(m.CheckboxIcon,{color:e.isActive?d.accent:void 0,checked:e.isActive})," ",s(w,{as:"p",type:"secondary",children:e.isActive?l("Connected"):l("Disabled")})]})},e.name))),s(I,{label:r(o,{gap:8,align:"center",children:[s(m.EmailIcon,{})," ",l("Email")]}),name:"guestSignin",description:f.EMAIL_ENABLED?l("Allow members to sign-in using their email address"):l("The server must have SMTP configured to enable this setting"),border:!1,children:s(x,{id:"guestSignin",checked:h.guestSignin,onChange:N,disabled:!f.EMAIL_ENABLED})}),s("h2",{children:l("Access")}),s(I,{label:l("Allow users to send invites"),name:v.MembersCanInvite,description:l("Allow editors to invite other people to the workspace"),children:s(x,{id:v.MembersCanInvite,checked:c.getPreference(v.MembersCanInvite),onChange:V})}),y&&s(I,{label:l("Require invites"),name:"inviteRequired",description:l("Require members to be invited to the workspace before they can create an account using SSO."),children:s(x,{id:"inviteRequired",checked:h.inviteRequired,onChange:F})}),!h.inviteRequired&&s(I,{label:l("Default role"),name:"defaultUserRole",description:l("The default user role for new accounts. Changing this setting does not affect existing user accounts."),border:!1,children:s(k,{value:h.defaultUserRole,options:L,onChange:W,ariaLabel:l("Default role"),label:l("Default role"),hideLabel:!0,short:!0})}),s(M,{onSuccess:B}),s("h2",{children:l("Behavior")}),s(I,{label:l("Public document sharing"),name:"sharing",description:l("When enabled, documents can be shared publicly on the internet by any member of the workspace"),children:s(x,{id:"sharing",checked:h.sharing,onChange:N})}),s(I,{label:l("Viewer document exports"),name:v.ViewersCanExport,description:l("When enabled, viewers can see download options for documents"),children:s(x,{id:v.ViewersCanExport,checked:c.getPreference(v.ViewersCanExport),onChange:V})}),s(I,{label:l("Users can delete account"),name:v.MembersCanDeleteAccount,description:l("When enabled, users can delete their own account from the workspace"),children:s(x,{id:v.MembersCanDeleteAccount,checked:c.getPreference(v.MembersCanDeleteAccount),onChange:V})}),s(I,{label:l("Rich service embeds"),name:"documentEmbeds",description:l("Links to supported services are shown as rich embeds within your documents"),children:s(x,{id:"documentEmbeds",checked:h.documentEmbeds,onChange:N})}),s(I,{label:l("Collection creation"),name:"memberCollectionCreate",description:l("Allow editors to create new collections within the workspace"),children:s(x,{id:"memberCollectionCreate",checked:h.memberCollectionCreate,onChange:N})}),y&&s(I,{label:l("Workspace creation"),name:"memberTeamCreate",description:l("Allow editors to create new workspaces"),children:s(x,{id:"memberTeamCreate",checked:h.memberTeamCreate,onChange:N})})]})}));export{P as default};
