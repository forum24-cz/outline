{"version":3,"file":"Settings.5oohYv0O.js","sources":["../../../app/components/Icons/GoogleIcon.tsx","../../../plugins/googleanalytics/client/Settings.tsx"],"sourcesContent":["import * as React from \"react\";\n\ntype Props = {\n  /** The size of the icon, 24px is default to match standard icons */\n  size?: number;\n  /** The color of the icon, defaults to the current text color */\n  color?: string;\n};\n\nexport default function GoogleIcon({\n  size = 24,\n  color = \"currentColor\",\n}: Props) {\n  return (\n    <svg\n      fill={color}\n      width={size}\n      height={size}\n      viewBox=\"-8 -8 48 48\"\n      version=\"1.1\"\n    >\n      <path d=\"M32.6162791,13.9090909 L16.8837209,13.9090909 L16.8837209,20.4772727 L25.9395349,20.4772727 C25.0953488,24.65 21.5651163,27.0454545 16.8837209,27.0454545 C11.3581395,27.0454545 6.90697674,22.5636364 6.90697674,17 C6.90697674,11.4363636 11.3581395,6.95454545 16.8837209,6.95454545 C19.2627907,6.95454545 21.4116279,7.80454545 23.1,9.19545455 L28.0116279,4.25 C25.0186047,1.62272727 21.1813953,0 16.8837209,0 C7.52093023,0 0,7.57272727 0,17 C0,26.4272727 7.52093023,34 16.8837209,34 C25.3255814,34 33,27.8181818 33,17 C33,15.9954545 32.8465116,14.9136364 32.6162791,13.9090909 Z\" />\n    </svg>\n  );\n}\n","import find from \"lodash/find\";\nimport { observer } from \"mobx-react\";\nimport * as React from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useTranslation, Trans } from \"react-i18next\";\nimport { toast } from \"sonner\";\nimport { IntegrationType, IntegrationService } from \"@shared/types\";\nimport Integration from \"~/models/Integration\";\nimport SettingRow from \"~/scenes/Settings/components/SettingRow\";\nimport Button from \"~/components/Button\";\nimport Heading from \"~/components/Heading\";\nimport GoogleIcon from \"~/components/Icons/GoogleIcon\";\nimport Input from \"~/components/Input\";\nimport Scene from \"~/components/Scene\";\nimport Text from \"~/components/Text\";\nimport useStores from \"~/hooks/useStores\";\n\ntype FormData = {\n  measurementId: string;\n};\n\nfunction GoogleAnalytics() {\n  const { integrations } = useStores();\n  const { t } = useTranslation();\n\n  const integration = find(integrations.orderedData, {\n    type: IntegrationType.Analytics,\n    service: IntegrationService.GoogleAnalytics,\n  }) as Integration<IntegrationType.Analytics> | undefined;\n\n  const {\n    register,\n    reset,\n    handleSubmit: formHandleSubmit,\n    formState,\n  } = useForm<FormData>({\n    mode: \"all\",\n    defaultValues: {\n      measurementId: integration?.settings.measurementId,\n    },\n  });\n\n  React.useEffect(() => {\n    void integrations.fetchPage({\n      type: IntegrationType.Analytics,\n    });\n  }, [integrations]);\n\n  React.useEffect(() => {\n    reset({ measurementId: integration?.settings.measurementId });\n  }, [integration, reset]);\n\n  const handleSubmit = React.useCallback(\n    async (data: FormData) => {\n      try {\n        if (data.measurementId) {\n          await integrations.save({\n            id: integration?.id,\n            type: IntegrationType.Analytics,\n            service: IntegrationService.GoogleAnalytics,\n            settings: {\n              measurementId: data.measurementId,\n            },\n          });\n        } else {\n          await integration?.delete();\n        }\n\n        toast.success(t(\"Settings saved\"));\n      } catch (err) {\n        toast.error(err.message);\n      }\n    },\n    [integrations, integration, t]\n  );\n\n  return (\n    <Scene title={t(\"Google Analytics\")} icon={<GoogleIcon />}>\n      <Heading>{t(\"Google Analytics\")}</Heading>\n\n      <Text as=\"p\" type=\"secondary\">\n        <Trans>\n          Add a Google Analytics 4 measurement ID to send document views and\n          analytics from the workspace to your own Google Analytics account.\n        </Trans>\n      </Text>\n      <form onSubmit={formHandleSubmit(handleSubmit)}>\n        <SettingRow\n          label={t(\"Measurement ID\")}\n          name=\"measurementId\"\n          description={t(\n            'Create a \"Web\" stream in your Google Analytics admin dashboard and copy the measurement ID from the generated code snippet to install.'\n          )}\n          border={false}\n        >\n          <Input placeholder=\"G-XXXXXXXXX1\" {...register(\"measurementId\")} />\n        </SettingRow>\n\n        <Button type=\"submit\" disabled={formState.isSubmitting}>\n          {formState.isSubmitting ? `${t(\"Saving\")}â€¦` : t(\"Save\")}\n        </Button>\n      </form>\n    </Scene>\n  );\n}\n\nexport default observer(GoogleAnalytics);\n"],"names":["GoogleIcon","size","color","fill","width","height","viewBox","version","children","jsx","d","observer","GoogleAnalytics","integrations","useStores","t","useTranslation","integration","find","orderedData","type","IntegrationType","Analytics","service","IntegrationService","register","reset","handleSubmit","formHandleSubmit","formState","useForm","mode","defaultValues","measurementId","settings","React","fetchPage","async","data","save","id","delete","success","err","error","message","jsxs","Scene","title","icon","Heading","Text","as","Trans","onSubmit","SettingRow","label","name","description","border","Input","placeholder","Button","disabled","isSubmitting"],"mappings":"qQASA,SAAwBA,YAAWC,KACjCA,EAAO,GAAAC,MACPA,EAAQ,0BAGL,MACC,CAAAC,KAAMD,EACNE,MAAOH,EACPI,OAAQJ,EACRK,QAAQ,cACRC,QAAQ,MAERC,SAACC,EAAA,OAAK,CAAAC,EAAE,skBAGd,CCkFA,MAAeC,EAAAA,GArFf,SAASC,kBACD,MAAAC,aAAEA,GAAiBC,KACnBC,EAAEA,GAAMC,IAERC,EAAcC,EAAKL,EAAaM,YAAa,CACjDC,KAAMC,EAAgBC,UACtBC,QAASC,EAAmBZ,mBAGxBa,SACJA,EAAAA,MACAC,EACAC,aAAcC,EAAAA,UACdC,GACEC,EAAkB,CACpBC,KAAM,MACNC,cAAe,CACbC,cAAehB,GAAaiB,SAASD,iBAIzCE,EAAAA,WAAgB,KACTtB,EAAauB,UAAU,CAC1BhB,KAAMC,EAAgBC,WACvB,GACA,CAACT,IAEJsB,EAAAA,WAAgB,KACRT,EAAA,CAAEO,cAAehB,GAAaiB,SAASD,eAAe,GAC3D,CAAChB,EAAaS,IAEjB,MAAMC,EAAeQ,eACnBE,MAAOC,IACD,IACEA,EAAKL,oBACDpB,EAAa0B,KAAK,CACtBC,GAAIvB,GAAauB,GACjBpB,KAAMC,EAAgBC,UACtBC,QAASC,EAAmBZ,gBAC5BsB,SAAU,CACRD,cAAeK,EAAKL,uBAIlBhB,GAAawB,UAGfC,EAAAA,QAAQ3B,EAAE,yBACT4B,GACDC,EAAAA,MAAMD,EAAIE,QAClB,IAEF,CAAChC,EAAcI,EAAaF,IAI5B,OAAC+B,EAAAC,GAAMC,MAAOjC,EAAE,oBAAqBkC,KAAOxC,EAAAT,WAAA,IAC1CQ,SAAA,GAAC0C,EAAA,CAASnC,SAAEA,EAAA,sBAEXN,EAAA0C,GAAKC,GAAG,IAAIhC,KAAK,YAChBZ,SAAAC,EAAC4C,EAAK,CAAA7C,SAAA,8IAKP,OAAA,CAAK8C,SAAU1B,EAAiBD,GAC/BnB,SAAA,CAACC,EAAA8C,EAAA,CACCC,MAAOzC,EAAE,kBACT0C,KAAK,gBACLC,YAAa3C,EACX,0IAEF4C,QAAQ,EAERnD,WAACoD,EAAM,CAAAC,YAAY,kBAAmBpC,EAAS,uBAGhDqC,EAAO,CAAA1C,KAAK,SAAS2C,SAAUlC,EAAUmC,aACvCnC,SAAAA,EAAUmC,aAAe,GAAGjD,EAAE,aAAeA,EAAE,eAK1D"}