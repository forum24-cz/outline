import{a as e,d as t,z as o,j as n,n as i,h as a,C as r,L as s,ai as c,bK as d,r as l,F as h,a8 as m,o as u,u as p,c7 as f,c8 as g,s as x,X as w,c9 as I,bn as y,a1 as v,a0 as T}from"./index.mlCxaiYE.js";import{C}from"./InputSelectPermission.lb2lIKIy.js";import{b as k,O as S,T as b,a as N,u as D,v as A,w as j,x as M,y as B}from"./DocumentContext.hhTeDqBR.js";import{C as z}from"./Switch.3DOmHSIs.js";import{u as P}from"./usePolicy.wYF8wJNp.js";import{T as $}from"./Time.rp9cc_zo.js";import{u as F}from"./useCurrentUser.zlImhYTS.js";function BreadcrumbMenu({items:i}){const{t:a}=e(),r=k({modal:!0,placement:"bottom"});return t(o,{children:[n(S,{"aria-label":a("Show path to document"),...r}),n(C,{...r,"aria-label":a("Path to document"),children:n(b,{...r,items:i})})]})}const Y=i(a.GoToIcon).withConfig({componentId:"sc-1jcd735-0"})(["flex-shrink:0;fill:",";"],r("divider")),U=i(s).withConfig({componentId:"sc-1jcd735-1"})([""," "," display:flex;flex-shrink:1;min-width:0;cursor:var(--pointer);color:",";font-size:15px;height:24px;font-weight:",";margin-left:",";svg{flex-shrink:0;}&:hover{text-decoration:underline;}"],c(),d(),r("text"),(e=>e.$highlight?"500":"inherit"),(e=>e.$withIcon?"4px":"0")),L=l.forwardRef((function Breadcrumb({items:e,highlightFirstItem:o,children:i,max:a=2},r){const s=e.length,c=[...e];let d;if(s>a){const e=Math.floor(a/2);d=c.splice(e,s-a),c.splice(e,0,{to:"",type:"route",title:n(BreadcrumbMenu,{items:d})})}return t(h,{justify:"flex-start",align:"center",ref:r,children:[c.map(((e,a)=>t(l.Fragment,{children:[e.icon,e.to?n(U,{to:e.to,$withIcon:!!e.icon,$highlight:!!o&&0===a,children:e.title}):e.title,a!==c.length-1||i?n(Y,{}):null]},("string"==typeof e.to?e.to:e.to.pathname)||a))),i]})}));const V=i(m).withConfig({componentId:"sc-1c55fmh-0"})(["margin-right:2px;"]),R=i(a.GoToIcon).withConfig({componentId:"sc-1c55fmh-1"})(["width:12px;height:12px;vertical-align:middle;flex-shrink:0;fill:",";opacity:0.5;"],(e=>e.theme.textTertiary)),E=u(l.forwardRef((function DocumentBreadcrumb({document:i,children:r,onlyText:s},c){const{collections:d}=p(),{t:h}=e(),m=function useCategory(t){const{t:o}=e();return t.isDeleted?{type:"route",icon:n(a.TrashIcon,{}),title:o("Trash"),to:f()}:t.isArchived?{type:"route",icon:n(a.ArchiveIcon,{}),title:o("Archive"),to:g()}:t.template?{type:"route",icon:n(a.ShapesIcon,{}),title:o("Templates"),to:x("templates")}:null}(i),u=N(),w=i.collectionId?d.get(i.collectionId):void 0,I=P(w);let y;l.useEffect((()=>{i.loadRelations({withoutPolicies:!0})}),[i]),w&&I.readDocument?y={type:"route",title:w.name,icon:n(z,{collection:w,expanded:!0}),to:{pathname:w.path,state:{sidebarContext:u}}}:i.isCollectionDeleted&&(y={type:"route",title:h("Deleted Collection"),icon:void 0,to:""});const v=i.pathTo,T=l.useMemo((()=>{const e=[];return m&&e.push(m),y&&e.push(y),v.slice(0,-1).forEach((i=>{const a=i.title||h("Untitled");e.push({type:"route",title:i.icon?t(o,{children:[n(V,{value:i.icon,color:i.color})," ",a]}):a,to:{pathname:i.url,state:{sidebarContext:u}}})})),e}),[h,v,m,u,y]);return d.isLoaded?!0===s?t(o,{children:[w?.name,v.slice(0,-1).map((e=>t(l.Fragment,{children:[n(R,{}),e.title||h("Untitled")]},e.id)))]}):n(L,{items:T,ref:c,highlightFirstItem:!0,children:r}):null}))),Circle=({color:e,percentage:t,offset:o})=>{const i=.7*o,a=2*Math.PI*i;let r;return t&&(r=(t=t>85&&t<100?85:t)?(100-t)*a/100:0),n("circle",{r:i,cx:o,cy:o,fill:"none",stroke:r!==a?e:"",strokeWidth:2.5,strokeDasharray:a,strokeDashoffset:t?r:0,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease 0s"}})},CircularProgressBar=({percentage:e,size:o=16})=>{const i=w();e=(e=>!Number.isFinite(+e)||e<0?0:e>100?100:+e)(e);const a=Math.floor(o/2);return n(G,{width:o,height:o,children:t("g",{transform:`rotate(-90 ${a} ${a})`,children:[n(Circle,{color:i.progressBarBackground,offset:a}),e>0&&n(Circle,{color:i.accent,percentage:e,offset:a})]})})},G=i.svg.withConfig({componentId:"sc-kdggxa-0"})(["flex-shrink:0;"]);const O=i(a.DoneIcon).withConfig({componentId:"sc-8tg5pe-0"})(["margin:-1px;animation:"," 600ms;transform-origin:center center;"],(e=>e.$animated?I:"none")),q=u((function DocumentTasks({document:i}){const{tasks:a,tasksPercentage:r}=i,{t:s}=e(),c=w(),{completed:d,total:l}=a,h=d===l,m=y(h),u=function getMessage(e,t,o){return 0===o?e("{{ total }} task",{total:t,count:t}):o===t?e("{{ completed }} task done",{completed:o,count:o}):e("{{ completed }} of {{ total }} tasks",{total:t,completed:o})}(s,l,d);return t(o,{children:[d===l?n(O,{color:c.accent,size:20,$animated:h&&!1===m}):n(CircularProgressBar,{percentage:r})," ",u]})})),K=i.strong.withConfig({componentId:"sc-1hg865e-0"})(["font-weight:550;"]),W=i(h).withConfig({componentId:"sc-1hg865e-1"})(["justify-content:",";color:",";font-size:13px;white-space:nowrap;overflow:hidden;min-width:0;"],(e=>e.rtl?"flex-end":"flex-start"),r("textTertiary")),X=i.span.withConfig({componentId:"sc-1hg865e-2"})(["",""],c()),H=i.span.withConfig({componentId:"sc-1hg865e-3"})(["font-weight:",";"],(e=>e.highlight?"600":"400")),J=u((({showPublished:i,showCollection:a,showLastViewed:r,showParentDocuments:c,document:d,revision:l,children:h,replace:m,to:u,...f})=>{const{t:g}=e(),{collections:x}=p(),w=F(),{modifiedSinceViewed:I,updatedAt:y,updatedBy:v,createdAt:T,publishedAt:C,archivedAt:k,deletedAt:S,isDraft:b,lastViewedAt:N,isTasks:D,isTemplate:A}=d;if(!v)return null;const j=d.collectionId?x.get(d.collectionId):void 0,M=w.id===v.id,B=v.name;let z;z=l?t("span",{children:[l.createdBy?.id===w.id?g("You updated"):g("{{ userName }} updated",{userName:B})," ",n($,{dateTime:l.createdAt,addSuffix:!0})]}):S?t("span",{children:[M?g("You deleted"):g("{{ userName }} deleted",{userName:B})," ",n($,{dateTime:S,addSuffix:!0})]}):k?t("span",{children:[M?g("You archived"):g("{{ userName }} archived",{userName:B})," ",n($,{dateTime:k,addSuffix:!0})]}):d.sourceMetadata&&d.sourceMetadata?.importedAt&&d.sourceMetadata.importedAt>=y?t("span",{children:[d.sourceMetadata.createdByName?g("{{ userName }} updated",{userName:d.sourceMetadata.createdByName}):g("Imported")," ",n($,{dateTime:T,addSuffix:!0})]}):T===y?t("span",{children:[M?g("You created"):g("{{ userName }} created",{userName:B})," ",n($,{dateTime:y,addSuffix:!0})]}):C&&(C===y||i)?t("span",{children:[M?g("You published"):g("{{ userName }} published",{userName:B})," ",n($,{dateTime:C,addSuffix:!0})]}):t(H,{highlight:I&&!M,children:[M?g("You updated"):g("{{ userName }} updated",{userName:B})," ",n($,{dateTime:y,addSuffix:!0})]});const P=j?j.getChildrenForDocument(d.id).length:0,Y=D&&!A;return t(W,{align:"center",rtl:"rtl"===d.dir,...f,dir:"ltr",lang:"",children:[u?n(s,{to:u,replace:m,children:z}):z,a&&j&&t("span",{children:[" ",g("in")," ",n(K,{children:n(E,{document:d,onlyText:!0})})]}),c&&P>0&&t("span",{children:[" • ",P," ",g("nested document",{count:P})]})," ",b||!r?null:N?t(X,{children:["• ",g("Viewed")," ",n($,{dateTime:N,addSuffix:!0,shorten:!0})]}):M?null:t(X,{children:["• ",n(H,{highlight:!0,children:g("Never viewed")})]}),Y&&t(o,{children:[" • ",n(q,{document:d})]}),h]})}));const Q=i(a.StarredIcon).withConfig({componentId:"sc-4291xl-0"})(["flex-shrink:0;transition:all 100ms ease-in-out;&:","{transform:scale(1.1);}&:active{transform:scale(0.95);}@media print{display:none;}"],v),Z=u((function Star({size:t,document:o,collection:i,color:r,...s}){const{t:c}=e(),d=w(),l=D({activeDocumentId:o?.id,activeCollectionId:i?.id}),h=o||i;return h?n(T,{context:l,hideOnActionDisabled:!0,tooltip:{content:h.isStarred?c("Unstar document"):c("Star document"),delay:500},action:i?i.isStarred?A:j:o?o.isStarred?M:B:void 0,size:t,...s,children:h.isStarred?n(Q,{size:t,color:d.yellow}):n(Q,{size:t,color:r??d.textTertiary,as:a.UnstarredIcon})}):null}));export{Q as A,L as B,J as D,Z as S,E as a};
