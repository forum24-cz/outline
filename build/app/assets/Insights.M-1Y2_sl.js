import{r as e,aD as t,n as a,a0 as s,C as r,a1 as o,b as i,aX as n,d as c,z as d,j as l,h as m,aY as u,o as h,u as p,a as g,aZ as f,i as y,F as b,A as j,a_ as w,a7 as x}from"./index.mlCxaiYE.js";import{A as C,a as S}from"./TeamLogo.qV1feKYB.js";import{b as I,u as T,t as z,M as B,T as M,a as v,f as N}from"./DocumentContext.hhTeDqBR.js";import{D as k}from"./DocumentViews.hDT4MR_D.js";import{L}from"./Item.dGEOVRdT.js";import{P as D}from"./Badge.sHfYRIgC.js";import{T as P}from"./Time.rp9cc_zo.js";import{u as A}from"./Switch.3DOmHSIs.js";import{u as E}from"./usePolicy.wYF8wJNp.js";import{u as V}from"./useTextStats.yvDOkpRe.js";import{C as U}from"./InputSelectPermission.lb2lIKIy.js";import{S as H}from"./SidebarLayout.Ev8iLcgK.js";import"./useBoolean.4JQO1FDN.js";import"./PlaceholderText.UNfhMHoO.js";import"./Scene.tZk0YIWv.js";import"./LoadingIndicatorBar.mGaD64ZX.js";import"./useCurrentUser.zlImhYTS.js";import"./PopoverDisclosure.OO70kItq.js";import"./index.esm.XsAbwjVB.js";import"./useCurrentTeam.fRZpnoZU.js";import"./SharedLayoutContext.2BBc39h7.js";const InsightsMenu=()=>{const e=i.useRef(null),t=I(),a=T(),s=[n(z,a)];return c(d,{children:[l(B,{...t,children:e=>l(R,{...e,children:l(m.MoreIcon,{})})}),l(U,{...t,menuRef:e,"aria-label":u("Notification"),children:l(M,{...t,items:s})})]})},R=a(s).withConfig({componentId:"sc-8y6zzu-0"})(["color:",";&:",",&:active{color:",";background:",";}"],r("textSecondary"),o,r("text"),r("sidebarControlHoverBackground"));const Z=a("div").withConfig({componentId:"sc-1ks1r8n-0"})(["margin-top:-0.5em;margin-bottom:0.5em;"]),q=a("ul").withConfig({componentId:"sc-1ks1r8n-1"})(['margin:0;padding:0;list-style:none;li:before{content:"·";display:inline-block;font-weight:600;color:',";width:10px;}"],r("textTertiary")),F=a(b).withConfig({componentId:"sc-1ks1r8n-2"})(["padding:0 16px;user-select:none;"]),O=a("h3").withConfig({componentId:"sc-1ks1r8n-3"})(["font-size:15px;"]),X=h((function Insights(){const{views:a,documents:s}=p(),{t:r}=g(),o=f(),i=y(),n=v(),m=function useTextSelection(){const[a,s]=e.useState("");return t("selectionchange",(()=>{const e=window.getSelection(),t=e?.toString();s(t??"")}),document),a}(),u=s.getByUrl(o.params.documentSlug),{editor:h}=N(),I=h?.getPlainText(),T=V(I??"",m),z=E(u),B=u?a.inDocument(u.id):[],onCloseInsights=()=>{u&&i.push({pathname:x(u),state:{sidebarContext:n}})};return A("Escape",onCloseInsights),l(H,{title:r("Insights"),onClose:onCloseInsights,children:u?l(b,{column:!0,shrink:!1,style:{minHeight:"100%"},justify:"space-between",children:c("div",{children:[c(F,{column:!0,children:[u.sourceMetadata&&c(d,{children:[l(O,{children:r("Source")}),l(j,{as:"p",type:"secondary",size:"small",children:r("Imported from {{ source }}",{source:u.sourceName??`“${u.sourceMetadata.fileName}”`})})]}),l(O,{children:r("Stats")}),l(j,{as:"p",type:"secondary",size:"small",children:c(q,{children:[T.total.words>0&&l("li",{children:r("{{ count }} minute read",{count:T.total.readingTime})}),l("li",{children:r("{{ count }} words",{count:T.total.words})}),l("li",{children:r("{{ count }} characters",{count:T.total.characters})}),l("li",{children:r("{{ number }} emoji",{number:T.total.emoji})}),0===T.selected.characters?l("li",{children:r("No text selected")}):c(d,{children:[l("li",{children:r("{{ count }} words selected",{count:T.selected.words})}),l("li",{children:r("{{ count }} characters selected",{count:T.selected.characters})})]})]})})]}),c(F,{column:!0,children:[l(O,{children:r("Contributors")}),c(j,{as:"p",type:"secondary",size:"small",children:[r("Created")," ",l(P,{dateTime:u.createdAt,addSuffix:!0}),".",l("br",{}),r("Last updated")," ",l(P,{dateTime:u.updatedAt,addSuffix:!0}),"."]}),c(Z,{children:[u.sourceMetadata?.createdByName&&l(L,{title:u.sourceMetadata?.createdByName,image:l(C,{model:{color:w(u.sourceMetadata.createdByName),avatarUrl:null,initial:u.sourceMetadata.createdByName[0]},size:S.Large}),subtitle:r("Creator"),border:!1,small:!0}),l(D,{"aria-label":r("Contributors"),items:u.collaborators,renderItem:e=>l(L,{title:e.name,image:l(C,{model:e,size:32}),subtitle:e.id===u.createdBy?.id?u.sourceMetadata?.createdByName?r("Imported"):r("Creator"):e.id===u.updatedBy?.id?r("Last edited"):r("Previously edited"),border:!1,small:!0},e.id)})]})]}),(u.insightsEnabled||z.updateInsights)&&c(F,{column:!0,children:[l(O,{children:c(b,{justify:"space-between",children:[r("Viewed by"),z.updateInsights&&l(InsightsMenu,{})]})}),u.insightsEnabled?c(d,{children:[c(j,{as:"p",type:"secondary",size:"small",children:[B.length<=1?r("No one else has viewed yet"):r("Viewed {{ count }} times by {{ teamMembers }} people",{count:B.reduce(((e,t)=>e+t.count),0),teamMembers:B.length}),"."]}),B.length>1&&l(Z,{children:l(k,{document:u,isOpen:!0})})]}):l(j,{as:"p",type:"secondary",size:"small",children:r("Viewer insights are disabled.")})]})]})}):null})}));export{X as default};
