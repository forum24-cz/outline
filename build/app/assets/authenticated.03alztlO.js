const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ApiKeys.vtxFGv2U.js","assets/index.mlCxaiYE.js","assets/Actions.u9jjnQ1W.js","assets/Badge.sHfYRIgC.js","assets/Item.dGEOVRdT.js","assets/PlaceholderText.UNfhMHoO.js","assets/Scene.tZk0YIWv.js","assets/ApiKeyListItem.cQFjmBXo.js","assets/InputSelectPermission.lb2lIKIy.js","assets/PopoverDisclosure.OO70kItq.js","assets/useUserLocale.0OnEZJRN.js","assets/useCurrentUser.zlImhYTS.js","assets/Switch.3DOmHSIs.js","assets/DocumentContext.hhTeDqBR.js","assets/LoadingIndicatorBar.mGaD64ZX.js","assets/TeamLogo.qV1feKYB.js","assets/useBoolean.4JQO1FDN.js","assets/Time.rp9cc_zo.js","assets/index.esm.XsAbwjVB.js","assets/useCurrentTeam.fRZpnoZU.js","assets/usePolicy.wYF8wJNp.js","assets/SharedLayoutContext.2BBc39h7.js","assets/ApiKeyListItem.xmzF_RaZ.css","assets/PersonalApiKeys.ChFwNFt9.js","assets/Details.DZuCkk_e.js","assets/ButtonLink.tgoiIjKJ.js","assets/InputSelectNew.MYEDp3D-.js","assets/ImageInput.dfilRqQV.js","assets/SettingRow.96ERny3f.js","assets/urls.doI9odX4.js","assets/Notice.4wB6_cwE.js","assets/routeHelpers.MPg4vHxP.js","assets/Export.jGbT5Dg_.js","assets/FileOperationListItem.vfDyquNl.js","assets/Features.bKqccryN.js","assets/Groups.NrUrJvo7.js","assets/StickyFilters.abAWg0uL.js","assets/Subheading.reqgXMWW.js","assets/Facepile.0K3TyxgD.js","assets/Import.WaAXxgEk.js","assets/OutlineIcon.Lni4fHNe.js","assets/Members._2N4ROj9.js","assets/FilterOptions.-kirZheg.js","assets/Notifications.2xVrAdSX.js","assets/Preferences.8hMJHilO.js","assets/Profile.I-u9yjlz.js","assets/Security.4FMzq2Cn.js","assets/PluginIcon.pb6swma8.js","assets/SelfHosted.AZ04syn3.js","assets/Shares.m0nQ04z8.js","assets/language.6NyDJHi_.js","assets/Templates.ONh1MLcK.js","assets/PaginatedDocumentList.j-XTHEWP.js","assets/DocumentListItem.b25IHz8z.js","assets/Star.r69PtoVf.js","assets/Highlight.XZk1WX3z.js","assets/Tabs.dkNXhqZm.js","assets/VisualElementDragControls.jrFnrF4j.js","assets/Zapier.MTZtSdhA.js","assets/Comments.HH_GK8c1.js","assets/useFocusedComment.Wp-Vuc-6.js","assets/Emoji.r_ABO2XC.js","assets/SidebarLayout.Ev8iLcgK.js","assets/History.ASukySGY.js","assets/RevisionHelper.9xLOzGQo.js","assets/revisions.HHg7AZxX.js","assets/Insights.M-1Y2_sl.js","assets/DocumentViews.hDT4MR_D.js","assets/useTextStats.yvDOkpRe.js","assets/index.oa4p8Kbs.js","assets/useCommandBarActions.tFGIorji.js","assets/settings.5EGqCYSv.js","assets/Archive.EmLCLt6O.js","assets/index.ONyROrOO.js","assets/index.njNghNAe.js","assets/InputSearchPage.UJk7oQhb.js","assets/PinnedDocuments.obxtC7YS.js","assets/index.5JpVltn0.js","assets/Loading.9UhuAPJB.js","assets/cloneDeep.KovzE0Sn.js","assets/PopoverButton.AWtPNgE3.js","assets/Drafts.DKkxGZUZ.js","assets/DateFilter.aGYKA58Z.js","assets/NewDocumentMenu.Hp5TIZK_.js","assets/Home.Jf5BZVdS.js","assets/index.OBvLokf1.js","assets/index.P37c2iVQ.js"])))=>i.map(i=>d[i]);
import{o as e,i as t,k as n,w as r,aZ as o,a as i,u as s,r as a,j as c,F as l,aK as u,aQ as d,bE as h,a7 as p,eO as f,Z as g,d as m,aJ as v,H as y,am as b,aM as D,aS as w,n as I,I as C,fU as S,fV as E,T,z as k,A as O,L as _,B as x,h as A,bv as P,P as R,Q as N,C as j,D as L,a_ as M,bn as F,cd as B,bx as $,a8 as H,X as U,fW as q,b1 as W,e as z,ap as V,V as K,s as Y,fX as G,p as X,d4 as Z,aX as J,d2 as Q,fY as ee,fZ as te,f_ as ne,b as re,f$ as oe,x as ie,a2 as se,aH as ae,cz as ce,aI as le,a0 as ue,eJ as de,g0 as he,fi as pe,E as fe,aD as ge,bw as me,g1 as ve,c8 as ye,g2 as be,g3 as De,g4 as we,bm as Ie,bj as Ce,b9 as Se,bS as Ee,c7 as Te,bt as ke,bs as Oe,v as _e,al as xe,ah as Ae,N as Pe,ak as Re,d6 as Ne,cA as je,g5 as Le,dj as Me,g as Fe,_ as Be,g6 as $e,aq as He,aA as Ue,K as qe,M as We,U as ze,ao as Ve,aW as Ke,m as Ye,S as Ge,$ as Xe,g7 as Ze,eS as Je,c$ as Qe,bF as et,as as tt,b0 as nt,a$ as rt,ch as ot,bZ as it,f as st,R as at}from"./index.mlCxaiYE.js";import{aH as ct,e as lt,aM as ut,a7 as dt,b as ht,u as pt,s as ft,aN as gt,aO as mt,M as vt,T as yt,c as bt,aP as Dt,w as wt,v as It,aQ as Ct,aR as St,X as Et,aS as Tt,aT as kt,aU as Ot,aV as _t,aW as xt,O as At,aX as Pt,U as Rt,S as Nt,D as jt,a as Lt,aY as Mt,aZ as Ft,a_ as Bt,a$ as $t,b0 as Ht,b1 as Ut,h as qt,j as Wt,l as zt,k as Vt,m as Kt,b2 as Yt,A as Gt,n as Xt,aw as Zt,L as Jt,N as Qt,E as en}from"./DocumentContext.hhTeDqBR.js";import{u as tn}from"./useCurrentUser.zlImhYTS.js";import{g as nn,C as rn}from"./InputSelectPermission.lb2lIKIy.js";import{u as sn}from"./useCurrentTeam.fRZpnoZU.js";import{u as an}from"./usePolicy.wYF8wJNp.js";import{C as cn}from"./Item.dGEOVRdT.js";import{u as ln}from"./index.esm.XsAbwjVB.js";import{B as un,n as dn}from"./urls.doI9odX4.js";import{N as hn}from"./Notice.4wB6_cwE.js";import{T as pn}from"./TeamLogo.qV1feKYB.js";import{W as gn,P as mn,B as vn,w as yn}from"./Badge.sHfYRIgC.js";import{C as bn,u as Dn}from"./Switch.3DOmHSIs.js";import{u as wn}from"./useBoolean.4JQO1FDN.js";import{L as In}from"./LoadingIndicatorBar.mGaD64ZX.js";import{P as Cn}from"./PlaceholderText.UNfhMHoO.js";import{B as Sn}from"./ButtonLink.tgoiIjKJ.js";import{i as En}from"./routeHelpers.MPg4vHxP.js";const Tn=e((function DocumentNew({template:e}){const m=t(),v=n(),y=r(),b=tn(),D=o(),{t:w}=i(),{documents:I,collections:C}=s(),S=D.params.id||y.get("collectionId");return a.useEffect((()=>{!async function createDocument(){const t=y.get("parentDocumentId")??void 0,n=t?I.get(t):void 0;let r;try{S&&(r=await C.fetch(S));const o=await I.create({collectionId:r?.id,parentDocumentId:t,fullWidth:n?.fullWidth||b.getPreference(d.FullWidthDocuments),templateId:y.get("templateId")??void 0,template:e,title:y.get("title")??"",data:h.getEmptyDocument()},{publish:!(!r?.id&&!t)||void 0});m.replace(e||!b.separateEditMode?p(o):f(o),v.state)}catch(o){g.error(w("Couldn’t create the document, try again?")),m.goBack()}}()})),c(l,{column:!0,auto:!0,children:c(u,{children:c(ct,{})})})})),kn=e((()=>{const{t:e}=i(),{auth:t}=s();return m(u,{children:[c(v,{title:e("Your account has been suspended")}),m(y,{children:[c("span",{role:"img","aria-label":e("Warning Sign"),children:"⚠️"})," ",e("Your account has been suspended")]}),c("p",{children:c(b,{defaults:"A workspace admin (<em>{{ suspendedContactEmail }}</em>) has suspended your account. To re-activate your account, please reach out to them directly.",values:{suspendedContactEmail:t.suspendedContactEmail},components:{em:c("strong",{})}})})]})})),On=a.createContext({dragDropManager:void 0});function formatProdErrorMessage(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var _n="function"==typeof Symbol&&Symbol.observable||"@@observable",xn=function randomString2(){return Math.random().toString(36).substring(7).split("").join(".")},An={INIT:"@@redux/INIT"+xn(),REPLACE:"@@redux/REPLACE"+xn(),PROBE_UNKNOWN_ACTION:function PROBE_UNKNOWN_ACTION(){return"@@redux/PROBE_UNKNOWN_ACTION"+xn()}};function createStore(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(formatProdErrorMessage(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(formatProdErrorMessage(1));return n(createStore)(e,t)}if("function"!=typeof e)throw new Error(formatProdErrorMessage(2));var o=e,i=t,s=[],a=s,c=!1;function ensureCanMutateNextListeners(){a===s&&(a=s.slice())}function getState(){if(c)throw new Error(formatProdErrorMessage(3));return i}function subscribe(e){if("function"!=typeof e)throw new Error(formatProdErrorMessage(4));if(c)throw new Error(formatProdErrorMessage(5));var t=!0;return ensureCanMutateNextListeners(),a.push(e),function unsubscribe(){if(t){if(c)throw new Error(formatProdErrorMessage(6));t=!1,ensureCanMutateNextListeners();var n=a.indexOf(e);a.splice(n,1),s=null}}}function dispatch(e){if(!function isPlainObject(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(formatProdErrorMessage(7));if(void 0===e.type)throw new Error(formatProdErrorMessage(8));if(c)throw new Error(formatProdErrorMessage(9));try{c=!0,i=o(i,e)}finally{c=!1}for(var t=s=a,n=0;n<t.length;n++){(0,t[n])()}return e}return dispatch({type:An.INIT}),(r={dispatch:dispatch,subscribe:subscribe,getState:getState,replaceReducer:function replaceReducer(e){if("function"!=typeof e)throw new Error(formatProdErrorMessage(10));o=e,dispatch({type:An.REPLACE})}})[_n]=function observable2(){var e,t=subscribe;return(e={subscribe:function subscribe2(e){if("object"!=typeof e||null===e)throw new Error(formatProdErrorMessage(11));function observeState(){e.next&&e.next(getState())}return observeState(),{unsubscribe:t(observeState)}}})[_n]=function(){return this},e},r}function invariant(e,t,...n){if(function isProduction(){return"undefined"!=typeof process&&!0}()&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let r=0;e=new Error(t.replace(/%s/g,(function(){return n[r++]}))),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function isObject$2(e){return"object"==typeof e}const Pn="dnd-core/INIT_COORDS",Rn="dnd-core/BEGIN_DRAG",Nn="dnd-core/PUBLISH_DRAG_SOURCE",jn="dnd-core/HOVER",Ln="dnd-core/DROP",Mn="dnd-core/END_DRAG";function setClientOffset(e,t){return{type:Pn,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}const Fn={type:Pn,payload:{clientOffset:null,sourceClientOffset:null}};function createBeginDrag(e){return function beginDrag(t=[],n={publishSource:!0}){const{publishSource:r=!0,clientOffset:o,getSourceClientOffset:i}=n,s=e.getMonitor(),a=e.getRegistry();e.dispatch(setClientOffset(o)),function verifyInvariants$1(e,t,n){invariant(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){invariant(n.getSource(e),"Expected sourceIds to be registered.")}))}(t,s,a);const c=function getDraggableSource(e,t){let n=null;for(let r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,s);if(null==c)return void e.dispatch(Fn);let l=null;if(o){if(!i)throw new Error("getSourceClientOffset must be defined");!function verifyGetSourceClientOffsetIsFunction(e){invariant("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(i),l=i(c)}e.dispatch(setClientOffset(o,l));const u=a.getSource(c).beginDrag(s,c);if(null==u)return;!function verifyItemIsObject(e){invariant(isObject$2(e),"Item must be an object.")}(u),a.pinSource(c);const d=a.getSourceType(c);return{type:Rn,payload:{itemType:d,item:u,sourceId:c,clientOffset:o||null,sourceClientOffset:l||null,isSourcePublic:!!r}}}}function _defineProperty$6(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_defineProperty$6(e,t,n[t])}))}return e}function createDrop(e){return function drop(t={}){const n=e.getMonitor(),r=e.getRegistry();!function verifyInvariants(e){invariant(e.isDragging(),"Cannot call drop while not dragging."),invariant(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);const o=function getDroppableTargets(e){const t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);o.forEach(((o,i)=>{const s=function determineDropResult(e,t,n,r){const o=n.getTarget(e);let i=o?o.drop(r,e):void 0;(function verifyDropResultType(e){invariant(void 0===e||isObject$2(e),"Drop result must either be an object or undefined.")})(i),void 0===i&&(i=0===t?{}:r.getDropResult());return i}(o,i,r,n),a={type:Ln,payload:{dropResult:_objectSpread$6({},t,s)}};e.dispatch(a)}))}}function createEndDrag(e){return function endDrag(){const t=e.getMonitor(),n=e.getRegistry();!function verifyIsDragging(e){invariant(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);const r=t.getSourceId();if(null!=r){n.getSource(r,!0).endDrag(t,r),n.unpinSource()}return{type:Mn}}}function matchesType(e,t){return null===t?null===e:Array.isArray(e)?e.some((e=>e===t)):e===t}function createHover(e){return function hover(t,{clientOffset:n}={}){!function verifyTargetIdsIsArray(e){invariant(Array.isArray(e),"Expected targetIds to be an array.")}(t);const r=t.slice(0),o=e.getMonitor(),i=e.getRegistry();return function removeNonMatchingTargetIds(e,t,n){for(let r=e.length-1;r>=0;r--){const o=e[r];matchesType(t.getTargetType(o),n)||e.splice(r,1)}}(r,i,o.getItemType()),function checkInvariants(e,t,n){invariant(t.isDragging(),"Cannot call hover while not dragging."),invariant(!t.didDrop(),"Cannot call hover after drop.");for(let r=0;r<e.length;r++){const t=e[r];invariant(e.lastIndexOf(t)===r,"Expected targetIds to be unique in the passed array.");invariant(n.getTarget(t),"Expected targetIds to be registered.")}}(r,o,i),function hoverAllTargets(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}(r,o,i),{type:jn,payload:{targetIds:r,clientOffset:n||null}}}}function createPublishDragSource(e){return function publishDragSource(){if(e.getMonitor().isDragging())return{type:Nn}}}class DragDropManagerImpl{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:t}=this.store;const n=function createDragDropActions(e){return{beginDrag:createBeginDrag(e),publishDragSource:createPublishDragSource(e),hover:createHover(e),drop:createDrop(e),endDrag:createEndDrag(e)}}(this);return Object.keys(n).reduce(((r,o)=>{const i=n[o];return r[o]=function bindActionCreator(n){return(...r)=>{const o=n.apply(e,r);void 0!==o&&t(o)}}(i),r}),{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function subtract(e,t){return{x:e.x-t.x,y:e.y-t.y}}const Bn=[],$n=[];Bn.__IS_NONE__=!0,$n.__IS_ALL__=!0;class DragDropMonitorImpl{subscribeToStateChange(e,t={}){const{handlerIds:n}=t;invariant("function"==typeof e,"listener must be a function."),invariant(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let r=this.store.getState().stateId;return this.store.subscribe((()=>{const t=this.store.getState(),o=t.stateId;try{const i=o===r||o===r+1&&!function areDirty(e,t){return e!==Bn&&(e===$n||void 0===t||function intersection(e,t){return e.filter((e=>t.indexOf(e)>-1))}(t,e).length>0)}(t.dirtyHandlerIds,n);i||e()}finally{r=o}}))}subscribeToOffsetChange(e){invariant("function"==typeof e,"listener must be a function.");let t=this.store.getState().dragOffset;return this.store.subscribe((()=>{const n=this.store.getState().dragOffset;n!==t&&(t=n,e())}))}canDragSource(e){if(!e)return!1;const t=this.registry.getSource(e);return invariant(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()&&t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const t=this.registry.getTarget(e);if(invariant(t,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;return matchesType(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const t=this.registry.getSource(e,!0);if(invariant(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;return this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}isOverTarget(e,t={shallow:!1}){if(!e)return!1;const{shallow:n}=t;if(!this.isDragging())return!1;const r=this.registry.getTargetType(e),o=this.getItemType();if(o&&!matchesType(r,o))return!1;const i=this.getTargetIds();if(!i.length)return!1;const s=i.indexOf(e);return n?s===i.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function getSourceClientOffset(e){const{clientOffset:t,initialClientOffset:n,initialSourceClientOffset:r}=e;return t&&n&&r?subtract(function add(e,t){return{x:e.x+t.x,y:e.y+t.y}}(t,r),n):null}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function getDifferenceFromInitialOffset(e){const{clientOffset:t,initialClientOffset:n}=e;return t&&n?subtract(t,n):null}(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}const Hn="undefined"!=typeof global?global:self,Un=Hn.MutationObserver||Hn.WebKitMutationObserver;function makeRequestCallFromTimer(e){return function requestCall(){const t=setTimeout(handleTimer,0),n=setInterval(handleTimer,50);function handleTimer(){clearTimeout(t),clearInterval(n),e()}}}const qn="function"==typeof Un?function makeRequestCallFromMutationObserver(e){let t=1;const n=new Un(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function requestCall(){t=-t,r.data=t}}:makeRequestCallFromTimer;class RawTask{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const Wn=new class AsapQueue{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=qn(this.flush),this.requestErrorThrow=makeRequestCallFromTimer((()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()}))}},zn=new class TaskFactory{create(e){const t=this.freeTasks,n=t.length?t.pop():new RawTask(this.onError,(e=>t[t.length]=e));return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(Wn.registerPendingError);const Vn="dnd-core/ADD_SOURCE",Kn="dnd-core/ADD_TARGET",Yn="dnd-core/REMOVE_SOURCE",Gn="dnd-core/REMOVE_TARGET";function validateType(e,t){t&&Array.isArray(e)?e.forEach((e=>validateType(e,!1))):invariant("string"==typeof e||"symbol"==typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var Xn,Zn;(Zn=Xn||(Xn={})).SOURCE="SOURCE",Zn.TARGET="TARGET";let Jn=0;function getNextHandlerId(e){const t=function getNextUniqueId(){return Jn++}().toString();switch(e){case Xn.SOURCE:return`S${t}`;case Xn.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${e}`)}}function parseRoleFromHandlerId(e){switch(e[0]){case"S":return Xn.SOURCE;case"T":return Xn.TARGET;default:throw new Error(`Cannot parse handler ID: ${e}`)}}function mapContainsValue(e,t){const n=e.entries();let r=!1;do{const{done:e,value:[,o]}=n.next();if(o===t)return!0;r=!!e}while(!r);return!1}class HandlerRegistryImpl{addSource(e,t){validateType(e),function validateSourceContract(e){invariant("function"==typeof e.canDrag,"Expected canDrag to be a function."),invariant("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),invariant("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);const n=this.addHandler(Xn.SOURCE,e,t);return this.store.dispatch(function addSource(e){return{type:Vn,payload:{sourceId:e}}}(n)),n}addTarget(e,t){validateType(e,!0),function validateTargetContract(e){invariant("function"==typeof e.canDrop,"Expected canDrop to be a function."),invariant("function"==typeof e.hover,"Expected hover to be a function."),invariant("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);const n=this.addHandler(Xn.TARGET,e,t);return this.store.dispatch(function addTarget(e){return{type:Kn,payload:{targetId:e}}}(n)),n}containsHandler(e){return mapContainsValue(this.dragSources,e)||mapContainsValue(this.dropTargets,e)}getSource(e,t=!1){invariant(this.isSourceId(e),"Expected a valid source ID.");return t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return invariant(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return invariant(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return invariant(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return parseRoleFromHandlerId(e)===Xn.SOURCE}isTargetId(e){return parseRoleFromHandlerId(e)===Xn.TARGET}removeSource(e){invariant(this.getSource(e),"Expected an existing source."),this.store.dispatch(function removeSource(e){return{type:Yn,payload:{sourceId:e}}}(e)),function asap(e){Wn.enqueueTask(zn.create(e))}((()=>{this.dragSources.delete(e),this.types.delete(e)}))}removeTarget(e){invariant(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function removeTarget(e){return{type:Gn,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const t=this.getSource(e);invariant(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){invariant(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,n){const r=getNextHandlerId(e);return this.types.set(r,t),e===Xn.SOURCE?this.dragSources.set(r,n):e===Xn.TARGET&&this.dropTargets.set(r,n),r}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const strictEquality=(e,t)=>e===t;function reduce$5(e=Bn,t){switch(t.type){case jn:break;case Vn:case Kn:case Gn:case Yn:return Bn;default:return $n}const{targetIds:n=[],prevTargetIds:r=[]}=t.payload,o=function xor(e,t){const n=new Map,insertItem=e=>{n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(insertItem),t.forEach(insertItem);const r=[];return n.forEach(((e,t)=>{1===e&&r.push(t)})),r}(n,r);if(!(o.length>0||!function areArraysEqual(e,t,n=strictEquality){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(n,r)))return Bn;const i=r[r.length-1],s=n[n.length-1];return i!==s&&(i&&o.push(i),s&&o.push(s)),o}function _defineProperty$5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Qn={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function reduce$4(e=Qn,t){const{payload:n}=t;switch(t.type){case Pn:case Rn:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case jn:return function areCoordsEqual(e,t){return!e&&!t||!(!e||!t)&&e.x===t.x&&e.y===t.y}(e.clientOffset,n.clientOffset)?e:function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_defineProperty$5(e,t,n[t])}))}return e}({},e,{clientOffset:n.clientOffset});case Mn:case Ln:return Qn;default:return e}}function _defineProperty$4(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_defineProperty$4(e,t,n[t])}))}return e}const er={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function reduce$3(e=er,t){const{payload:n}=t;switch(t.type){case Rn:return _objectSpread$4({},e,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case Nn:return _objectSpread$4({},e,{isSourcePublic:!0});case jn:return _objectSpread$4({},e,{targetIds:n.targetIds});case Gn:return-1===e.targetIds.indexOf(n.targetId)?e:_objectSpread$4({},e,{targetIds:(r=e.targetIds,o=n.targetId,r.filter((e=>e!==o)))});case Ln:return _objectSpread$4({},e,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case Mn:return _objectSpread$4({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}var r,o}function reduce$2(e=0,t){switch(t.type){case Vn:case Kn:return e+1;case Yn:case Gn:return e-1;default:return e}}function reduce$1(e=0){return e+1}function _defineProperty$3(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_defineProperty$3(e,t,n[t])}))}return e}function reduce(e={},t){return{dirtyHandlerIds:reduce$5(e.dirtyHandlerIds,{type:t.type,payload:_objectSpread$3({},t.payload,{prevTargetIds:(n=e,r="dragOperation.targetIds",o=[],r.split(".").reduce(((e,t)=>e&&e[t]?e[t]:o||null),n))})}),dragOffset:reduce$4(e.dragOffset,t),refCount:reduce$2(e.refCount,t),dragOperation:reduce$3(e.dragOperation,t),stateId:reduce$1(e.stateId)};var n,r,o}function createDragDropManager(e,t=void 0,n={},r=!1){const o=function makeStoreInstance(e){const t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return createStore(reduce,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(r),i=new DragDropMonitorImpl(o,new HandlerRegistryImpl(o)),s=new DragDropManagerImpl(o,i),a=e(s,t,n);return s.receiveBackend(a),s}function _objectWithoutProperties$1(e,t){if(null==e)return{};var n,r,o=function _objectWithoutPropertiesLoose$1(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}let tr=0;const nr=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var rr=a.memo((function DndProvider2(e){var{children:t}=e,n=_objectWithoutProperties$1(e,["children"]);const[r,o]=function getDndContextValue(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}const t=function createSingletonDndContext(e,t=getGlobalContext(),n,r){const o=t;o[nr]||(o[nr]={dragDropManager:createDragDropManager(e,t,n,r)});return o[nr]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(n);return a.useEffect((()=>{if(o){const e=getGlobalContext();return++tr,()=>{0==--tr&&(e[nr]=null)}}}),[]),c(On.Provider,{value:r,children:t})}));function getGlobalContext(){return"undefined"!=typeof global?global:window}const or=D((function equal(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var n,r,o;if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!equal(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if((n=(o=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!Object.prototype.hasOwnProperty.call(t,o[r]))return!1;for(r=n;0!=r--;){var i=o[r];if(!equal(e[i],t[i]))return!1}return!0}return e!=e&&t!=t})),ir="undefined"!=typeof window?a.useLayoutEffect:a.useEffect;function useCollector(e,t,n){const[r,o]=a.useState((()=>t(e))),i=a.useCallback((()=>{const i=t(e);or(r,i)||(o(i),n&&n())}),[r,e,n]);return ir(i),[r,i]}function useCollectedProps(e,t,n){return function useMonitorOutput(e,t,n){const[r,o]=useCollector(e,t,n);return ir((function subscribeToMonitorStateChange(){const t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(o,{handlerIds:[t]})}),[e,o]),r}(t,e||(()=>({})),(()=>n.reconnect()))}function useOptionalFactory(e,t){const n=[...t||[]];return null==t&&"function"!=typeof e&&n.push(e),a.useMemo((()=>"function"==typeof e?e():e),n)}function useConnectDragSource(e){return a.useMemo((()=>e.hooks.dragSource()),[e])}function useConnectDragPreview(e){return a.useMemo((()=>e.hooks.dragPreview()),[e])}let sr=!1,ar=!1;class DragSourceMonitorImpl{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){invariant(!sr,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return sr=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{sr=!1}}isDragging(){if(!this.sourceId)return!1;invariant(!ar,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return ar=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{ar=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let cr=!1;class DropTargetMonitorImpl{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;invariant(!cr,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return cr=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{cr=!1}}isOver(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function shallowEqual(e,t,n,r){let o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;const i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;const a=Object.prototype.hasOwnProperty.bind(t);for(let c=0;c<i.length;c++){const s=i[c];if(!a(s))return!1;const l=e[s],u=t[s];if(o=n?n.call(r,l,u,s):void 0,!1===o||void 0===o&&l!==u)return!1}return!0}function isRef(e){return null!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function wrapHookToRecognizeElement(e){return(t=null,n=null)=>{if(!a.isValidElement(t)){const r=t;return e(r,n),r}const r=t;!function throwIfCompositeComponentElement(e){if("string"==typeof e.type)return;const t=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}(r);return function cloneWithRef(e,t){const n=e.ref;return invariant("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?a.cloneElement(e,{ref:e=>{setRef(n,e),setRef(t,e)}}):a.cloneElement(e,{ref:t})}(r,n?t=>e(t,n):e)}}function wrapConnectorHooks(e){const t={};return Object.keys(e).forEach((n=>{const r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{const e=wrapHookToRecognizeElement(r);t[n]=()=>e}})),t}function setRef(e,t){"function"==typeof e?e(t):e.current=t}class SourceConnector{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){const t=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();n&&this.disconnectDragPreview(),this.handlerId&&(t?n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!shallowEqual(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!shallowEqual(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=wrapConnectorHooks({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,isRef(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,isRef(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class TargetConnector{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!shallowEqual(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=wrapConnectorHooks({dropTarget:(e,t)=>{this.clearDropTarget(),this.dropTargetOptions=t,isRef(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function useDragDropManager(){const{dragDropManager:e}=a.useContext(On);return invariant(null!=e,"Expected drag drop context"),e}class DragSourceImpl{beginDrag(){const e=this.spec,t=this.monitor;let n=null;return n="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{},null!=n?n:null}canDrag(){const e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){const n=this.spec,r=this.monitor,{isDragging:o}=n;return o?o(r):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,n=this.connector,{end:r}=e;r&&r(t.getItem(),t),n.reconnect()}constructor(e,t,n){this.spec=e,this.monitor=t,this.connector=n}}function useRegisteredDragSource(e,t,n){const r=useDragDropManager(),o=function useDragSource(e,t,n){const r=a.useMemo((()=>new DragSourceImpl(e,t,n)),[t,n]);return a.useEffect((()=>{r.spec=e}),[e]),r}(e,t,n),i=function useDragType(e){return a.useMemo((()=>{const t=e.type;return invariant(null!=t,"spec.type must be defined"),t}),[e])}(e);ir((function registerDragSource(){if(null!=i){const[e,s]=function registerSource(e,t,n){const r=n.getRegistry(),o=r.addSource(e,t);return[o,()=>r.removeSource(o)]}(i,o,r);return t.receiveHandlerId(e),n.receiveHandlerId(e),s}}),[r,t,n,o,i])}function useDrag(e,t){const n=useOptionalFactory(e,t);invariant(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=function useDragSourceMonitor(){const e=useDragDropManager();return a.useMemo((()=>new DragSourceMonitorImpl(e)),[e])}(),o=function useDragSourceConnector(e,t){const n=useDragDropManager(),r=a.useMemo((()=>new SourceConnector(n.getBackend())),[n]);return ir((()=>(r.dragSourceOptions=e||null,r.reconnect(),()=>r.disconnectDragSource())),[r,e]),ir((()=>(r.dragPreviewOptions=t||null,r.reconnect(),()=>r.disconnectDragPreview())),[r,t]),r}(n.options,n.previewOptions);return useRegisteredDragSource(n,r,o),[useCollectedProps(n.collect,r,o),useConnectDragSource(o),useConnectDragPreview(o)]}function useConnectDropTarget(e){return a.useMemo((()=>e.hooks.dropTarget()),[e])}class DropTargetImpl{canDrop(){const e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}hover(){const e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){const e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function useRegisteredDropTarget(e,t,n){const r=useDragDropManager(),o=function useDropTarget(e,t){const n=a.useMemo((()=>new DropTargetImpl(e,t)),[t]);return a.useEffect((()=>{n.spec=e}),[e]),n}(e,t),i=function useAccept(e){const{accept:t}=e;return a.useMemo((()=>(invariant(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t])),[t])}(e);ir((function registerDropTarget(){const[e,s]=function registerTarget(e,t,n){const r=n.getRegistry(),o=r.addTarget(e,t);return[o,()=>r.removeTarget(o)]}(i,o,r);return t.receiveHandlerId(e),n.receiveHandlerId(e),s}),[r,t,o,n,i.map((e=>e.toString())).join("|")])}function useDrop(e,t){const n=useOptionalFactory(e,t),r=function useDropTargetMonitor(){const e=useDragDropManager();return a.useMemo((()=>new DropTargetMonitorImpl(e)),[e])}(),o=function useDropTargetConnector(e){const t=useDragDropManager(),n=a.useMemo((()=>new TargetConnector(t.getBackend())),[t]);return ir((()=>(n.dropTargetOptions=e||null,n.reconnect(),()=>n.disconnectDropTarget())),[e]),n}(n.options);return useRegisteredDropTarget(n,r,o),[useCollectedProps(n.collect,r,o),useConnectDropTarget(o)]}function memoize(e){let t=null;return()=>(null==t&&(t=e()),t)}class EnterLeaveCounter{enter(e){const t=this.entered.length;return this.entered=function union(e,t){const n=new Set,insertItem=e=>n.add(e);e.forEach(insertItem),t.forEach(insertItem);const r=[];return n.forEach((e=>r.push(e))),r}(this.entered.filter((t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e)))),[e]),0===t&&this.entered.length>0}leave(e){const t=this.entered.length;return this.entered=function without(e,t){return e.filter((e=>e!==t))}(this.entered.filter(this.isNodeInDocument),e),t>0&&0===this.entered.length}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class NativeDragSource{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach((e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get:()=>(console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null)})}))}loadDataTransfer(e){if(e){const t={};Object.keys(this.config.exposeProperties).forEach((n=>{const r=this.config.exposeProperties[n];null!=r&&(t[n]={value:r(e,this.config.matchesTypes),configurable:!0,enumerable:!0})})),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const lr="__NATIVE_FILE__",ur="__NATIVE_URL__",dr="__NATIVE_TEXT__",hr="__NATIVE_HTML__",pr=Object.freeze(Object.defineProperty({__proto__:null,FILE:lr,HTML:hr,TEXT:dr,URL:ur},Symbol.toStringTag,{value:"Module"}));function getDataFromDataTransfer(e,t,n){const r=t.reduce(((t,n)=>t||e.getData(n)),"");return null!=r?r:n}const fr={[lr]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[hr]:{exposeProperties:{html:(e,t)=>getDataFromDataTransfer(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[ur]:{exposeProperties:{urls:(e,t)=>getDataFromDataTransfer(e,t,"").split("\n"),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[dr]:{exposeProperties:{text:(e,t)=>getDataFromDataTransfer(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};function matchNativeItemType(e){if(!e)return null;const t=Array.prototype.slice.call(e.types||[]);return Object.keys(fr).filter((e=>{const n=fr[e];return!!(null==n?void 0:n.matchesTypes)&&n.matchesTypes.some((e=>t.indexOf(e)>-1))}))[0]||null}const gr=memoize((()=>/firefox/i.test(navigator.userAgent))),mr=memoize((()=>Boolean(window.safari)));class MonotonicInterpolant{interpolate(e){const{xs:t,ys:n,c1s:r,c2s:o,c3s:i}=this;let s=t.length-1;if(e===t[s])return n[s];let a,c=0,l=i.length-1;for(;c<=l;){a=Math.floor(.5*(c+l));const r=t[a];if(r<e)c=a+1;else{if(!(r>e))return n[a];l=a-1}}s=Math.max(0,l);const u=e-t[s],d=u*u;return n[s]+r[s]*u+o[s]*d+i[s]*u*d}constructor(e,t){const{length:n}=e,r=[];for(let h=0;h<n;h++)r.push(h);r.sort(((t,n)=>e[t]<e[n]?-1:1));const o=[],i=[];let s,a;for(let h=0;h<n-1;h++)s=e[h+1]-e[h],a=t[h+1]-t[h],o.push(s),i.push(a/s);const c=[i[0]];for(let h=0;h<o.length-1;h++){const e=i[h],t=i[h+1];if(e*t<=0)c.push(0);else{s=o[h];const n=o[h+1],r=s+n;c.push(3*r/((r+n)/e+(r+s)/t))}}c.push(i[i.length-1]);const l=[],u=[];let d;for(let h=0;h<c.length-1;h++){d=i[h];const e=c[h],t=1/o[h],n=e+c[h+1]-d-d;l.push((d-e-n)*t),u.push(n*t*t)}this.xs=e,this.ys=t,this.c1s=c,this.c2s=l,this.c3s=u}}function getNodeClientOffset(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return null;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}function getEventClientOffset(e){return{x:e.clientX,y:e.clientY}}function getDragPreviewOffset(e,t,n,r,o){const i=function isImageNode(e){var t;return"IMG"===e.nodeName&&(gr()||!(null===(t=document.documentElement)||void 0===t?void 0:t.contains(e)))}(t),s=getNodeClientOffset(i?e:t),a={x:n.x-s.x,y:n.y-s.y},{offsetWidth:c,offsetHeight:l}=e,{anchorX:u,anchorY:d}=r,{dragPreviewWidth:h,dragPreviewHeight:p}=function getDragPreviewSize(e,t,n,r){let o=e?t.width:n,i=e?t.height:r;return mr()&&e&&(i/=window.devicePixelRatio,o/=window.devicePixelRatio),{dragPreviewWidth:o,dragPreviewHeight:i}}(i,t,c,l),{offsetX:f,offsetY:g}=o,m=0===g||g;return{x:0===f||f?f:new MonotonicInterpolant([0,.5,1],[a.x,a.x/c*h,a.x+h-c]).interpolate(u),y:m?g:(()=>{let e=new MonotonicInterpolant([0,.5,1],[a.y,a.y/l*p,a.y+p-l]).interpolate(d);return mr()&&i&&(e+=(window.devicePixelRatio-1)*p),e})()}}class OptionsReader{get window(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}get document(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}}function _defineProperty$2(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_defineProperty$2(e,t,n[t])}))}return e}class HTML5BackendImpl{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;var t;void 0!==e&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(t=this.window)||void 0===t||t.cancelAnimationFrame(this.asyncEndDragFrameId)))}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,n){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);const handleDragStart=t=>this.handleDragStart(t,e),handleSelectStart=e=>this.handleSelectStart(e);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",handleDragStart),t.addEventListener("selectstart",handleSelectStart),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",handleDragStart),t.removeEventListener("selectstart",handleSelectStart),t.setAttribute("draggable","false")}}connectDropTarget(e,t){const handleDragEnter=t=>this.handleDragEnter(t,e),handleDragOver=t=>this.handleDragOver(t,e),handleDrop=t=>this.handleDrop(t,e);return t.addEventListener("dragenter",handleDragEnter),t.addEventListener("dragover",handleDragOver),t.addEventListener("drop",handleDrop),()=>{t.removeEventListener("dragenter",handleDragEnter),t.removeEventListener("dragover",handleDragOver),t.removeEventListener("drop",handleDrop)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return _objectSpread$2({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId();return _objectSpread$2({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(pr).some((t=>pr[t]===e))}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function createNativeDragSource(e,t){const n=fr[e];if(!n)throw new Error(`native type ${e} has no configuration`);const r=new NativeDragSource(n);return r.loadDataTransfer(t),r}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout((()=>{var e;return null===(e=this.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&getNodeClientOffset(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>Boolean(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{const e=this.currentDragSourceNode;null==e||this.isNodeInDocument(e)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=e=>{null===this.hoverRafId&&"undefined"!=typeof requestAnimationFrame&&(this.hoverRafId=requestAnimationFrame((()=>{this.monitor.isDragging()&&this.actions.hover(e||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null})))},this.cancelHover=()=>{null!==this.hoverRafId&&"undefined"!=typeof cancelAnimationFrame&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;const{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;const n=getEventClientOffset(e);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:n});const{dataTransfer:r}=e,o=matchNativeItemType(r);if(this.monitor.isDragging()){if(r&&"function"==typeof r.setDragImage){const e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),o=this.sourcePreviewNodes.get(e)||t;if(o){const{anchorX:e,anchorY:i,offsetX:s,offsetY:a}=this.getCurrentSourcePreviewNodeOptions(),c=getDragPreviewOffset(t,o,n,{anchorX:e,anchorY:i},{offsetX:s,offsetY:a});r.setDragImage(o,c.x,c.y)}}try{null==r||r.setData("application/json",{})}catch(i){}this.setCurrentDragSourceNode(e.target);const{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout((()=>this.actions.publishDragSource()),0)}else if(o)this.beginDragNativeItem(o);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=e=>{var t;(this.dragEnterTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;const{dataTransfer:n}=e,r=matchNativeItemType(n);r&&this.beginDragNativeItem(r,n)},this.handleTopDragEnter=e=>{const{dragEnterTargetIds:t}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:getEventClientOffset(e)});t.some((e=>this.monitor.canDropOnTarget(e)))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=e=>{var t;(this.dragOverTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer))},this.handleTopDragOver=e=>{const{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));this.altKeyPressed=e.altKey,this.lastClientOffset=getEventClientOffset(e),this.scheduleHover(t);(t||[]).some((e=>this.monitor.canDropOnTarget(e)))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault();this.enterLeaveCounter.leave(e.target)&&(this.isDraggingNativeItem()&&setTimeout((()=>this.endDragNativeItem()),0),this.cancelHover())},this.handleTopDropCapture=e=>{var t;(this.dropTargetIds=[],this.isDraggingNativeItem())?(e.preventDefault(),null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):matchNativeItemType(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{const{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:getEventClientOffset(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=e=>{const t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new OptionsReader(t,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new EnterLeaveCounter(this.isNodeInDocument)}}let vr;function getEmptyImage(){return vr||(vr=new Image,vr.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),vr}const yr=function createBackend(e,t,n){return new HTML5BackendImpl(e,t,n)},br=class _UserRoleHelper{static displayName(e,t){switch(e){case w.Guest:return t("Guest");case w.Viewer:return t("Viewer");case w.Member:return t("Editor");case w.Admin:return t("Admin")}}static isRoleHigher(e,t){return this.roles.indexOf(e)>this.roles.indexOf(t)}static isRoleLower(e,t){return this.roles.indexOf(e)<this.roles.indexOf(t)}static canPromote(e,t){return this.isRoleHigher(t,e.role)}static canDemote(e,t){return this.isRoleLower(t,e.role)}};br.roles=[w.Guest,w.Viewer,w.Member,w.Admin];let Dr=br;const wr=I(C).withConfig({componentId:"sc-k7l87i-0"})(["margin-bottom:-4px;min-width:0;flex-shrink:1;"]),Ir=e((function Invite({onSubmit:e}){const[t,n]=a.useState(!1),[r,o]=a.useState([{email:"",name:""}]),{users:u,collections:d}=s(),h=tn(),p=sn(),{t:f}=i(),v=function parseEmail(e){const[t,n]=e.toLowerCase().split("@");if(!n)throw new Error("Invalid email address");return{local:t,domain:n}}(h.email).domain,y=an(p),[D,I]=a.useState(w.Member),C=a.useCallback((async t=>{t.preventDefault(),n(!0);try{const t=await u.invite(r.filter((e=>e.email)).map((e=>({...e,role:D}))));e(),t.length>0?g.success(f("We sent out your invites!")):g.message(f("Those email addresses are already invited"))}catch(o){g.error(o.message)}finally{n(!1)}}),[e,r,D,f,u]),P=a.useCallback(((e,t)=>{o((n=>{const r=[...n];return r[t][e.target.name]=e.target.value,r}))}),[]),R=a.useCallback((()=>{r.length>=S.maxInvitesPerRequest&&g.message(f("Sorry, you can only send {{MAX_INVITES}} invites at a time",{MAX_INVITES:S.maxInvitesPerRequest})),o((e=>{const t=[...e];return t.push({email:"",name:""}),t}))}),[r,f]),N=a.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),R())}),[R]),j=E(D),L=d.nonPrivate.length,M=L?m("span",{children:[m(b,{children:["Invited ",{roleName:j}," will receive access to"]})," ",c(T,{content:c(k,{children:d.nonPrivate.map((e=>c("li",{children:e.name},e.id)))}),children:c("strong",{children:m(b,{children:[{collectionCount:L}," collections"]})})}),"."," "]}):void 0,F=a.useMemo((()=>{const e=[];return h.isAdmin&&e.push({label:f("Admin"),description:f("Can manage all workspace settings"),value:w.Admin}),[...e,{label:f("Editor"),description:f("Can create, edit, and delete documents"),value:w.Member},{label:f("Viewer"),description:f("Can view and comment"),value:w.Viewer}]}),[f,h]);return c("form",{onSubmit:C,children:m(l,{gap:8,column:!0,children:[p.guestSignin?m(O,{as:"p",type:"secondary",children:[c(b,{defaults:"Invite people to join your workspace. They can sign in with {{signinMethods}} or use their email address.",values:{signinMethods:p.signinMethods}})," ",M]}):m(O,{as:"p",type:"secondary",children:[c(b,{defaults:"Invite members to join your workspace. They will need to sign in with {{signinMethods}}.",values:{signinMethods:p.signinMethods}})," ",M,y.update&&m(b,{children:["As an admin you can also"," ",c(_,{to:"/settings/security",children:"enable email sign-in"}),"."]})]}),m(l,{gap:12,column:!0,children:[c(nn,{label:f("Invite as"),ariaLabel:f("Role"),options:F,onChange:e=>I(e),value:D}),c(lt,{style:{minHeight:72,marginBottom:8},children:r.map(((e,t)=>m(l,{gap:8,children:[c(wr,{type:"email",name:"email",label:f("Email"),labelHidden:0!==t,onKeyDown:N,onChange:e=>P(e,t),placeholder:`name@${v}`,value:e.email,required:0===t,autoFocus:!0,flex:!0}),c(wr,{type:"text",name:"name",label:f("Name"),labelHidden:0!==t,onKeyDown:N,onChange:e=>P(e,t),value:e.name,required:!!e.email,flex:!0})]},t)))})]}),m(l,{justify:"space-between",children:[r.length<=S.maxInvitesPerRequest?c(x,{type:"button",onClick:R,icon:c(A.PlusIcon,{}),neutral:!0,children:f("Add another")}):null,c(x,{type:"submit",disabled:t,"data-on":"click","data-event-category":"invite","data-event-action":"sendInvites",children:t?`${f("Inviting")}…`:f("Send Invites")})]})]})})}));function UserChangeRoleDialog({user:e,role:t,onSubmit:n}){const{t:r}=i(),{users:o}=s();let a;switch(t){case w.Admin:a=r("Admins can manage the workspace and access billing.");break;case w.Member:a=r("Editors can create, edit, and comment on documents.");break;case w.Viewer:a=r("Viewers can only view and comment on documents.")}return m(cn,{onSubmit:async()=>{await o.updateRole(e,t),n()},savingText:`${r("Saving")}…`,children:[r("Are you sure you want to make {{ userName }} a {{ role }}?",{role:t,userName:e.name})," ",a]})}function UserDeleteDialog({user:e,onSubmit:t}){const{t:n}=i();return c(cn,{onSubmit:async()=>{await e.delete(),t()},submitText:n("I understand, delete"),savingText:`${n("Deleting")}…`,danger:!0,children:n("Are you sure you want to permanently delete {{ userName }}? This operation is unrecoverable, consider suspending the user instead.",{userName:e.name})})}function UserSuspendDialog({user:e,onSubmit:t}){const{t:n}=i(),{users:r}=s();return c(cn,{onSubmit:async()=>{await r.suspend(e),t()},savingText:`${n("Saving")}…`,danger:!0,children:n("Are you sure you want to suspend {{ userName }}? Suspended users will be prevented from logging in.",{userName:e.name})})}function UserChangeNameDialog({user:e,onSubmit:t}){const{t:n}=i(),[r,o]=a.useState(e.name);return c(cn,{onSubmit:async()=>{await e.save({name:r}),t()},submitText:n("Save"),savingText:`${n("Saving")}…`,disabled:!r,children:c(C,{type:"text",name:"name",label:n("New name"),onChange:e=>{o(e.target.value)},error:r?void 0:n("Name can't be empty"),value:r,autoSelect:!0,required:!0,flex:!0})})}function UserChangeEmailDialog({user:e,onSubmit:t}){const{t:n}=i(),r=tn(),[o,s]=a.useState(e.email),[l,u]=a.useState();return m(cn,{onSubmit:async()=>{try{return await P.post("/users.updateEmail",{id:e.id,email:o}),t(),g.info(r.id===e.id?n("Check your email to verify the new address."):n("The email will be changed once verified.")),!0}catch(i){return u(i.message),!1}},submitText:n("Save"),savingText:`${n("Saving")}…`,disabled:!o||o===e.email,children:[c(O,{as:"p",children:r.id===e.id?c(b,{children:"You will receive an email to verify your new address. It must be unique in the workspace."}):c(b,{children:"A confirmation email will be sent to the new address before it is changed."})}),c(C,{type:"email",name:"email",label:n("New email"),onChange:e=>{s(e.target.value)},error:o?l:n("Email can't be empty"),value:o,autoSelect:!0,required:!0,flex:!0})]})}const Cr=R({name:({t:e})=>`${e("Invite people")}…`,analyticsName:"Invite people",icon:c(A.PlusIcon,{}),keywords:"team member workspace user",section:ut,visible:()=>N.policies.abilities(N.auth.team?.id||"").inviteUser,perform:({t:e})=>{N.dialogs.openModal({title:e("Invite to workspace"),content:c(Ir,{onSubmit:N.dialogs.closeAllModals})})}}),updateUserRoleActionFactory=(e,t)=>R({name:({t:n})=>Dr.isRoleHigher(t,e.role)?`${n("Promote to {{ role }}",{role:Dr.displayName(t,n)})}…`:`${n("Demote to {{ role }}",{role:Dr.displayName(t,n)})}…`,analyticsName:"Update user role",section:ut,visible:()=>{const n=N.policies.abilities(e.id);return Dr.isRoleHigher(t,e.role)?n.promote:!!Dr.isRoleLower(t,e.role)&&n.demote},perform:({t:n})=>{N.dialogs.openModal({title:n("Update role"),content:c(UserChangeRoleDialog,{user:e,role:t,onSubmit:N.dialogs.closeAllModals})})}}),deleteUserActionFactory=e=>R({name:({t:e})=>`${e("Delete user")}…`,analyticsName:"Delete user",keywords:"leave",dangerous:!0,section:ut,visible:()=>N.policies.abilities(e).delete,perform:({t:t})=>{const n=N.users.get(e);n&&N.dialogs.openModal({title:t("Delete user"),content:c(UserDeleteDialog,{user:n,onSubmit:N.dialogs.closeAllModals})})}}),Sr=[Cr];function LoginDialog(){const{t:e}=i(),{register:t,handleSubmit:n}=ln({mode:"all",defaultValues:{subdomain:""}});return m("form",{onSubmit:n((async t=>{try{await dn(t.subdomain)}catch{g.error(e("The workspace could not be found"))}})),children:[c(O,{as:"p",children:e("To continue, enter your workspace’s subdomain.")}),c(C,{autoFocus:!0,maxLength:255,autoComplete:"off",placeholder:e("subdomain"),...t("subdomain",{required:!0,pattern:/^[a-z\d-]+$/}),children:c(Er,{children:".getoutline.com"})}),c(un,{type:"submit",fullwidth:!0,children:e("Continue")})]})}const Er=I.div.withConfig({componentId:"sc-18cd8i9-0"})(["color:",";padding:0 8px 0 0;"],j("textSecondary"));const Tr=e((function TeamNew({user:e}){const{auth:t}=s(),{t:n}=i(),[r,o]=a.useState(""),[u,d]=a.useState(!1);return c(k,{children:m("form",{onSubmit:async e=>{e.preventDefault(),d(!0);try{r.trim().length>1&&await t.createTeam({name:r.trim()})}catch(n){g.error(n.message)}finally{d(!1)}},children:[c(hn,{children:c(b,{children:"Please note that workspaces are completely separated. They can have a different domain, settings, users, and billing."})}),c("p",{}),c(l,{children:c(C,{type:"text",label:n("Workspace name"),onChange:e=>{o(e.target.value)},value:r,required:!0,autoFocus:!0,flex:!0})}),m(O,{as:"p",type:"secondary",children:[c(b,{defaults:"You are creating a new workspace using your current account — <em>{{email}}</em>",values:{email:e.email},components:{em:c("strong",{})}}),"."," ",c(b,{children:"To create a workspace under another email please sign up from the homepage"})]}),c(x,{type:"submit",disabled:u||!(r.trim().length>1),children:u?`${n("Creating")}…`:n("Create")})]})})})),createTeamsList=({stores:e})=>e.auth.availableTeams?.map((e=>({id:`switch-${e.id}`,name:e.name,analyticsName:"Switch workspace",section:dt,keywords:"change switch workspace organization team",icon:function _Icon(){return c(xr,{alt:e.name,model:{initial:e.name[0],avatarUrl:e.avatarUrl,id:e.id,color:M(e.id)},size:24})},visible:({currentTeamId:t})=>t!==e.id,perform:()=>window.location.href=e.url})))??[],kr=R({name:({t:e})=>e("Switch workspace"),placeholder:({t:e})=>e("Select a workspace"),analyticsName:"Switch workspace",keywords:"change switch workspace organization team",section:dt,visible:({stores:e})=>!!e.auth.availableTeams&&e.auth.availableTeams?.length>1,children:createTeamsList}),Or=R({name:({t:e})=>`${e("New workspace")}…`,analyticsName:"New workspace",keywords:"create change switch workspace organization team",section:dt,icon:c(A.PlusIcon,{}),visible:({stores:e,currentTeamId:t})=>e.policies.abilities(t??"").createTeam,perform:({t:e,event:t,stores:n})=>{t?.preventDefault(),t?.stopPropagation();const{user:r}=n.auth;r&&n.dialogs.openModal({title:e("Create a workspace"),fullscreen:!0,content:c(Tr,{user:r})})}}),_r=R({name:({t:e})=>e("Login to workspace"),analyticsName:"Login to workspace",keywords:"change switch workspace organization team",section:dt,icon:c(A.ArrowIcon,{}),visible:()=>L.isElectron(),perform:({t:e,event:t,stores:n})=>{t?.preventDefault(),t?.stopPropagation(),n.dialogs.openModal({title:e("Login to workspace"),content:c(LoginDialog,{})})}}),xr=I(pn).withConfig({componentId:"sc-1chan0i-0"})(["border-radius:2px;border:0;"]),Ar=[kr,Or,_r],Pr=e((({children:e})=>{const t=ht({unstable_offset:[4,-4],placement:"bottom-start",modal:!0}),n=s(),{theme:r}=n.ui,o=F(r),{t:l}=i(),u=pt({isContextMenu:!0});a.useEffect((()=>{r!==o&&t.hide()}),[t,r,o]);const d=a.useMemo((()=>[...createTeamsList(u),Or,_r,ft(),gt,mt]),[u]);return m(k,{children:[c(vt,{...t,children:e}),c(rn,{...t,"aria-label":l("Account"),children:c(yt,{...t,items:void 0,actions:d})})]})}));function fractionalIndex(e,t){if(null===e&&(e=""),null!==t&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===String.fromCharCode(32)||t&&t.slice(-1)===String.fromCharCode(32))throw new Error("trailing zero");if(t){let n=0;for(;(e.charAt(n)||String.fromCharCode(32))===t.charAt(n);)n++;if(n>0)return t.slice(0,n)+fractionalIndex(e.slice(n),t.slice(n))}const n=e?e.charCodeAt(0):32,r=null!==t?t.charCodeAt(0):127;if(r-n>1){const e=Math.round(.5*(n+r));return String.fromCharCode(e)}return t&&t.length>1?t.slice(0,1):String.fromCharCode(n)+fractionalIndex(e.slice(1),null)}fractionalIndex.ZERO=32,fractionalIndex.UPPER_LIMIT=127;const Rr=D(fractionalIndex);const Nr=e((function ConfirmMoveDialog({collection:e,item:t,...n}){const{documents:r,dialogs:o,collections:a}=s(),{t:l}=i(),u=a.get(t.collectionId),d={[B.Admin]:l("manage access"),[B.ReadWrite]:l("view and edit access"),[B.Read]:l("view only access"),null:l("no access")};return c(cn,{onSubmit:async()=>{try{await r.move({documentId:t.id,collectionId:e.id,...n})}catch(i){i instanceof $?g.error(l("You do not have permission to move {{ documentName }} to the {{ collectionName }} collection",{documentName:t.title,collectionName:e.name})):g.error(i.message)}finally{o.closeAllModals()}},submitText:l("Move document"),savingText:`${l("Moving")}…`,children:c(b,{defaults:"Moving the document <em>{{ title }}</em> to the {{ newCollectionName }} collection will change permission for all workspace members from <em>{{ prevPermission }}</em> to <em>{{ newPermission }}</em>.",values:{title:t.title,prevCollectionName:u?.name,newCollectionName:e.name,prevPermission:d[u?.permission||"null"],newPermission:d[e.permission||"null"]},components:{em:c("strong",{})}})})}));function useSidebarLabelAndIcon({documentId:e,collectionId:t},n){const{collections:r,documents:o}=s(),i=n??c(A.DocumentIcon,{});if(e){const t=o.get(e);if(t)return{label:t.titleWithDefault,icon:t.icon?c(H,{value:t.icon,color:t.color??void 0}):i}}if(t){const e=r.get(t);if(e)return{label:e.name,icon:c(bn,{collection:e})}}return{label:"",icon:i}}function useHover(e,t){const n=a.useRef(),r=a.useCallback((()=>{n.current||(n.current=setTimeout((()=>{n.current=void 0,t()}),500))}),[t]),o=a.useCallback((()=>{n.current&&(clearTimeout(n.current),n.current=void 0)}),[]);return a.useEffect((()=>{const t=e.current;return t?.addEventListener("dragleave",o),()=>t?.removeEventListener("dragleave",o)}),[e,o]),r}function useDropToCreateStar(e){const t=["document","collection","userMembership","groupMembership"],{documents:n,stars:r,collections:o,userMemberships:i,groupMemberships:a}=s();return useDrop({accept:t,drop:async(t,s)=>{const c=s.getItemType();let l;l="collection"===c?o.get(t.id):"userMembership"===c?i.get(t.id)?.document:"groupMembership"===c?a.get(t.id)?.document:n.get(t.id),await(l?.star(e?.()??Rr(null,r.orderedData[0].index)))},collect:e=>({isOverCursor:!!e.isOver(),isDragging:t.includes(String(e.getItemType()))})})}function useDropToReorderStar(e){const{stars:t}=s();return useDrop({accept:"star",drop:async n=>{const r=t.get(n.id);r?.save({index:e?.()??Rr(null,t.orderedData[0].index)})},collect:e=>({isOverCursor:!!e.isOver(),isDragging:"star"===e.getItemType()})})}function useDropToChangeCollection(e,t,n){const{t:r}=i(),{documents:o,collections:a,dialogs:l}=s(),u=an(e),d=useHover(n,t);return useDrop({accept:"document",drop:async(n,i)=>{if(i.didDrop())return;const{id:s,collectionId:u}=n,d=a.get(u),h=o.get(s);if(d&&d.permission!==e.permission&&!h?.isDraft)l.openModal({title:r("Change permissions?"),content:c(Nr,{item:n,collection:e,index:0})});else try{await o.move({documentId:s,collectionId:e.id,index:0}),t()}catch(p){p instanceof $?g.error(r("You do not have permission to move {{ documentName }} to the {{ collectionName }} collection",{documentName:n.title,collectionName:e.name})):g.error(p.message)}},canDrop:()=>u.createDocument,hover:(t,n)=>{e.hasDocuments&&n.canDrop()&&n.isOver({shallow:!0})&&d()},collect:e=>({isOver:e.isOver({shallow:!0}),canDrop:e.canDrop()})})}function useDropToReparentDocument(e,t,n){const{t:r}=i(),{documents:o,collections:l,dialogs:u}=s(),d=!!e?.children.length,h=e?o.get(e.id):void 0,p=a.useMemo((()=>h?.pathTo.map((e=>e.id))),[h]),f=useHover(n,t);return useDrop({accept:"document",drop:async(n,i)=>{if(i.didDrop()||!e)return;const s=e.collectionId?l.get(e.collectionId):void 0,a=l.get(n.collectionId);if(s&&a&&a.permission!==s.permission)u.openModal({title:r("Change permissions?"),content:c(Nr,{item:n,collection:s,parentDocumentId:e.id})});else try{await o.move({documentId:n.id,parentDocumentId:e.id}),t()}catch(d){d instanceof $?g.error(r("{{ documentName }} cannot be moved within {{ parentDocumentName }}",{documentName:n.title,parentDocumentName:e.title})):g.error(d.message)}},canDrop:t=>!(!e||t.id===e.id)&&(!h||h.isActive&&!!p&&!p.includes(t.id)),hover:(e,t)=>{d&&t.canDrop()&&t.isOver({shallow:!0})&&f()},collect:e=>({isOverReparent:e.isOver({shallow:!0}),canDropToReparent:e.canDrop()})})}function useDropToReorderUserMembership(e){const{userMemberships:t}=s(),n=tn();return useDrop({accept:"userMembership",drop:async r=>{const o=t.get(r.id);o?.save({index:e?.()??Rr(null,n.documentMemberships[0].index)})},collect:e=>({isOverCursor:!!e.isOver(),isDragging:"userMembership"===e.getItemType()})})}const jr=I.input.withConfig({componentId:"sc-1c673ms-0"})(["color:",";background:",";width:calc(100% + 12px);border-radius:3px;border:0;padding:5px 6px;margin:-4px;height:30px;&:focus{outline-color:",";}"],j("text"),j("background"),j("accent")),Lr=a.forwardRef((function EditableTitle({title:e,onSubmit:t,canUpdate:n,onEditing:r,onCancel:o,...i},s){const[l,u]=a.useState(i.isEditing||!1),[d,h]=a.useState(e),[p,f]=a.useState(e);a.useImperativeHandle(s,(()=>({setIsEditing:u}))),a.useEffect((()=>{f(e)}),[e]);const m=a.useCallback((e=>{f(e.target.value)}),[]),v=a.useCallback((e=>{e.preventDefault(),e.stopPropagation(),u(!0)}),[]),y=a.useCallback((e=>{e.preventDefault(),e.stopPropagation()}),[]),b=a.useCallback((e=>{e.target.select()}),[]),D=a.useCallback((async e=>{e.preventDefault(),e.stopPropagation(),u(!1);const n=p.trim();if(n===d||0===n.length)return f(d),void o?.();try{await t(n),h(n)}catch(r){throw f(d),g.error(r.message),r}}),[d,p,o,t]),w=a.useCallback((async e=>{e.nativeEvent.isComposing||("Escape"===e.key&&(u(!1),o?.(),f(d)),"Enter"===e.key&&await D(e))}),[D,o,d]);return a.useEffect((()=>{r?.(l)}),[r,l]),c(k,{children:l?c("form",{onSubmit:D,children:c(jr,{dir:"auto",type:"text",lang:"",value:p,onClick:y,onKeyDown:w,onChange:m,onBlur:D,onFocus:b,autoFocus:!0,...i})}):c("span",{onDoubleClick:n?v:void 0,className:i.className,children:p})})}));const Mr=I.label.withConfig({componentId:"sc-180j7ch-0"})(["display:flex;align-items:center;gap:16px;p{margin:0;}"]),Fr=e((function ExportDialog({collection:e,onSubmit:t}){const[n,r]=a.useState(W.MarkdownZip),[o,u]=a.useState(!0),d=tn(),{collections:h}=s(),{t:p}=i(),f=z.APP_NAME,v=a.useCallback((e=>{r(e.target.value)}),[]),y=a.useCallback((e=>{u(e.target.checked)}),[]),D=[{title:"Markdown",description:p("A ZIP file containing the images, and documents in the Markdown format."),value:W.MarkdownZip},{title:"HTML",description:p("A ZIP file containing the images, and documents as HTML files."),value:W.HTMLZip},{title:"JSON",description:p("Structured data that can be used to transfer data to another compatible {{ appName }} instance.",{appName:f}),value:W.JSON}];return m(cn,{onSubmit:async()=>{e?(await e.export(n,o),g.success(p("Export started"),{description:p("Your file will be available in {{ location }} soon",{location:`"${p("Settings")} > ${p("Export")}"`}),action:{label:p("View"),onClick:()=>{K.push(Y("export"))}}})):(await h.export(n,o),g.success(p("Export started"))),t()},submitText:p("Export"),children:[e&&m(O,{as:"p",children:[c(b,{defaults:"Exporting the collection <em>{{collectionName}}</em> may take some time.",values:{collectionName:e.name},components:{em:c("strong",{})}})," ",d.subscribedToEventType(V.ExportCompleted)&&p("You will receive an email when it's complete.")]}),c(l,{gap:12,column:!0,children:D.map((e=>m(Mr,{children:[c("input",{type:"radio",name:"format",value:e.value,checked:n===e.value,onChange:v}),m("div",{children:[c(O,{as:"p",size:"small",weight:"bold",children:e.title}),c(O,{size:"small",children:e.description})]})]},e.value)))}),c("hr",{}),m(Mr,{children:[c("input",{type:"checkbox",name:"includeAttachments",checked:o,onChange:y}),m("div",{children:[c(O,{as:"p",size:"small",weight:"bold",children:p("Include attachments")}),m(O,{size:"small",children:[p("Including uploaded images and files in the exported data"),"."]})," "]})]})]})}));const Br=e((function CollectionMenu({collection:e,label:n,modal:r=!0,placement:o,onRename:l,onOpen:u,onClose:d}){const h=ht({modal:r,placement:o}),p=sn(),{documents:f,dialogs:v,subscriptions:y}=s(),{t:b}=i(),D=t(),w=a.useRef(null),{loading:I,loaded:C,request:S}=bt((()=>y.fetchOne({collectionId:e.id,event:G.Document}))),E=a.useCallback((()=>{I||C||S()}),[I,C,S]),T=a.useCallback((()=>{v.openModal({title:b("Export collection"),content:c(Fr,{collection:e,onSubmit:v.closeAllModals})})}),[e,v,b]),O=a.useCallback((t=>{t.preventDefault(),D.push(X(e.id))}),[D,e.id]),_=a.useCallback((e=>{e.stopPropagation()}),[]),x=a.useCallback((e=>{e.preventDefault(),e.stopPropagation(),w.current&&w.current.click()}),[w]),P=a.useCallback((async t=>{const n=Z(t);if(n.length)try{const t=n[0],r=await f.import(t,null,e.id,{publish:!0});D.push(r.url)}catch(r){g.error(r.message)}finally{t.target.value=""}}),[D,e.id,f]),R=a.useCallback(((t,n="asc")=>(h.hide(),e.save({sort:{field:t,direction:n}}))),[e,h]),N=pt({isContextMenu:!0,activeCollectionId:e.id}),j="title"===e.sort.field,L=e.sort.direction,M=an(e),F=an(p),B=a.useMemo((()=>[J(Dt,N),J(wt,N),J(It,N),J(Ct,N),J(St,N),{type:"separator"},{type:"button",title:b("New document"),visible:M.createDocument,onClick:O,icon:c(A.NewDocumentIcon,{})},{type:"button",title:b("Import document"),visible:M.createDocument,onClick:x,icon:c(A.ImportIcon,{})},{type:"separator"},{type:"button",title:`${b("Rename")}…`,visible:!!M.update&&!!l,onClick:()=>l?.(),icon:c(A.InputIcon,{})},J(Et,N),J(Tt,N),J(kt,N),{type:"submenu",title:b("Sort in sidebar"),visible:M.update,icon:c(j?"asc"===L?A.AlphabeticalSortIcon:A.AlphabeticalReverseSortIcon:A.ManualSortIcon,{}),items:[{type:"button",title:b("A-Z sort"),onClick:()=>R("title","asc"),selected:j&&"asc"===L},{type:"button",title:b("Z-A sort"),onClick:()=>R("title","desc"),selected:j&&"desc"===L},{type:"button",title:b("Manual sort"),onClick:()=>R("index"),selected:!j}]},{type:"button",title:`${b("Export")}…`,visible:!!(e&&F.createExport&&M.export),onClick:T,icon:c(A.ExportIcon,{})},J(Ot,N),J(_t,N),{type:"separator"},J(xt,N)]),[b,l,e,M.createDocument,M.update,M.export,O,x,N,j,F.createExport,T,R]);return B.length?m(k,{children:[c(Q,{children:m("label",{children:[b("Import document"),c("input",{type:"file",ref:w,onChange:P,onClick:_,accept:f.importFileTypes.join(", "),tabIndex:-1})]})}),n?c(vt,{...h,onPointerEnter:E,children:n}):c(At,{"aria-label":b("Show menu"),...h,onPointerEnter:E}),c(rn,{...h,onOpen:u,onClose:d,"aria-label":b("Collection"),children:c(yt,{...h,items:B})})]}):null}));var $r=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(e,t){var n=function withMimeType(e){var t=e.name;if(t&&-1!==t.lastIndexOf(".")&&!e.type){var n=t.split(".").pop().toLowerCase(),r=$r.get(n);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}(e);if("string"!=typeof n.path){var r=e.webkitRelativePath;Object.defineProperty(n,"path",{value:"string"==typeof t?t:"string"==typeof r&&r.length>0?r:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}var Hr=[".DS_Store","Thumbs.db"];function isObject$1(e){return"object"==typeof e&&null!==e}function getInputFiles(e){return fromList(e.target.files).map((function(e){return toFileWithPath(e)}))}function getFsHandleFiles(e){return ee(this,void 0,void 0,(function(){return te(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return e.getFile()})))];case 1:return[2,t.sent().map((function(e){return toFileWithPath(e)}))]}}))}))}function getDataTransferFiles(e,t){return ee(this,void 0,void 0,(function(){var n;return te(this,(function(r){switch(r.label){case 0:return null===e?[2,[]]:e.items?(n=fromList(e.items).filter((function(e){return"file"===e.kind})),"drop"!==t?[2,n]:[4,Promise.all(n.map(toFilePromises))]):[3,2];case 1:return[2,noIgnoredFiles(flatten(r.sent()))];case 2:return[2,noIgnoredFiles(fromList(e.files).map((function(e){return toFileWithPath(e)})))]}}))}))}function noIgnoredFiles(e){return e.filter((function(e){return-1===Hr.indexOf(e.name)}))}function fromList(e){if(null===e)return[];for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(r)}return t}function toFilePromises(e){if("function"!=typeof e.webkitGetAsEntry)return fromDataTransferItem(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?fromDirEntry(t):fromDataTransferItem(e)}function flatten(e){return e.reduce((function(e,t){return ne(e,Array.isArray(t)?flatten(t):[t])}),[])}function fromDataTransferItem(e){var t=e.getAsFile();if(!t)return Promise.reject(e+" is not a File");var n=toFileWithPath(t);return Promise.resolve(n)}function fromEntry(e){return ee(this,void 0,void 0,(function(){return te(this,(function(t){return[2,e.isDirectory?fromDirEntry(e):fromFileEntry(e)]}))}))}function fromDirEntry(e){var t=e.createReader();return new Promise((function(e,n){var r=[];!function readEntries(){var o=this;t.readEntries((function(t){return ee(o,void 0,void 0,(function(){var o,i,s;return te(this,(function(a){switch(a.label){case 0:if(t.length)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return o=a.sent(),e(o),[3,4];case 3:return i=a.sent(),n(i),[3,4];case 4:return[3,6];case 5:s=Promise.all(t.map(fromEntry)),r.push(s),readEntries(),a.label=6;case 6:return[2]}}))}))}),(function(e){n(e)}))}()}))}function fromFileEntry(e){return ee(this,void 0,void 0,(function(){return te(this,(function(t){return[2,new Promise((function(t,n){e.file((function(n){var r=toFileWithPath(n,e.fullPath);t(r)}),(function(e){n(e)}))}))]}))}))}function ownKeys$1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$1(Object(n),!0).forEach((function(t){_defineProperty$1(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty$1(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray$1(e,t){return function _arrayWithHoles$1(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit$1(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(c){a=!0,o=c}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}(e,t)||function _unsupportedIterableToArray$1(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray$1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray$1(e,t)}(e,t)||function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray$1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ur=function getInvalidTypeRejectionErr2(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:"file-invalid-type",message:"File type must be ".concat(t)}},qr=function getTooLargeRejectionErr2(e){return{code:"file-too-large",message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},Wr=function getTooSmallRejectionErr2(e){return{code:"file-too-small",message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},zr={code:"too-many-files",message:"Too many files"};function fileAccepted(e,t){var n="application/x-moz-file"===e.type||function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),r=e.name||"",o=(e.type||"").toLowerCase(),i=o.replace(/\/.*$/,"");return n.some((function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?r.toLowerCase().endsWith(t):t.endsWith("/*")?i===t.replace(/\/.*$/,""):o===t}))}return!0}(e,t);return[n,n?null:Ur(t)]}function fileMatchSize(e,t,n){if(isDefined(e.size))if(isDefined(t)&&isDefined(n)){if(e.size>n)return[!1,qr(n)];if(e.size<t)return[!1,Wr(t)]}else{if(isDefined(t)&&e.size<t)return[!1,Wr(t)];if(isDefined(n)&&e.size>n)return[!1,qr(n)]}return[!0,null]}function isDefined(e){return null!=e}function isPropagationStopped(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function isEvtWithFiles(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function onDocumentDragOver(e){e.preventDefault()}function composeEventHandlers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.some((function(t){return!isPropagationStopped(e)&&t&&t.apply(void 0,[e].concat(r)),isPropagationStopped(e)}))}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function filePickerOptionsTypes(e){return e="string"==typeof e?e.split(","):e,[{description:"everything",accept:Array.isArray(e)?e.filter((function(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)})).reduce((function(e,t){return _objectSpread$1(_objectSpread$1({},e),{},_defineProperty$1({},t,[]))}),{}):{}}]}var Vr=["children"],Kr=["open"],Yr=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Gr=["refKey","onChange","onClick"];function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(c){a=!0,o=c}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,o=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Xr=a.forwardRef((function(e,t){var n=e.children,r=function useDropzone(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_objectSpread(_objectSpread({},Zr),e),n=t.accept,r=t.disabled,o=t.getFilesFromEvent,i=t.maxSize,s=t.minSize,c=t.multiple,l=t.maxFiles,u=t.onDragEnter,d=t.onDragLeave,h=t.onDragOver,p=t.onDrop,f=t.onDropAccepted,g=t.onDropRejected,m=t.onFileDialogCancel,v=t.onFileDialogOpen,y=t.useFsAccessApi,b=t.preventDropOnDocument,D=t.noClick,w=t.noKeyboard,I=t.noDrag,C=t.noDragEventsBubbling,S=t.validator,E=a.useMemo((function(){return"function"==typeof v?v:noop}),[v]),T=a.useMemo((function(){return"function"==typeof m?m:noop}),[m]),k=a.useRef(null),O=a.useRef(null),_=_slicedToArray(a.useReducer(reducer,Qr),2),x=_[0],A=_[1],P=x.isFocused,R=x.isFileDialogActive,N=x.draggedFiles,j=function onWindowFocus2(){R&&setTimeout((function(){O.current&&(O.current.files.length||(A({type:"closeDialog"}),T()))}),300)};a.useEffect((function(){return y&&canUseFileSystemAccessAPI()?function(){}:(window.addEventListener("focus",j,!1),function(){window.removeEventListener("focus",j,!1)})}),[O,R,T,y]);var L=a.useRef([]),M=function onDocumentDrop2(e){k.current&&k.current.contains(e.target)||(e.preventDefault(),L.current=[])};a.useEffect((function(){return b&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",M,!1)),function(){b&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",M))}}),[k,b]);var F=a.useCallback((function(e){e.preventDefault(),e.persist(),Z(e),L.current=[].concat(_toConsumableArray(L.current),[e.target]),isEvtWithFiles(e)&&Promise.resolve(o(e)).then((function(t){isPropagationStopped(e)&&!C||(A({draggedFiles:t,isDragActive:!0,type:"setDraggedFiles"}),u&&u(e))}))}),[o,u,C]),B=a.useCallback((function(e){e.preventDefault(),e.persist(),Z(e);var t=isEvtWithFiles(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(n){}return t&&h&&h(e),!1}),[h,C]),$=a.useCallback((function(e){e.preventDefault(),e.persist(),Z(e);var t=L.current.filter((function(e){return k.current&&k.current.contains(e)})),n=t.indexOf(e.target);-1!==n&&t.splice(n,1),L.current=t,t.length>0||(A({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),isEvtWithFiles(e)&&d&&d(e))}),[k,d,C]),H=a.useCallback((function(e,t){var r=[],o=[];e.forEach((function(e){var t=_slicedToArray(fileAccepted(e,n),2),a=t[0],c=t[1],l=_slicedToArray(fileMatchSize(e,s,i),2),u=l[0],d=l[1],h=S?S(e):null;if(a&&u&&!h)r.push(e);else{var p=[c,d];h&&(p=p.concat(h)),o.push({file:e,errors:p.filter((function(e){return e}))})}})),(!c&&r.length>1||c&&l>=1&&r.length>l)&&(r.forEach((function(e){o.push({file:e,errors:[zr]})})),r.splice(0)),A({acceptedFiles:r,fileRejections:o,type:"setFiles"}),p&&p(r,o,t),o.length>0&&g&&g(o,t),r.length>0&&f&&f(r,t)}),[A,c,n,s,i,l,p,f,g,S]),U=a.useCallback((function(e){e.preventDefault(),e.persist(),Z(e),L.current=[],isEvtWithFiles(e)&&Promise.resolve(o(e)).then((function(t){isPropagationStopped(e)&&!C||H(t,e)})),A({type:"reset"})}),[o,H,C]),q=a.useCallback((function(){if(y&&canUseFileSystemAccessAPI()){A({type:"openDialog"}),E();var e={multiple:c,types:filePickerOptionsTypes(n)};window.showOpenFilePicker(e).then((function(e){return o(e)})).then((function(e){return H(e,null)})).catch((function(e){return T(e)})).finally((function(){return A({type:"closeDialog"})}))}else O.current&&(A({type:"openDialog"}),E(),O.current.value=null,O.current.click())}),[A,E,T,y,H,n,c]),W=a.useCallback((function(e){k.current&&k.current.isEqualNode(e.target)&&(32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),q()))}),[k,O,q]),z=a.useCallback((function(){A({type:"focus"})}),[]),V=a.useCallback((function(){A({type:"blur"})}),[]),K=a.useCallback((function(){D||(!function isIeOrEdge(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return function isIe(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}(e)||function isEdge(e){return-1!==e.indexOf("Edge/")}(e)}()?q():setTimeout(q,0))}),[O,D,q]),Y=function composeHandler2(e){return r?null:e},G=function composeKeyboardHandler2(e){return w?null:Y(e)},X=function composeDragHandler2(e){return I?null:Y(e)},Z=function stopPropagation2(e){C&&e.stopPropagation()},J=a.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,n=void 0===t?"ref":t,o=e.role,i=e.onKeyDown,s=e.onFocus,a=e.onBlur,c=e.onClick,l=e.onDragEnter,u=e.onDragOver,d=e.onDragLeave,h=e.onDrop,p=_objectWithoutProperties(e,Yr);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:G(composeEventHandlers(i,W)),onFocus:G(composeEventHandlers(s,z)),onBlur:G(composeEventHandlers(a,V)),onClick:Y(composeEventHandlers(c,K)),onDragEnter:X(composeEventHandlers(l,F)),onDragOver:X(composeEventHandlers(u,B)),onDragLeave:X(composeEventHandlers(d,$)),onDrop:X(composeEventHandlers(h,U)),role:"string"==typeof o&&""!==o?o:"button"},n,k),r||w?{}:{tabIndex:0}),p)}}),[k,W,z,V,K,F,B,$,U,w,I,r]),Q=a.useCallback((function(e){e.stopPropagation()}),[]),ee=a.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,r=void 0===t?"ref":t,o=e.onChange,i=e.onClick,s=_objectWithoutProperties(e,Gr);return _objectSpread(_objectSpread({},_defineProperty({accept:n,multiple:c,type:"file",style:{display:"none"},onChange:Y(composeEventHandlers(o,U)),onClick:Y(composeEventHandlers(i,Q)),autoComplete:"off",tabIndex:-1},r,O)),s)}}),[O,n,c,U,r]),te=N.length,ne=te>0&&function allFilesAccepted(e){var t=e.files,n=e.accept,r=e.minSize,o=e.maxSize,i=e.multiple,s=e.maxFiles;return!(!i&&t.length>1||i&&s>=1&&t.length>s)&&t.every((function(e){var t=_slicedToArray$1(fileAccepted(e,n),1)[0],i=_slicedToArray$1(fileMatchSize(e,r,o),1)[0];return t&&i}))}({files:N,accept:n,minSize:s,maxSize:i,multiple:c,maxFiles:l}),re=te>0&&!ne;return _objectSpread(_objectSpread({},x),{},{isDragAccept:ne,isDragReject:re,isFocused:P&&!r,getRootProps:J,getInputProps:ee,rootRef:k,inputRef:O,open:Y(q)})}(_objectWithoutProperties(e,Vr)),o=r.open,i=_objectWithoutProperties(r,Kr);return a.useImperativeHandle(t,(function(){return{open:o}}),[o]),re.createElement(a.Fragment,null,n(_objectSpread(_objectSpread({},i),{},{open:o})))}));Xr.displayName="Dropzone";var Zr={disabled:!1,getFilesFromEvent:function fromEvent(e){return ee(this,void 0,void 0,(function(){return te(this,(function(t){return isObject$1(e)&&function isDataTransfer(e){return isObject$1(e.dataTransfer)}(e)?[2,getDataTransferFiles(e.dataTransfer,e.type)]:function isChangeEvt(e){return isObject$1(e)&&isObject$1(e.target)}(e)?[2,getInputFiles(e)]:Array.isArray(e)&&e.every((function(e){return"getFile"in e&&"function"==typeof e.getFile}))?[2,getFsHandleFiles(e)]:[2,[]]}))}))},maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1};Xr.defaultProps=Zr,Xr.propTypes={children:oe.func,accept:oe.oneOfType([oe.string,oe.arrayOf(oe.string)]),multiple:oe.bool,preventDropOnDocument:oe.bool,noClick:oe.bool,noKeyboard:oe.bool,noDrag:oe.bool,noDragEventsBubbling:oe.bool,minSize:oe.number,maxSize:oe.number,maxFiles:oe.number,disabled:oe.bool,getFilesFromEvent:oe.func,onFileDialogCancel:oe.func,onFileDialogOpen:oe.func,useFsAccessApi:oe.bool,onDragEnter:oe.func,onDragLeave:oe.func,onDragOver:oe.func,onDrop:oe.func,onDropAccepted:oe.func,onDropRejected:oe.func,validator:oe.func};const Jr=Xr;var Qr={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function reducer(e,t){switch(t.type){case"focus":return _objectSpread(_objectSpread({},e),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},e),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},Qr),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":var n=t.isDragActive,r=t.draggedFiles;return _objectSpread(_objectSpread({},e),{},{draggedFiles:r,isDragActive:n});case"setFiles":return _objectSpread(_objectSpread({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return _objectSpread({},Qr);default:return e}}function noop(){}let eo=!1;function useImportDocument(e,n){const{documents:r}=s(),[o,c]=a.useState(!1),{t:l}=i(),u=t();return{handleFiles:a.useCallback((async(t=[])=>{if(!eo&&t.length){c(!0),eo=!0;try{let i=e;const s=1===t.length;if(n&&!e){const e=await r.fetch(n);ie(e,"Document not available"),i=e.collectionId}for(const e of t)try{const t=await r.import(e,n,i,{publish:!0});s&&u.push(p(t))}catch(o){g.error(o.message)}}catch(o){g.error(`${l("Could not import file")}. ${o.message}`)}finally{c(!1),eo=!1}}}),[l,r,u,e,n]),isImporting:o}}const to=I.div.withConfig({componentId:"sc-5il00h-0"})(["border-radius:4px;",""],(({$isDragActive:e,theme:t})=>e&&se(["a,a + *{background:"," !important;color:"," !important;}svg{fill:",";}"],t.slateDark,t.white,t.white))),no=e((function DropToImport({disabled:e,children:t,collectionId:n,documentId:r}){const{t:o}=i(),{documents:l}=s(),{handleFiles:u,isImporting:d}=useImportDocument(n,r);ie(n||r,"Must provide either collectionId or documentId");const h=an(n),p=an(r),f=a.useCallback((()=>{g.error(o("Document not supported – try Markdown, Plain text, HTML, or Word"))}),[o]);return e||n&&!h.createDocument||r&&!p.createChildDocument?t:c(Jr,{accept:l.importFileTypes.join(", "),onDropAccepted:u,onDropRejected:f,noClick:!0,multiple:!0,children:({getRootProps:e,getInputProps:n,isDragActive:r})=>m(to,{...e(),$isDragActive:r,tabIndex:-1,children:[c("input",{...n()}),d&&c(In,{}),t]})})})),ro=e((({collection:e,expanded:n,onDisclosureClick:r,isDraggingAnyCollection:o,depth:l,onClick:u})=>{const[p,g,v]=wn(),[y,b]=a.useState(!1),{documents:D}=s(),w=t(),I=an(e),{t:C}=i(),S=Pt(),E=tn(),T=a.useRef(null),O=a.useCallback((async t=>{await e.save({name:t})}),[e]),_=a.useCallback((()=>{n||r()}),[n,r]),x=a.useRef(null),[{isOver:P,canDrop:R},N]=useDropToChangeCollection(e,_,x),j=a.useCallback((()=>{e.fetchDocuments()}),[e]),L=a.useCallback((()=>{T.current?.setIsEditing(!0)}),[T]),[M,F,B]=wn(),$=a.useCallback((async t=>{const n=await D.create({collectionId:e.id,title:t,fullWidth:E.getPreference(d.FullWidthDocuments),data:h.getEmptyDocument()},{publish:!0});e?.addDocument(n),B(),w.push({pathname:f(n),state:{sidebarContext:S}})}),[E,S,B,w,e,D]);return m(k,{children:[c(Rt,{ref:ae([x,N]),children:c(no,{collectionId:e.id,children:c(Nt,{onClick:u,to:{pathname:e.path,state:{sidebarContext:S}},expanded:n,onDisclosureClick:r,onClickIntent:j,icon:c(bn,{collection:e,expanded:n}),showActions:p,isActiveDrop:P&&R,isActive:(e,t)=>!!e&&t.state?.sidebarContext===S,label:c(Lr,{title:e.name,onSubmit:O,onEditing:b,canUpdate:I.update,maxLength:ce.maxNameLength,ref:T}),exact:!1,depth:l||0,menu:!y&&!o&&m(le,{children:[I.createDocument&&c(ue,{tooltip:{content:C("New doc"),delay:500},onClick:e=>{e.preventDefault(),F(),_()},children:c(A.PlusIcon,{})}),c(Br,{collection:e,onRename:L,onOpen:g,onClose:v})]})})})}),M&&c(Nt,{depth:2,isActive:()=>!0,label:c(Lr,{title:"",canUpdate:!0,isEditing:!0,placeholder:`${C("New doc")}…`,onCancel:B,onSubmit:$,maxLength:de.maxTitleLength})})]})}));const oo=e((function DocumentsLoader({collection:e,enabled:t,children:n}){return a.useEffect((()=>{t&&e.fetchDocuments()}),[e,t]),c(k,{children:n})}));function DropCursor({isActiveDrop:e,innerRef:t,position:n}){return c(io,{isOver:e,ref:t,position:n})}const io=I.div.withConfig({componentId:"sc-1f0k1bv-0"})(["opacity:",";transition:opacity 150ms;position:absolute;z-index:1;width:100%;height:14px;background:transparent;"," ::after{background:",';position:absolute;top:6px;content:"";height:2px;border-radius:2px;width:100%;}'],(e=>e.isOver?1:0),(e=>"top"===e.position?"top: -7px;":"bottom: -7px;"),(e=>e.theme.slateDark)),Folder=({expanded:e,children:t})=>{const[n,r]=a.useState(e);return a.useEffect((()=>{e&&r(!0)}),[e]),n?c(so,{$expanded:e,children:t}):null},so=I.div.withConfig({componentId:"sc-124vyld-0"})(["display:",";"],(e=>e.$expanded?"block":"none"));const ao=I.div.withConfig({componentId:"sc-18bx6nr-0"})(["transition:opacity 250ms ease;opacity:",";pointer-events:",";"],(e=>e.$isDragging||e.$isMoving?.1:1),(e=>e.$isMoving?"none":"all")),co=e(a.forwardRef((function InnerDocumentLink({node:e,collection:n,activeDocument:r,prefetchDocument:o,isDraft:l,depth:u,index:p,parentId:v},y){const{documents:b,policies:D}=s(),{t:w}=i(),I=t(),C=an(e.id).update,S=r&&r.id===e.id,E=!!e.children.length||r?.parentDocumentId===e.id,O=b.get(e.id),{fetchChildDocuments:_}=b,[x,P]=a.useState(!1),R=a.useRef(null),N=Pt(),j=tn();a.useEffect((()=>{S&&(E||"collections"!==N)&&_(e.id)}),[_,e.id,E,N,S]);const L=a.useMemo((()=>!!(E&&r&&n&&(n.pathToDocument(r.id).map((e=>e.id)).includes(e.id)||S))),[E,r,S,e,n]),[M,F,B]=wn(L);a.useEffect((()=>{L&&F()}),[F,L]),a.useEffect((()=>{M&&!E&&B()}),[B,M,E]);const U=a.useCallback((e=>{e?.preventDefault(),M?B():F()}),[B,F,M]),q=a.useCallback((()=>{o?.(e.id)}),[o,e]),W=a.useCallback((async e=>{O&&await b.update({id:O.id,title:e})}),[b,O]),[z,V,K]=wn(),Y=b.movingDocumentId===e.id,G=D.abilities(e.id),X=O?.icon||e.icon||e.emoji,Z=O?.color||e.color,[{isDragging:J},Q]=function useDragDocument(e,t,n){const r=n?.icon||e.icon||e.emoji,o=n?.color||e.color,[{isDragging:i},s,l]=useDrag({type:"document",item:()=>({...e,depth:t,icon:r?c(H,{value:r,color:o}):void 0,collectionId:n?.collectionId||""}),canDrag:()=>!!n?.isActive,collect:e=>({isDragging:e.isDragging()})});return a.useEffect((()=>{l(getEmptyImage(),{captureDraggingState:!0})}),[l]),[{isDragging:i},s]}(e,u,O),ee=a.useRef(null),[{isOverReparent:te,canDropToReparent:ne},re]=useDropToReparentDocument(e,F,ee),[{isOverReorder:oe,isDraggingAnyDocument:ie},se]=function useDropToReorderDocument(e,t,n){const{t:r}=i(),{documents:o,collections:a,dialogs:l}=s(),u=o.get(e.id);return useDrop({accept:"document",canDrop:t=>!(t.id===e.id||u&&!u.isActive),drop:async e=>{if(!t?.isManualSort&&e.collectionId===t?.id)return void g.message(r("You can't reorder documents in an alphabetically sorted collection"));const i=n(e);if(i){const n=a.get(e.collectionId);if(t&&n&&n.permission!==t.permission)l.openModal({title:r("Change permissions?"),content:c(Nr,{item:e,collection:t,...i})});else try{await o.move(i)}catch(s){s instanceof $?g.error(r("The {{ documentName }} cannot be moved here",{documentName:e.title})):g.error(s.message)}}},collect:e=>({isOverReorder:e.isOver(),isDraggingAnyDocument:e.canDrop()})})}(e,n,(t=>{if(n)return M?{documentId:t.id,collectionId:n.id,parentDocumentId:e.id,index:0}:{documentId:t.id,collectionId:n.id,parentDocumentId:v,index:p+1}})),ae=a.useMemo((()=>{const t=r?.isDraft&&r?.isActive&&r?.parentDocumentId===e.id;return n&&t?he([r?.asNavigationNode,...e.children],n.sort,!1):e.children}),[r?.isActive,r?.isDraft,r?.parentDocumentId,r?.asNavigationNode,n,e]),ce=b.get(e.id),pe=ce?.title||e.title||w("Untitled"),fe=M&&!J,ge=ae.length>0,me=a.useCallback((e=>{ge&&("ArrowRight"!==e.key||M||F(),"ArrowLeft"===e.key&&M&&B())}),[F,B,ge,M]),[ve,ye,be]=wn(),De=a.useCallback((async t=>{const r=await b.create({collectionId:n?.id,parentDocumentId:e.id,fullWidth:ce?.fullWidth??j.getPreference(d.FullWidthDocuments),title:t,data:h.getEmptyDocument()},{publish:!0});n?.addDocument(r,e.id),be(),I.push({pathname:f(r),state:{sidebarContext:N}})}),[b,n,N,j,e,ce,I,be]);return m(k,{children:[m(Rt,{ref:ee,children:[c(ao,{ref:Q,$isDragging:J,$isMoving:Y,onKeyDown:me,children:c("div",{ref:re,children:c(no,{documentId:e.id,activeClassName:"activeDropZone",children:c(Nt,{expanded:ge?fe:void 0,onDisclosureClick:U,onClickIntent:q,to:{pathname:e.url,state:{title:e.title,sidebarContext:N}},icon:X&&c(H,{value:X,color:Z}),label:c(Lr,{title:pe,onSubmit:W,onEditing:P,canUpdate:C,maxLength:de.maxTitleLength,ref:R}),isActive:(e,t)=>N===t.state?.sidebarContext&&(O&&t.pathname.endsWith(O.urlId)||!!e),isActiveDrop:te&&ne,depth:u,exact:!1,showActions:z,scrollIntoViewIfNeeded:"collections"===N,isDraft:l,ref:y,menu:!O||Y||x||ie?void 0:m(le,{children:[G.createChildDocument&&c(T,{content:w("New doc"),children:c(ue,{type:void 0,"aria-label":w("New nested document"),onClick:e=>{e.preventDefault(),ye(),F()},children:c(A.PlusIcon,{})})}),c(jt,{document:O,onRename:()=>R.current?.setIsEditing(!0),onOpen:V,onClose:K})]})})})})},e.id),ie&&n?.isManualSort&&c(DropCursor,{isActiveDrop:oe,innerRef:se})]}),ve&&c(Nt,{isActive:()=>!0,depth:u+1,label:c(Lr,{title:"",canUpdate:!0,isEditing:!0,placeholder:`${w("New doc")}…`,onCancel:be,onSubmit:De,maxLength:de.maxTitleLength})}),c(Folder,{expanded:M&&!J,children:ae.map(((t,i)=>c(co,{collection:n,node:t,activeDocument:r,prefetchDocument:o,isDraft:t.isDraft,depth:u+1,index:i,parentId:e.id},t.id)))})]})})));function PlaceholderCollections(e){return m(lo,{...e,children:[c(Cn,{}),c(Cn,{delay:.2}),c(Cn,{delay:.4})]})}const lo=I.div.withConfig({componentId:"sc-czjkha-0"})(["margin:4px 12px;width:75%;"]);const uo=I(PlaceholderCollections).withConfig({componentId:"sc-zhmv54-0"})(["margin-left:44px;min-height:90px;"]),ho=e((function CollectionLinkChildren({collection:e,expanded:t,prefetchDocument:n}){const{documents:r}=s(),{t:o}=i(),l=function useCollectionDocuments(e,t){return a.useMemo((()=>{if(e?.sortedDocuments)return t?.isActive&&t?.isDraft&&t?.collectionId===e.id&&!t?.parentDocumentId?he([t.asNavigationNode,...e.sortedDocuments],e.sort,!1):e.sortedDocuments}),[t?.isActive,t?.isDraft,t?.collectionId,t?.parentDocumentId,t?.asNavigationNode,e,e?.sortedDocuments,e?.id,e?.sort])}(e,r.active),[u,d]=a.useState(250),h=a.useRef(null),[{isOver:p,canDrop:f},g]=useDropToChangeCollection(e,pe,h);a.useEffect((()=>{t||d(250)}),[t]);const v=a.useCallback((()=>{l&&l.length>u&&d((e=>e+250))}),[l,u]);return m(Folder,{expanded:t,children:[f&&e.isManualSort&&c(DropCursor,{isActiveDrop:p,innerRef:g,position:"top"}),m(oo,{collection:e,enabled:t,children:[!l&&c(lt,{hideOverflow:!0,children:c(uo,{})}),l?.slice(0,u).map(((t,o)=>c(co,{node:t,collection:e,activeDocument:r.active,prefetchDocument:n,isDraft:t.isDraft,depth:2,index:o},t.id))),0===l?.length&&c(Nt,{label:c(O,{type:"tertiary",size:"small",italic:!0,children:o("Empty")}),onClick:()=>K.push(e.url),depth:2}),c(gn,{onEnter:v,fireOnRapidScroll:!0},u)]})]})}));function ArchivedCollectionLink({collection:e,depth:t}){const{documents:n}=s(),[r,o]=a.useState(!1),i=a.useCallback((e=>{e.preventDefault(),e.stopPropagation(),o((e=>!e))}),[]),l=a.useCallback((()=>{o(!0)}),[]);return m(k,{children:[c(ro,{depth:t||0,collection:e,expanded:r,activeDocument:n.active,onDisclosureClick:i,onClick:l}),c(Rt,{children:c(ho,{collection:e,expanded:r,prefetchDocument:n.prefetchDocument})})]})}function LoadingError({error:e,retry:t,...n}){const{t:r}=i();ge("online",t);const o=m(k,e instanceof me?{children:[c(A.DisconnectedIcon,{})," ",r("You’re offline.")]}:{children:[c(A.WarningIcon,{})," ",r("Sorry, an error occurred.")]});return c(po,{...n,children:m(l,{align:"center",gap:4,wrap:!0,children:[o," ",m(Sn,{onClick:()=>t(),children:[r("Click to retry"),"…"]})]})})}const po=I(fe).withConfig({componentId:"sc-m4exzf-0"})(["padding:8px 0;white-space:nowrap;","{color:",";&:hover{color:",";text-decoration:underline;}}"],Sn,j("textTertiary"),j("textSecondary"));const fo=I("div").withConfig({componentId:"sc-9yscvu-0"})(["transition:opacity 250ms ease;opacity:",";pointer-events:",";"],(e=>e.$isDragging?.1:1),(e=>e.$isDragging?"none":"auto")),go=e((function DraggableCollectionLink({collection:e,activeDocument:t,prefetchDocument:n,belowCollection:r}){const o=Lt(),i=Pt(),{ui:l,policies:u,collections:d}=s(),[h,p]=a.useState(e.id===l.activeCollectionId&&i===o),f=r?r.index:null,[{isCollectionDropping:g,isDraggingAnyCollection:v},y]=useDrop({accept:"collection",drop:t=>{d.move(t.id,Rr(e.index,f))},canDrop:t=>e.id!==t.id&&(!r||t.id!==r.id)&&u.abilities(t.id)?.move,collect:e=>({isCollectionDropping:e.isOver(),isDraggingAnyCollection:e.canDrop()})}),[{isDragging:b},D,w]=useDrag({type:"collection",item:()=>({id:e.id,title:e.name,icon:c(bn,{collection:e})}),collect:e=>({isDragging:e.isDragging()})});a.useEffect((()=>{w(getEmptyImage(),{captureDraggingState:!1})}),[w]),a.useEffect((()=>{e.id===l.activeCollectionId&&i===o&&p(!0)}),[e.id,l.activeCollectionId,i,o]);const I=a.useCallback((e=>{e?.preventDefault(),p((e=>!e))}),[]),C=h&&!b;return m(k,{children:[c(fo,{ref:D,$isDragging:b,children:c(ro,{collection:e,expanded:C,activeDocument:t,onDisclosureClick:I,isDraggingAnyCollection:v})},e.id),m(Rt,{children:[c(ho,{collection:e,expanded:C,prefetchDocument:n}),v&&c(DropCursor,{isActiveDrop:g,innerRef:y})]})]})}));const mo=e((function SidebarAction({action:e,...t}){const n=pt({isContextMenu:!1,isCommandBar:!1,activeCollectionId:void 0,activeDocumentId:void 0}),r=J(e,n);return ie("button"===r.type,"passed action must be a button"),r.visible?c(Nt,{onClick:r.onClick,icon:r.icon,label:r.title,...t}):null}));const vo=I(LoadingError).withConfig({componentId:"sc-jozon0-0"})(["font-size:15px;padding:0 8px;"]),yo=e((function Collections(){const{documents:e,collections:t}=s(),{t:n}=i(),r=t.orderedData,o=a.useMemo((()=>({limit:100})),[]),[{isCollectionDropping:u,isDraggingAnyCollection:d},h]=useDrop({accept:"collection",drop:async e=>{t.move(e.id,Rr(null,r[0].index))},canDrop:e=>e.id!==r[0].id,collect:e=>({isCollectionDropping:e.isOver(),isDraggingAnyCollection:"collection"===e.getItemType()})});return c(Mt.Provider,{value:"collections",children:c(l,{column:!0,children:c(Ft,{id:"collections",title:n("Collections"),children:m(Rt,{children:[c(mn,{options:o,"aria-label":n("Collections"),items:t.allActive,loading:c(PlaceholderCollections,{}),heading:d?c(DropCursor,{isActiveDrop:u,innerRef:h,position:"top"}):void 0,renderError:e=>c(vo,{...e}),renderItem:(t,n)=>c(go,{collection:t,activeDocument:e.active,prefetchDocument:e.prefetchDocument,belowCollection:r[n+1]},t.id)}),c(mo,{action:Bt,depth:0})]})})})})}));const bo=e((function ArchiveLink(){const{collections:e}=s(),{t:t}=i(),[n,r]=a.useState(!1),[o,u]=a.useState(),{request:d,data:h,loading:p,error:f}=bt(e.fetchArchived,!0);a.useEffect((()=>{ve(h)||p||!ve(f)||r(h.length>0)}),[h,p,f]),a.useEffect((()=>{r(e.archived.length>0)}),[e.archived]),a.useEffect((()=>{n&&ve(o)&&u(!1)}),[n]),a.useEffect((()=>{o&&d()}),[o,d]);const v=a.useCallback((e=>{e.preventDefault(),e.stopPropagation(),u((e=>!e))}),[]),y=a.useCallback((()=>{u(!0)}),[]),[{isOverArchiveSection:b,isDragging:D},w]=function useDropToArchive(){const{documents:e,collections:t,policies:n}=s(),{t:r}=i();return useDrop({accept:["document","collection"],drop:async(n,o)=>{const i=o.getItemType();let s;s="collection"===i?t.get(n.id):e.get(n.id),s&&(await s.archive(),g.success(r("collection"===i?"Collection archived":"Document archived")))},canDrop:e=>n.abilities(e.id).archive,collect:e=>({isOverArchiveSection:!!e.isOver(),isDragging:e.canDrop()})})}();return c(Mt.Provider,{value:"archive",children:m(l,{column:!0,children:[c("div",{ref:w,children:c(Nt,{to:ye(),icon:c(A.ArchiveIcon,{open:b&&D}),exact:!1,label:t("Archive"),isActiveDrop:b&&D,depth:0,expanded:n?o:void 0,onDisclosureClick:v,onClick:y})}),!0===o?c(Rt,{children:c(mn,{"aria-label":t("Archived collections"),items:e.archived,loading:c(PlaceholderCollections,{}),renderError:e=>c(vo,{...e}),renderItem:e=>c(ArchivedCollectionLink,{depth:1,collection:e},e.id)})}):null]})})})),Do=e((()=>{const{t:e}=i(),{documents:t}=s(),[{isOver:n,canDrop:r},o]=function useDropToUnpublish(){const{t:e}=i(),{policies:t,documents:n}=s();return useDrop({accept:"document",drop:async t=>{const r=n.get(t.id);if(r)try{await r.unpublish({detach:!0}),g.success(e("Unpublished {{ documentName }}",{documentName:r.noun}))}catch(o){g.error(o.message)}},canDrop:e=>{const n=t.abilities(e.id);return!n||n.unpublish},collect:e=>({isOver:e.isOver(),canDrop:e.canDrop()})})}();return c("div",{ref:o,children:c(Nt,{to:be(),icon:c(A.DraftsIcon,{}),label:m(l,{align:"center",justify:"space-between",children:[e("Drafts"),t.totalDrafts>0?c(wo,{size:"xsmall",type:"tertiary",children:t.totalDrafts>25?"25+":t.totalDrafts}):null]}),isActiveDrop:n&&r})})})),wo=I(O).withConfig({componentId:"sc-1txpvr8-0"})(["margin:0 4px;"]),Io={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"};function getItemStyles(e,t,n){if(!e||!t)return{display:"none"};const{y:r}=t,o=`translate(${Math.max(e.x,Math.min(e.x+n/4,t.x))}px, ${r}px)`;return{width:n-24,transform:o,WebkitTransform:o}}const DragPlaceholder=()=>{const{t:e}=i(),{ui:t}=s(),{isDragging:n,item:r,initialOffset:o,currentOffset:l}=function useDragLayer(e){const t=useDragDropManager().getMonitor(),[n,r]=useCollector(t,e);return a.useEffect((()=>t.subscribeToOffsetChange(r))),a.useEffect((()=>t.subscribeToStateChange(r))),n}((e=>({item:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()})));return n&&l?c("div",{style:Io,children:c("div",{style:getItemStyles(o,l,t.sidebarWidth),children:c(Co,{icon:r.icon,label:r.title||e("Untitled"),isDraft:r.isDraft,depth:r.depth,active:!0})})}):null},Co=I(Nt).withConfig({componentId:"sc-1t4rrd0-0"})(["transition:box-shadow 250ms ease-in-out;box-shadow:rgb(0 0 0 / 30%) 0px 4px 15px;opacity:0.95;"]);function HistoryNavigation(e){const{t:t}=i(),[n,r]=a.useState(!1),[o,s]=a.useState(!1);return Dn((e=>De()?e.metaKey&&"["===e.key:e.altKey&&"ArrowLeft"===e.key),(()=>{r(!0),setTimeout((()=>r(!1)),100)})),Dn((e=>De()?e.metaKey&&"]"===e.key:e.altKey&&"ArrowRight"===e.key),(()=>{s(!0),setTimeout((()=>s(!1)),100)})),L.isMacApp()?m(So,{gap:4,...e,children:[c(T,{content:t("Go back"),children:c(ue,{onClick:()=>L.bridge?.goBack(),children:c(To,{$active:n})})}),c(T,{content:t("Go forward"),children:c(ue,{onClick:()=>L.bridge?.goForward(),children:c(Eo,{$active:o})})})]}):null}const So=I(l).withConfig({componentId:"sc-1yfv17m-0"})(["position:absolute;right:12px;top:14px;"]),Eo=I(A.ArrowIcon).withConfig({componentId:"sc-1yfv17m-1"})(["color:",";opacity:",";transition:color 100ms ease-in-out;&:active,&:hover{opacity:1;}"],j("textTertiary"),(e=>e.$active?1:.5)),To=I(Eo).withConfig({componentId:"sc-1yfv17m-2"})(["transform:rotate(180deg);flex-shrink:0;"]);function usePaginatedRequest(e,t={}){const[n,r]=a.useState(),[o,i]=a.useState(0),[s,c]=a.useState(0),[l,u]=a.useState(!1),d=t.limit||10,h=d+1,[p,f]=a.useState((()=>()=>e({...t,offset:0,limit:h}))),{data:g,error:m,loading:v,request:y}=bt(p);a.useEffect((()=>{y()}),[y]),a.useEffect((()=>{g&&!v&&(r((e=>we((e??[]).concat(g.slice(0,d)),"id"))),c((e=>e+1)),u(g.length<=d))}),[g,d,v]),a.useEffect((()=>{o&&f((()=>()=>e({...t,offset:o,limit:h})))}),[o,h,e]);const b=a.useCallback((()=>{i((e=>e+d))}),[d]);return a.useEffect((()=>{u(!1),r(void 0),c(0),i(0)}),[e]),{data:n,next:b,loading:v,error:m,page:s,offset:o,end:l}}const ko=I.div.withConfig({componentId:"sc-2r0d65-0"})(["position:relative;transition:opacity 250ms ease;opacity:",";"],(e=>e.$isDragging?.1:1)),Oo=e((function SharedWithMeLink({membership:e,depth:t=0}){const{ui:n,collections:r,documents:o}=s(),{fetchChildDocuments:i}=o,[l,u,d]=wn(),{documentId:h}=e,p=h===n.activeDocumentId,f=Lt(),g=Pt(),v=h?o.get(h):void 0,[y,b,D]=wn(e.documentId===n.activeDocumentId&&f===g);a.useEffect((()=>{e.documentId===n.activeDocumentId&&f===g&&b()}),[e.documentId,n.activeDocumentId,g,f,b]),a.useEffect((()=>{h&&o.fetch(h)}),[h,o]),a.useEffect((()=>{p&&e.documentId&&i(e.documentId)}),[i,p,e.documentId]);const w=a.useCallback((e=>{e.preventDefault(),e.stopPropagation(),y?D():b()}),[y,b,D]),I=a.useRef(null),C=a.useMemo((()=>v?.asNavigationNode),[v]),[{isOverReparent:S,canDropToReparent:E},T]=useDropToReparentDocument(C,b,I),{icon:O}=useSidebarLabelAndIcon(e),[{isDragging:_},x]=function useDragMembership(e){const t=e.id,{label:n,icon:r}=useSidebarLabelAndIcon(e),[{isDragging:o},i,s]=useDrag({type:e instanceof q?"userMembership":"groupMembership",item:()=>({id:t,title:n,icon:r}),collect:e=>({isDragging:!!e.isDragging()})});return a.useEffect((()=>{s(getEmptyImage(),{captureDraggingState:!0})}),[s]),[{isDragging:o},i]}(e),[A,P]=useDropToReorderUserMembership((()=>{if(e instanceof q){const t=e?.next();return Rr(e?.index||null,t?.index||null)}return""})),R=y&&!_;if(v){const{icon:n}=v,i=Ie(n)===Ce.Emoji?v.title.replace(n,""):v.titleWithDefault,s=v.collectionId?r.get(v.collectionId):void 0,a=v.asNavigationNode.children,h=a.length>0;return m(k,{children:[c(Rt,{ref:I,children:c(ko,{ref:x,$isDragging:_,children:c("div",{ref:T,children:c(Nt,{isActiveDrop:S&&E,depth:t,to:{pathname:v.path,state:{sidebarContext:g}},expanded:h&&!_?y:void 0,onDisclosureClick:w,icon:O,isActive:(e,t)=>!!e&&t.state?.sidebarContext===g,label:i,exact:!1,unreadBadge:v.unreadNotifications.filter((e=>e.event===V.AddUserToDocument)).length>0,showActions:l,menu:v&&!_?c(le,{children:c(jt,{document:v,onOpen:u,onClose:d})}):void 0})})},e.id)}),c(Folder,{expanded:R,children:a.map(((e,t)=>c(co,{node:e,collection:s,activeDocument:o.active,isDraft:e.isDraft,depth:2,index:t},e.id)))}),A.isDragging&&c(DropCursor,{isActiveDrop:A.isOverCursor,innerRef:P})]})}return null})),_o=e((({group:e})=>{const t=Lt(),n=$t(e.id),[r,o]=a.useState(t===n),i=a.useCallback((e=>{e?.preventDefault(),o((e=>!e))}),[]);return a.useEffect((()=>{t===n&&o(!0)}),[n,t,o]),m(Rt,{children:[c(Nt,{label:e.name,icon:c(A.GroupIcon,{}),expanded:r,onClick:i,depth:0}),c(Mt.Provider,{value:n,children:c(Folder,{expanded:r,children:e.documentMemberships.map((e=>c(Oo,{membership:e,depth:1},e.id)))})})]})}));const xo=e((function SharedWithMe(){const{userMemberships:e,groupMemberships:t}=s(),{t:n}=i(),r=tn();usePaginatedRequest(t.fetchAll);const{loading:o,next:u,end:d,error:h,page:p}=usePaginatedRequest(e.fetchPage,{limit:Se.sidebarLimit}),[f,v]=useDropToReorderUserMembership((()=>Rr(null,r.documentMemberships[0].index)));return a.useEffect((()=>{h&&g.error(n("Could not load shared documents"))}),[h,n]),r.documentMemberships.length||r.groupsWithDocumentMemberships.length?c(Mt.Provider,{value:"shared",children:c(l,{column:!0,children:m(Ft,{id:"shared",title:n("Shared with me"),children:[r.groupsWithDocumentMemberships.map((e=>c(_o,{group:e},e.id))),m(Rt,{children:[f.isDragging&&c(DropCursor,{isActiveDrop:f.isOverCursor,innerRef:v,position:"top"}),r.documentMemberships.slice(0,p*Se.sidebarLimit).map((e=>c(Oo,{membership:e},e.id))),!d&&c(Nt,{onClick:u,label:`${n("Show more")}…`,disabled:o,depth:0}),o&&c(l,{column:!0,children:c(Ee,{children:c(PlaceholderCollections,{})})})]})]})})}):null}));const Ao=I.div.withConfig({componentId:"sc-1m25klg-0"})(["position:relative;transition:opacity 250ms ease;opacity:",";"],(e=>e.$isDragging?.1:1)),Po=e((function StarredLink({star:e}){const t=U(),{ui:n,collections:r,documents:o}=s(),[i,l,u]=wn(),{documentId:d,collectionId:h}=e,p=r.get(h),f=Lt(),g=Ht(e.documentId??e.collectionId),[v,y]=a.useState((e.documentId?e.documentId===n.activeDocumentId:e.collectionId===n.activeCollectionId)&&g===f);a.useEffect((()=>{(e.documentId===n.activeDocumentId&&g===f||e.collectionId===n.activeCollectionId&&g===f)&&y(!0)}),[e.documentId,e.collectionId,n.activeDocumentId,n.activeCollectionId,g,f]),a.useEffect((()=>{d&&o.fetch(d)}),[d,o]);const b=a.useCallback((e=>{e.preventDefault(),e.stopPropagation(),y((e=>!e))}),[]),D=a.useCallback((()=>d&&o.prefetchDocument(d)),[o,d]),getIndex=()=>{const t=e?.next();return Rr(e?.index||null,t?.index||null)},{label:w,icon:I}=useSidebarLabelAndIcon(e,c(A.StarredIcon,{color:t.yellow})),[{isDragging:C},S]=function useDragStar(e){const t=e.id,n=U(),{label:r,icon:o}=useSidebarLabelAndIcon(e,c(A.StarredIcon,{color:n.yellow})),[{isDragging:i},s,l]=useDrag({type:"star",item:()=>({id:t,title:r,icon:o}),collect:e=>({isDragging:!!e.isDragging()})});return a.useEffect((()=>{l(getEmptyImage(),{captureDraggingState:!0})}),[l]),[{isDragging:i},s]}(e),[E,T]=useDropToReorderStar(getIndex),[O,_]=useDropToCreateStar(getIndex),x=v&&!C,P=m(k,{children:[E.isDragging&&c(DropCursor,{isActiveDrop:E.isOverCursor,innerRef:T}),O.isDragging&&c(DropCursor,{isActiveDrop:O.isOverCursor,innerRef:_})]});if(d){const t=o.get(d);if(!t)return null;const n=t.collectionId?r.get(t.collectionId):void 0,s=n?n.getChildrenForDocument(d):[],a=s.length>0;return m(k,{children:[c(Ao,{ref:S,$isDragging:C,children:c(Nt,{depth:0,to:{pathname:t.url,state:{sidebarContext:g}},expanded:a&&!C?v:void 0,onDisclosureClick:b,onClickIntent:D,icon:I,isActive:(e,t)=>!!e&&t.state?.sidebarContext===g,label:w,exact:!1,showActions:i,menu:t&&!C?c(le,{children:c(jt,{document:t,onOpen:l,onClose:u})}):void 0})},e.id),c(Mt.Provider,{value:g,children:m(Rt,{children:[c(Folder,{expanded:x,children:s.map(((e,t)=>c(co,{node:e,collection:n,activeDocument:o.active,prefetchDocument:o.prefetchDocument,isDraft:e.isDraft,depth:2,index:t},e.id)))}),P]})})]})}return p?m(Mt.Provider,{value:g,children:[c(Ao,{ref:S,$isDragging:C,children:c(ro,{collection:p,expanded:C?void 0:x,activeDocument:o.active,onDisclosureClick:b,isDraggingAnyCollection:E.isDragging})},e?.id),m(Rt,{children:[c(ho,{collection:p,expanded:x}),P]})]}):null}));const Ro=e((function Starred(){const{stars:e}=s(),{t:t}=i(),{loading:n,next:r,end:o,error:u,page:d}=usePaginatedRequest(e.fetchPage),[h,p]=useDropToReorderStar(),[f,v]=useDropToCreateStar();return a.useEffect((()=>{u&&g.error(t("Could not load starred documents"))}),[t,u]),e.orderedData.length?c(l,{column:!0,children:c(Ft,{id:"starred",title:t("Starred"),children:m(Rt,{children:[h.isDragging&&c(DropCursor,{isActiveDrop:h.isOverCursor,innerRef:p,position:"top"}),f.isDragging&&c(DropCursor,{isActiveDrop:f.isOverCursor,innerRef:v,position:"top"}),e.orderedData.slice(0,10*d).map((e=>c(Po,{star:e},e.id))),!o&&c(Nt,{onClick:r,label:`${t("Show more")}…`,disabled:e.isFetching,depth:0}),n&&c(l,{column:!0,children:c(Ee,{children:c(PlaceholderCollections,{})})})]})})}):null}));const No=e((function TrashLink(){const{policies:e,dialogs:t,documents:n}=s(),{t:r}=i(),[{isDocumentDropping:o},a]=useDrop({accept:"document",drop:async e=>{const o=n.get(e.id);o&&t.openModal({title:r("Delete {{ documentName }}",{documentName:o?.noun}),content:c(Ut,{document:o,onSubmit:t.closeAllModals})})},canDrop:t=>e.abilities(t.id).delete,collect:e=>({isDocumentDropping:e.isOver()})});return c("div",{ref:a,children:c(Nt,{to:Te(),icon:c(A.TrashIcon,{open:o}),exact:!1,label:r("Trash"),active:n.active?.isDeleted,isActiveDrop:o})})}));const jo=I.div.withConfig({componentId:"sc-jyttl8-0"})(["overflow:hidden;flex-shrink:0;"]),Lo=e((function AppSidebar(){const{t:e}=i(),{documents:t,ui:n,collections:r}=s(),o=sn(),l=tn(),u=an(o);a.useEffect((()=>{r.fetchAll(),l.isViewer||t.fetchDrafts()}),[t,r,l.isViewer]);const[d,h]=a.useState(),p=a.useCallback((e=>h(e)),[]),f=a.useMemo((()=>({rootElement:d})),[d]);return m(qt,{hidden:!n.readyToShow,ref:p,children:[c(HistoryNavigation,{}),d&&m(rr,{backend:yr,options:f,children:[c(DragPlaceholder,{}),c(Pr,{children:t=>c(Wt,{...t,title:o.name,image:c(pn,{model:o,size:24,alt:e("Logo"),style:{marginLeft:4}}),children:c(T,{content:e("Toggle sidebar"),shortcut:`${ke}+.`,children:c(zt,{position:"bottom",image:c(A.SidebarIcon,{}),onClick:()=>{n.toggleCollapsedSidebar(),document.activeElement?.blur()}})})})}),c(jo,{children:m(Vt,{children:[c(Nt,{to:Oe(),icon:c(A.HomeIcon,{}),exact:!1,label:e("Home")}),c(Nt,{to:_e(),icon:c(A.SearchIcon,{}),label:e("Search"),exact:!1}),u.createDocument&&c(Do,{})]})}),m(xe,{flex:!0,shadow:!0,children:[c(Vt,{children:c(Ro,{})}),c(Vt,{children:c(xo,{})}),c(Vt,{children:c(yo,{})}),u.createDocument&&c(Vt,{auto:!0,children:c(bo,{})}),m(Vt,{children:[u.createDocument&&c(No,{}),c(mo,{action:Cr})]})]})]})]})}));const Mo=I(l).withConfig({componentId:"sc-1ylpu3q-0"})(["position:fixed;top:0;bottom:0;max-width:80%;"]),Fo=I(Kt.div).withConfig({componentId:"sc-1ylpu3q-1"})(["display:block;flex-shrink:0;background:",";max-width:80%;border-left:1px solid ",";transition:border-left 100ms ease-in-out;z-index:",";"," ",""],j("background"),j("divider"),Ae.sidebar,Pe("mobile","tablet")`
    display: flex;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    z-index: ${Ae.mobileSidebar};
  `,Pe("tablet")`
    position: relative;
  `),Bo=e((function Right({children:e,border:t,className:n}){const r=U(),{ui:o}=s(),[i,l]=a.useState(!1),u=Re(),d=r.sidebarMaxWidth,h=r.sidebarMinWidth+16,p=a.useCallback((e=>{e.preventDefault();const t=Math.max(Math.min(window.innerWidth-e.pageX,d),h);o.set({sidebarRightWidth:t})}),[h,d,o]),f=a.useCallback((()=>{o.set({sidebarRightWidth:r.sidebarRightWidth})}),[o,r.sidebarRightWidth]),g=a.useCallback((()=>{l(!1),document.activeElement&&document.activeElement.blur()}),[]),v=a.useCallback((e=>{e.preventDefault(),l(!0)}),[]);a.useEffect((()=>(i&&(document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)})),[i,p,g]);const y=a.useMemo((()=>({width:`${o.sidebarRightWidth}px`})),[o.sidebarRightWidth]),b={initial:{width:0,opacity:.9},animate:{transition:i?{duration:0}:{type:"spring",bounce:.2,duration:Ne/1e3},width:o.sidebarRightWidth,opacity:1},exit:{width:0,opacity:0}};return c(Fo,{...b,$border:t,className:n,children:m(Mo,{style:y,column:!0,children:[c(je,{children:e}),!u&&c(Yt,{onMouseDown:v,onDoubleClick:f,dir:"right"})]})})}));var $o=Me,Ho=Le,Uo=Object.prototype.hasOwnProperty;const qo=D(Ho((function(e,t,n){Uo.call(e,n)?e[n].push(t):$o(e,n,[t])})));function ZapierIcon({size:e=24,color:t="currentColor"}){return c("svg",{width:e,height:e,fill:t,viewBox:"0 0 24 24",version:"1.1",children:c("path",{d:"M14,12.00348 C13.9996,12.59796 13.89092,13.16708 13.6928,13.69244 C13.16752,13.89072 12.59816,13.99964 12.00344,14.00004 L11.99656,14.00004 C11.40216,13.99964 10.83296,13.89104 10.30768,13.69284 C10.10952,13.16764 10.0004,12.59828 10,12.00364 L10,11.99672 C10.0004,11.40224 10.10928,10.83312 10.30712,10.3078 C10.83264,10.10964 11.40192,10.0006 11.99656,10.0002 L12.00344,10.0002 C12.59816,10.0006 13.16752,10.10964 13.69276,10.3078 C13.89076,10.83316 13.99956,11.40228 13.99996,11.99676 L13.99996,12.00368 L13.99996,12.0036 L14,12.00348 Z M19.8888,10.66668 L15.21896,10.66668 L18.52096,7.36468 C18.2617173,7.00059444 17.9725547,6.65876921 17.65648,6.34276 L17.65632,6.34244 C17.340564,6.02673022 16.9990638,5.73786527 16.63536,5.47884 L13.33336,8.78084 L13.33336,4.11128 C12.894135,4.03747693 12.4495423,4.00025584 12.00416,4 L11.99568,4 C11.5503533,4.00023789 11.1058145,4.03743219 10.66664,4.1112 L10.66664,8.78108 L7.36464,5.47908 C7.00075543,5.7381962 6.65910565,6.02719699 6.34324,6.34308 L6.34204,6.34416 C6.02660762,6.65978768 5.73799769,7.00112635 5.4792,7.36464 L8.7812,10.66664 L4.1112,10.66664 C4.1112,10.66664 4.00016,11.54384 4,11.99704 L4,12.00284 C4.00016664,12.4487002 4.03736113,12.8937765 4.1112,13.33348 L8.78104,13.33348 L5.47904,16.63548 C5.99830995,17.3645251 6.63559493,18.0018101 7.36464,18.52108 L10.66664,15.21916 L10.66664,19.8888 C11.1053956,19.962476 11.5495017,19.9996699 11.9944,20 L12.00584,20 C12.4506842,19.999644 12.8947349,19.9624502 13.33344,19.8888 L13.33344,15.21892 L16.63544,18.52092 C16.9992044,18.2618792 17.3407586,17.972987 17.65656,17.65724 L17.65736,17.65664 C17.9730579,17.3408301 18.2619218,16.9992911 18.52096,16.63556 L15.21896,13.33348 L19.8888,13.33348 C19.9624671,12.8947771 19.999661,12.4507249 20,12.00588 L20,11.9944 C19.999644,11.5495558 19.9624502,11.1055051 19.8888,10.6668 L19.8888,10.66668 Z"})})}const Wo=Fe((()=>Be((()=>import("./ApiKeys.vtxFGv2U.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])))),zo=Fe((()=>Be((()=>import("./PersonalApiKeys.ChFwNFt9.js")),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])))),Vo=Fe((()=>Be((()=>import("./Details.DZuCkk_e.js")),__vite__mapDeps([24,1,25,12,9,26,8,13,5,6,14,15,16,11,3,4,17,18,19,20,21,27,28,29,30,31])))),Ko=Fe((()=>Be((()=>import("./Export.jGbT5Dg_.js")),__vite__mapDeps([32,1,3,4,5,6,11,33,2,17,8,9,13,14,12,15,16,18,19,20,21,29,30,25,31])))),Yo=Fe((()=>Be((()=>import("./Features.bKqccryN.js")),__vite__mapDeps([34,1,6,12,9,19,28])))),Go=Fe((()=>Be((()=>import("./Groups.NrUrJvo7.js")),__vite__mapDeps([35,1,2,6,19,20,11,36,13,5,14,12,9,8,15,16,3,4,17,18,21,25,37,38,29,30,31])))),Xo=Fe((()=>Be((()=>import("./Import.WaAXxgEk.js")),__vite__mapDeps([39,1,13,5,6,14,12,9,8,15,16,11,3,4,17,18,19,20,21,40,33,2,29,30,25,31])))),Zo=Fe((()=>Be((()=>import("./Members._2N4ROj9.js")),__vite__mapDeps([41,1,2,6,13,5,14,12,9,8,15,16,11,3,4,17,18,19,20,21,36,42,29,30,25,31])))),Jo=Fe((()=>Be((()=>import("./Notifications.2xVrAdSX.js")),__vite__mapDeps([43,1,30,6,12,9,19,11,20,28])))),Qo=Fe((()=>Be((()=>import("./Preferences.8hMJHilO.js")),__vite__mapDeps([44,1,26,8,9,13,5,6,14,12,15,16,11,3,4,17,18,19,20,21,28])))),ei=Fe((()=>Be((()=>import("./Profile.I-u9yjlz.js")),__vite__mapDeps([45,1,6,11,27,15,16,14,3,4,5,28,13,12,9,8,17,18,19,20,21,29,30,25,31])))),ti=Fe((()=>Be((()=>import("./Security.4FMzq2Cn.js")),__vite__mapDeps([46,1,4,26,8,9,13,5,6,14,12,15,16,11,3,17,18,19,20,21,47,28])))),ni=Fe((()=>Be((()=>import("./SelfHosted.AZ04syn3.js")),__vite__mapDeps([48,1,18,6,28])))),ri=Fe((()=>Be((()=>import("./Shares.m0nQ04z8.js")),__vite__mapDeps([49,1,30,6,19,20,11,36,13,5,14,12,9,8,15,16,3,4,17,18,21,10,50])))),oi=Fe((()=>Be((()=>import("./Templates.ONh1MLcK.js")),__vite__mapDeps([51,1,2,52,53,4,3,5,54,8,9,13,6,14,12,15,16,11,17,18,19,20,21,55,56,57,29,30,25,31])))),ii=Fe((()=>Be((()=>import("./Zapier.MTZtSdhA.js")),__vite__mapDeps([58,1,6,13,5,14,12,9,8,15,16,11,3,4,17,18,19,20,21,29,30,25,31])))),useSettingsConfig=()=>{const e=tn(),t=sn(),n=an(t),{t:r}=i();return $e((()=>{const o=[{name:r("Profile"),path:Y(),component:ei,enabled:!0,group:r("Account"),icon:A.ProfileIcon},{name:r("Preferences"),path:Y("preferences"),component:Qo,enabled:!0,group:r("Account"),icon:A.SettingsIcon},{name:r("Notifications"),path:Y("notifications"),component:Jo,enabled:!0,group:r("Account"),icon:A.EmailIcon},{name:r("API Keys"),path:Y("personal-api-keys"),component:zo,enabled:n.createApiKey&&!n.listApiKeys,group:r("Account"),icon:A.CodeIcon},{name:r("Details"),path:Y("details"),component:Vo,enabled:n.update,group:r("Workspace"),icon:A.TeamIcon},{name:r("Security"),path:Y("security"),component:ti,enabled:n.update,group:r("Workspace"),icon:A.PadlockIcon},{name:r("Features"),path:Y("features"),component:Yo,enabled:n.update,group:r("Workspace"),icon:A.BeakerIcon},{name:r("Members"),path:Y("members"),component:Zo,enabled:n.listUsers,group:r("Workspace"),icon:A.UserIcon},{name:r("Groups"),path:Y("groups"),component:Go,enabled:n.listGroups,group:r("Workspace"),icon:A.GroupIcon},{name:r("Templates"),path:Y("templates"),component:oi,enabled:n.readTemplate,group:r("Workspace"),icon:A.ShapesIcon},{name:r("API Keys"),path:Y("api-keys"),component:Wo,enabled:n.listApiKeys,group:r("Workspace"),icon:A.CodeIcon},{name:r("Shared Links"),path:Y("shares"),component:ri,enabled:n.listShares,group:r("Workspace"),icon:A.GlobeIcon},{name:r("Import"),path:Y("import"),component:Xo,enabled:n.createImport,group:r("Workspace"),icon:A.ImportIcon},{name:r("Export"),path:Y("export"),component:Ko,enabled:n.createExport,group:r("Workspace"),icon:A.ExportIcon},{name:r("Self Hosted"),path:En("self-hosted"),component:ni,enabled:n.update&&!He,group:r("Integrations"),icon:A.BuildingBlocksIcon},{name:"Zapier",path:En("zapier"),component:ii,enabled:n.update&&He,group:r("Integrations"),icon:ZapierIcon}];return Ue.getHooks(qe.Settings).forEach((i=>{const s=i.value.group??"Integrations",a=i.value.after?o.findIndex((e=>e.name===r(i.value.after)))+1:o.findIndex((e=>e.group===r(s)));o.splice(a,0,{name:r(i.name),path:"Integrations"===s?En(i.id):Y(i.id),group:r(s),component:i.value.component,enabled:i.value.enabled?i.value.enabled(t,e):n.update,icon:i.value.icon})})),o}),[r,n.createApiKey,n.update,n.createImport,n.createExport]).filter((e=>e.enabled))};function Version(){const[e,t]=a.useState(-1),{t:n}=i();return a.useEffect((()=>{!async function loadVersionInfo(){try{const e=await P.post("/installation.info");e.data&&e.data.versionsBehind>=0&&t(e.data.versionsBehind)}catch(e){We.error("Failed to load version info",e)}}()}),[]),c(Nt,{target:"_blank",href:"https://github.com/outline/outline/releases",label:m(k,{children:["v","0.82.0",e>=0&&m(k,{children:[c("br",{}),c(si,{children:0===e?n("Up to date"):n("{{ releasesBehind }} versions behind",{releasesBehind:e,count:e})})]})]})})}const si=I(vn).withConfig({componentId:"sc-1t8r2ba-0"})(["margin-left:0;"]);const ai=I(A.BackIcon).withConfig({componentId:"sc-16qcmzt-0"})(["margin-left:4px;"]),ci=e((function SettingsSidebar(){const{ui:e}=s(),{t:r}=i(),o=t(),u=n(),d=useSettingsConfig(),h=qo(d,"group"),p=a.useCallback((()=>{o.push("/home")}),[o]);return m(qt,{children:[c(HistoryNavigation,{}),c(Wt,{title:r("Return to App"),image:c(ai,{}),onClick:p,children:c(T,{content:r("Toggle sidebar"),shortcut:`${ke}+.`,children:c(zt,{position:"bottom",image:c(A.SidebarIcon,{}),onClick:()=>{e.toggleCollapsedSidebar(),document.activeElement?.blur()}})})}),c(l,{auto:!0,column:!0,children:m(xe,{shadow:!0,children:[Object.keys(h).map((e=>c(Vt,{children:c(Ft,{title:e,children:h[e].map((e=>c(Nt,{to:e.path,active:e.path!==Y()?u.pathname.startsWith(e.path):void 0,icon:c(e.icon,{}),label:e.name},e.path)))})},e))),!He&&m(Vt,{children:[c(Ft,{title:r("Installation")}),c(Version,{})]})]})})]})})),li=Fe((()=>Be((()=>import("./Comments.HH_GK8c1.js")),__vite__mapDeps([59,1,13,5,6,14,12,9,8,15,16,11,3,4,17,18,19,20,21,60,61,26,38,62])))),ui=Fe((()=>Be((()=>import("./History.ASukySGY.js")),__vite__mapDeps([63,1,64,3,4,5,15,16,17,13,6,14,12,9,8,11,18,19,20,21,65,62,29,30,25,31])))),di=Fe((()=>Be((()=>import("./Insights.M-1Y2_sl.js")),__vite__mapDeps([66,1,15,16,13,5,6,14,12,9,8,11,3,4,17,18,19,20,21,67,68,62])))),hi=Fe((()=>Be((()=>import("./index.oa4p8Kbs.js")),__vite__mapDeps([69,1,13,5,6,14,12,9,8,15,16,11,3,4,17,18,19,20,21,70,65,29,30,25,31])))),pi=e((({children:e})=>{const{ui:t,auth:r}=s(),o=n(),i=a.useRef(null),l=an(t.activeDocumentId),u=an(t.activeCollectionId),d=sn(),goToSearch=e=>{e.metaKey||e.ctrlKey||(e.preventDefault(),e.stopPropagation(),K.push(_e()))};if(r.isSuspended)return c(kn,{});const h=c(le,{children:m(Ge,{children:[c(Ke,{path:Y(),component:ci}),c(Ke,{component:Lo})]})}),p=!!ze(o.pathname,{path:Xe})&&l.listRevisions,f=!!ze(o.pathname,{path:Ze})&&l.listViews,g=!f&&!p&&l.comment&&t.activeDocumentId&&t.commentsExpanded&&d.getPreference(Ve.Commenting),v=c(Gt,{initial:!1,children:(p||f||g)&&c(Ke,{path:`/doc/${Ye}`,children:c(Bo,{children:m(a.Suspense,{fallback:null,children:[p&&c(ui,{}),f&&c(di,{}),g&&c(li,{})]})})})},t.activeDocumentId?"active":"inactive");return c(Xt,{children:c(Zt.Provider,{value:i.current,children:m(Jt,{title:d.name,sidebar:h,sidebarRight:v,ref:i,children:[c(Qt,{trigger:"n",handler:e=>{if(e.metaKey||e.altKey)return;const{activeCollectionId:n}=t;n&&u.createDocument&&K.push(X(n))}}),c(Qt,{trigger:"t",handler:goToSearch}),c(Qt,{trigger:"/",handler:goToSearch}),e,c(a.Suspense,{fallback:null,children:c(hi,{})})]})})})})),fi=Object.create(null);fi.open="0",fi.close="1",fi.ping="2",fi.pong="3",fi.message="4",fi.upgrade="5",fi.noop="6";const gi=Object.create(null);Object.keys(fi).forEach((e=>{gi[fi[e]]=e}));const mi={type:"error",data:"parser error"},vi="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),yi="function"==typeof ArrayBuffer,isView$1=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,encodePacket=({type:e,data:t},n,r)=>vi&&t instanceof Blob?n?r(t):encodeBlobAsBase64(t,r):yi&&(t instanceof ArrayBuffer||isView$1(t))?n?r(t):encodeBlobAsBase64(new Blob([t]),r):r(fi[e]+(t||"")),encodeBlobAsBase64=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function toArray(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let bi;const Di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wi="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let fs=0;fs<64;fs++)wi[Di.charCodeAt(fs)]=fs;const Ii="function"==typeof ArrayBuffer,decodePacket=(e,t)=>{if("string"!=typeof e)return{type:"message",data:mapBinary(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:decodeBase64Packet(e.substring(1),t)};return gi[n]?e.length>1?{type:gi[n],data:e.substring(1)}:{type:gi[n]}:mi},decodeBase64Packet=(e,t)=>{if(Ii){const n=(e=>{let t,n,r,o,i,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const l=new ArrayBuffer(s),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=wi[e.charCodeAt(t)],r=wi[e.charCodeAt(t+1)],o=wi[e.charCodeAt(t+2)],i=wi[e.charCodeAt(t+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|o>>2,u[c++]=(3&o)<<6|63&i;return l})(e);return mapBinary(n,t)}return{base64:!0,data:e}},mapBinary=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,Ci=String.fromCharCode(30);function createPacketEncoderStream(){return new TransformStream({transform(e,t){!function encodePacketToBinary(e,t){return vi&&e.data instanceof Blob?e.data.arrayBuffer().then(toArray).then(t):yi&&(e.data instanceof ArrayBuffer||isView$1(e.data))?t(toArray(e.data)):void encodePacket(e,!1,(e=>{bi||(bi=new TextEncoder),t(bi.encode(e))}))}(e,(n=>{const r=n.length;let o;if(r<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,r);else if(r<65536){o=new Uint8Array(3);const e=new DataView(o.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{o=new Uint8Array(9);const e=new DataView(o.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!=typeof e.data&&(o[0]|=128),t.enqueue(o),t.enqueue(n)}))}})}let Si;function totalLength(e){return e.reduce(((e,t)=>e+t.length),0)}function concatChunks(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let o=0;o<t;o++)n[o]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function Emitter(e){if(e)return function mixin(e){for(var t in Emitter.prototype)e[t]=Emitter.prototype[t];return e}(e)}Emitter.prototype.on=Emitter.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Emitter.prototype.once=function(e,t){function on2(){this.off(e,on2),t.apply(this,arguments)}return on2.fn=t,this.on(e,on2),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},Emitter.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},Emitter.prototype.emitReserved=Emitter.prototype.emit,Emitter.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Emitter.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Ei="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Ti="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function pick(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const ki=Ti.setTimeout,Oi=Ti.clearTimeout;function installTimerFunctions(e,t){t.useNativeTimers?(e.setTimeoutFn=ki.bind(Ti),e.clearTimeoutFn=Oi.bind(Ti)):(e.setTimeoutFn=Ti.setTimeout.bind(Ti),e.clearTimeoutFn=Ti.clearTimeout.bind(Ti))}function randomString(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class TransportError extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class Transport extends Emitter{constructor(e){super(),this.writable=!1,installTimerFunctions(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new TransportError(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function encode(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class Polling extends Transport{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const pause=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",(function(){--e||pause()}))),this.writable||(e++,this.once("drain",(function(){--e||pause()})))}else pause()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(Ci),r=[];for(let o=0;o<n.length;o++){const e=decodePacket(n[o],t);if(r.push(e),"error"===e.type)break}return r})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const close=()=>{this.write([{type:"close"}])};"open"===this.readyState?close():this.once("open",close)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let o=0;e.forEach(((e,i)=>{encodePacket(e,!1,(e=>{r[i]=e,++o===n&&t(r.join(Ci))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=randomString()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let _i=!1;try{_i="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(ps){}const xi=_i;function empty(){}class BaseXHR extends Polling{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}class Request extends Emitter{constructor(e,t,n){super(),this.createRequest=e,installTimerFunctions(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=pick(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(r){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{n.setRequestHeader("Accept","*/*")}catch(r){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn((()=>{this._onError("number"==typeof n.status?n.status:0)}),0))},n.send(this._data)}catch(r){return void this.setTimeoutFn((()=>{this._onError(r)}),0)}"undefined"!=typeof document&&(this._index=Request.requestsCount++,Request.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=empty,e)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Request.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(Request.requestsCount=0,Request.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){addEventListener("onpagehide"in Ti?"pagehide":"unload",unloadHandler,!1)}function unloadHandler(){for(let e in Request.requests)Request.requests.hasOwnProperty(e)&&Request.requests[e].abort()}const Ai=function(){const e=newRequest({xdomain:!1});return e&&null!==e.responseType}();function newRequest(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||xi))return new XMLHttpRequest}catch(n){}if(!t)try{return new(Ti[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}const Pi="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class BaseWS extends Transport{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Pi?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(ps){return this.emitReserved("error",ps)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;encodePacket(n,this.supportsBinary,(e=>{try{this.doWrite(n,e)}catch(t){}r&&Ei((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=randomString()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Ri=Ti.WebSocket||Ti.MozWebSocket;const Ni={websocket:class WS extends BaseWS{createSocket(e,t,n){return Pi?new Ri(e,t,n):t?new Ri(e,t):new Ri(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class WT extends Transport{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(ps){return this.emitReserved("error",ps)}this._transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((e=>{const t=function createPacketDecoderStream(e,t){Si||(Si=new TextDecoder);const n=[];let r=0,o=-1,i=!1;return new TransformStream({transform(s,a){for(n.push(s);;){if(0===r){if(totalLength(n)<1)break;const e=concatChunks(n,1);i=!(128&~e[0]),o=127&e[0],r=o<126?3:126===o?1:2}else if(1===r){if(totalLength(n)<2)break;const e=concatChunks(n,2);o=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(totalLength(n)<8)break;const e=concatChunks(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),i=t.getUint32(0);if(i>Math.pow(2,21)-1){a.enqueue(mi);break}o=i*Math.pow(2,32)+t.getUint32(4),r=3}else{if(totalLength(n)<o)break;const e=concatChunks(n,o);a.enqueue(decodePacket(i?e:Si.decode(e),t)),r=0}if(0===o||o>e){a.enqueue(mi);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=createPacketEncoderStream();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const read=()=>{n.read().then((({done:e,value:t})=>{e||(this.onPacket(t),read())})).catch((e=>{}))};read();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then((()=>this.onOpen()))}))}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then((()=>{r&&Ei((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class XHR extends BaseXHR{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Ai&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Request(newRequest,this.uri(),e)}}},ji=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Li=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let o=ji.exec(e||""),i={},s=14;for(;s--;)i[Li[s]]=o[s]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function pathNames(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,i.path),i.queryKey=function queryKey(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,i.query),i}const Mi="function"==typeof addEventListener&&"function"==typeof removeEventListener,Fi=[];Mi&&addEventListener("offline",(()=>{Fi.forEach((e=>e()))}),!1);class SocketWithoutUpgrade extends Emitter{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const n=parse(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=parse(t.host).host);installTimerFunctions(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach((e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e})),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function decode(e){let t={},n=e.split("&");for(let r=0,o=n.length;r<o;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),Mi&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Fi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);const e=this.opts.rememberUpgrade&&SocketWithoutUpgrade.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(e=>this._onClose("transport close",e)))}onOpen(){this.readyState="open",SocketWithoutUpgrade.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(e+="string"==typeof(t=r)?function utf8Length(e){let t=0,n=0;for(let r=0,o=e.length;r<o;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))),n>0&&e>this._maxPayload)return this.writeBuffer.slice(0,n);e+=2}var t;return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Ei((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const o={type:e,data:t,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const close=()=>{this._onClose("forced close"),this.transport.close()},cleanupAndClose=()=>{this.off("upgrade",cleanupAndClose),this.off("upgradeError",cleanupAndClose),close()},waitForUpgrade=()=>{this.once("upgrade",cleanupAndClose),this.once("upgradeError",cleanupAndClose)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?waitForUpgrade():close()})):this.upgrading?waitForUpgrade():close()),this}_onError(e){if(SocketWithoutUpgrade.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Mi&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=Fi.indexOf(this._offlineEventListener);-1!==e&&Fi.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}SocketWithoutUpgrade.protocol=4;class SocketWithUpgrade extends SocketWithoutUpgrade{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;SocketWithoutUpgrade.priorWebsocketSuccess=!1;const onTransportOpen=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;SocketWithoutUpgrade.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(cleanup(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function freezeTransport(){n||(n=!0,cleanup(),t.close(),t=null)}const onerror=e=>{const n=new Error("probe error: "+e);n.transport=t.name,freezeTransport(),this.emitReserved("upgradeError",n)};function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(e){t&&e.name!==t.name&&freezeTransport()}const cleanup=()=>{t.removeListener("open",onTransportOpen),t.removeListener("error",onerror),t.removeListener("close",onTransportClose),this.off("close",onclose),this.off("upgrading",onupgrade)};t.once("open",onTransportOpen),t.once("error",onerror),t.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Bi=class Socket extends SocketWithUpgrade{constructor(e,t={}){const n="object"==typeof e?e:t;(!n.transports||n.transports&&"string"==typeof n.transports[0])&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map((e=>Ni[e])).filter((e=>!!e))),super(e,n)}};const $i="function"==typeof ArrayBuffer,Hi=Object.prototype.toString,Ui="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Hi.call(Blob),qi="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Hi.call(File);function isBinary(e){return $i&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Ui&&e instanceof Blob||qi&&e instanceof File}function hasBinary(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(hasBinary(e[t]))return!0;return!1}if(isBinary(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return hasBinary(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&hasBinary(e[n]))return!0;return!1}function deconstructPacket(e){const t=[],n=e.data,r=e;return r.data=_deconstructPacket(n,t),r.attachments=t.length,{packet:r,buffers:t}}function _deconstructPacket(e,t){if(!e)return e;if(isBinary(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=_deconstructPacket(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=_deconstructPacket(e[r],t));return n}return e}function reconstructPacket(e,t){return e.data=_reconstructPacket(e.data,t),delete e.attachments,e}function _reconstructPacket(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=_reconstructPacket(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=_reconstructPacket(e[n],t));return e}const Wi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var zi,Vi;(Vi=zi||(zi={}))[Vi.CONNECT=0]="CONNECT",Vi[Vi.DISCONNECT=1]="DISCONNECT",Vi[Vi.EVENT=2]="EVENT",Vi[Vi.ACK=3]="ACK",Vi[Vi.CONNECT_ERROR=4]="CONNECT_ERROR",Vi[Vi.BINARY_EVENT=5]="BINARY_EVENT",Vi[Vi.BINARY_ACK=6]="BINARY_ACK";function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}class Decoder extends Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===zi.BINARY_EVENT;n||t.type===zi.BINARY_ACK?(t.type=n?zi.EVENT:zi.ACK,this.reconstructor=new BinaryReconstructor(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!isBinary(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===zi[n.type])throw new Error("unknown packet type "+n.type);if(n.type===zi.BINARY_EVENT||n.type===zi.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!Decoder.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case zi.CONNECT:return isObject(t);case zi.DISCONNECT:return void 0===t;case zi.CONNECT_ERROR:return"string"==typeof t||isObject(t);case zi.EVENT:case zi.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Wi.indexOf(t[0]));case zi.ACK:case zi.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Ki=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Decoder,Encoder:class Encoder{constructor(e){this.replacer=e}encode(e){return e.type!==zi.EVENT&&e.type!==zi.ACK||!hasBinary(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===zi.EVENT?zi.BINARY_EVENT:zi.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==zi.BINARY_EVENT&&e.type!==zi.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=deconstructPacket(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}},get PacketType(){return zi},protocol:5},Symbol.toStringTag,{value:"Module"}));function on(e,t,n){return e.on(t,n),function subDestroy(){e.off(t,n)}}const Yi=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket2 extends Emitter{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[on(e,"open",this.onopen.bind(this)),on(e,"packet",this.onpacket.bind(this)),on(e,"error",this.onerror.bind(this)),on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,o;if(Yi.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const i={type:zi.EVENT,data:t,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,n=t.pop();this._registerAckCallback(e,n),i.id=e}const s=null===(r=null===(n=this.io.engine)||void 0===n?void 0:n.transport)||void 0===r?void 0:r.writable,a=this.connected&&!(null===(o=this.io.engine)||void 0===o?void 0:o._hasPingExpired());return this.flags.volatile&&!s||(a?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const o=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r),fn=(...e)=>{this.io.clearTimeoutFn(o),t.apply(this,e)};fn.withError=!0,this.acks[e]=fn}emitWithAck(e,...t){return new Promise(((n,r)=>{const fn=(e,t)=>e?r(e):n(t);fn.withError=!0,t.push(fn),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;return null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:zi.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case zi.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case zi.EVENT:case zi.BINARY_EVENT:this.onevent(e);break;case zi.ACK:case zi.BINARY_ACK:this.onack(e);break;case zi.DISCONNECT:this.ondisconnect();break;case zi.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:zi.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:zi.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Backoff(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+n:e-n}return 0|Math.min(e,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(e){this.ms=e},Backoff.prototype.setMax=function(e){this.max=e},Backoff.prototype.setJitter=function(e){this.jitter=e};class Manager extends Emitter{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,installTimerFunctions(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||Ki;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Bi(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=on(t,"open",(function(){n.onopen(),e&&e()})),onError=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=on(t,"error",onError);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn((()=>{r(),onError(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(on(e,"ping",this.onping.bind(this)),on(e,"data",this.ondata.bind(this)),on(e,"error",this.onerror.bind(this)),on(e,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Ei((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Socket2(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Gi={};function lookup(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function url(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=parse(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+t,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,o=n.id,i=n.path,s=Gi[o]&&i in Gi[o].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?a=new Manager(r,t):(Gi[o]||(Gi[o]=new Manager(r,t)),a=Gi[o]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}Object.assign(lookup,{Manager:Manager,Socket:Socket2,io:lookup,connect:lookup});let Xi="hidden",Zi="visibilitychange";function getVisibilityListener(){return Zi}"hidden"in document?(Xi="hidden",Zi="visibilitychange"):"mozHidden"in document?(Xi="mozHidden",Zi="mozvisibilitychange"):"webkitHidden"in document&&(Xi="webkitHidden",Zi="webkitvisibilitychange");var Ji=Object.defineProperty,Qi=Object.getOwnPropertyDescriptor,__decorateClass=(e,t,n,r)=>{for(var o,i=r>1?void 0:r?Qi(t,n):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(r?o(t,n,i):o(i))||i);return r&&i&&Ji(t,n,i),i};const es=a.createContext(null);let ts=class extends a.Component{constructor(){super(...arguments),this.checkConnection=()=>{this.socket?.disconnected&&function getPageVisible(){return!document[Xi]}()&&(this.socket.close(),this.socket=null,this.createConnection())},this.createConnection=()=>{this.socket=lookup(window.location.origin,{path:"/realtime",transports:["websocket"],reconnectionDelay:1e3,reconnectionDelayMax:3e4,withCredentials:!0}),ie(this.socket,"Socket should be defined"),this.socket.authenticated=!1;const{auth:e,documents:t,collections:n,groups:r,groupUsers:o,groupMemberships:i,pins:s,stars:a,memberships:c,users:l,userMemberships:u,policies:d,comments:h,subscriptions:p,fileOperations:f,notifications:m,imports:v}=this.props,y=e?.user?.id;this.socket.io.on("reconnect_attempt",(()=>{this.socket&&(this.socket.io.opts.transports=e?.team?.domain?["websocket"]:["websocket","polling"])})),this.socket.on("authenticated",(()=>{this.socket&&(this.socket.authenticated=!0)})),this.socket.on("unauthorized",(e=>{throw this.socket&&(this.socket.authenticated=!1),g.error(e.message),e})),this.socket.on("entities",Qe((async e=>{if(e.documentIds)for(const n of e.documentIds){const r=n.id;let o=t.get(r);const i=o?.title;if(o?.updatedAt!==n.updatedAt&&(o||e.fetchIfMissing)){try{o=await t.fetch(r,{force:!0})}catch(ps){if(ps instanceof $||ps instanceof et)return void t.remove(r)}if(o&&i!==o.title){e.collectionIds||(e.collectionIds=[]);!tt(e.collectionIds,{id:o.collectionId})&&o.collectionId&&e.collectionIds.push({id:o.collectionId})}}}if(e.collectionIds)for(const t of e.collectionIds){const r=t.id,o=n.get(r);if(o?.updatedAt!==t.updatedAt&&(o?.documents||e.fetchIfMissing))try{await(o?.fetchDocuments({force:!0}))}catch(ps){if(ps instanceof $||ps instanceof et)return c.removeAll({collectionId:r}),void n.remove(r)}}}))),this.socket.on("documents.update",Qe((e=>{if(t.add(e),e.collectionId){const t=n.get(e.collectionId);t?.updateDocument(e)}}))),this.socket.on("documents.unpublish",Qe((e=>{const r=e.document;r.collectionId||r.createdBy?.id===y?t.add(r):t.remove(r.id),d.remove(r.id);const o=n.get(e.collectionId);o?.removeDocument(r.id)}))),this.socket.on("documents.archive",Qe((e=>{if(t.addToArchive(e),e.collectionId){const t=n.get(e.collectionId);t?.removeDocument(e.id)}}))),this.socket.on("documents.delete",Qe((e=>{if(t.add(e),d.remove(e.id),e.collectionId){const t=n.get(e.collectionId);t?.removeDocument(e.id)}u.orderedData.filter((t=>t.documentId===e.id)).forEach((e=>u.remove(e.id)))}))),this.socket.on("documents.permanent_delete",(e=>{t.remove(e.modelId)})),this.socket.on("documents.add_user",(async e=>{if(u.add(e),e.userId===y){const n=t.get(e.documentId);n&&n.childDocuments.forEach((e=>{d.remove(e.id)}))}await t.fetch(e.documentId,{force:e.userId===y})})),this.socket.on("documents.remove_user",(e=>{if(u.remove(e.id),e.userId===y){const n=t.get(e.documentId);n&&n.childDocuments.forEach((e=>{d.remove(e.id)}))}const n=d.get(e.documentId);n&&!1===n.abilities.read&&t.remove(e.documentId)})),this.socket.on("documents.add_group",(e=>{i.add(e);const n=r.get(e.groupId);if(y&&n?.users.map((e=>e.id)).includes(y)){const n=t.get(e.documentId);n&&n.childDocuments.forEach((e=>{d.remove(e.id)}))}})),this.socket.on("documents.remove_group",(e=>{i.remove(e.id)})),this.socket.on("comments.create",(e=>{h.add(e)})),this.socket.on("comments.update",(e=>{const t=h.get(e.id);t?.resolvedAt!==e.resolvedAt&&d.remove(e.id),h.add(e)})),this.socket.on("comments.delete",(e=>{h.remove(e.modelId)})),this.socket.on("comments.add_reaction",(e=>{const t=h.get(e.commentId);t?.updateReaction({type:"add",emoji:e.emoji,user:e.user})})),this.socket.on("comments.remove_reaction",(e=>{const t=h.get(e.commentId);t?.updateReaction({type:"remove",emoji:e.emoji,user:e.user})})),this.socket.on("groups.create",(e=>{r.add(e)})),this.socket.on("groups.update",(e=>{r.add(e)})),this.socket.on("groups.delete",(e=>{r.remove(e.modelId)})),this.socket.on("groups.add_user",(e=>{o.add(e)})),this.socket.on("groups.remove_user",(e=>{o.removeAll({groupId:e.groupId,userId:e.userId})})),this.socket.on("collections.create",(e=>{n.add(e)})),this.socket.on("collections.update",(e=>{n.add(e)})),this.socket.on("collections.delete",Qe((e=>{const r=e.modelId,o=(new Date).toISOString();t.inCollection(r).forEach((e=>{e.publishedAt?e.deletedAt=o:e.collectionId=null,d.remove(e.id)})),c.removeAll({collectionId:r}),n.remove(r)}))),this.socket.on("collections.archive",(async e=>{const r=e.id;await n.fetch(r,{force:!0}),t.unarchivedInCollection(r).forEach(Qe((t=>{t.publishedAt?t.archivedAt=e.archivedAt:t.collectionId=null,d.remove(t.id)})))})),this.socket.on("collections.restore",(async e=>{const r=e.id;t.archivedInCollection(r,{archivedAt:e.archivedAt}).forEach(Qe((e=>{e.archivedAt=null,d.remove(e.id)}))),await n.fetch(r,{force:!0})})),this.socket.on("teams.update",(n=>{"sharing"in n&&n.sharing!==e.team?.sharing&&t.all.forEach((e=>{d.remove(e.id)})),e.team?.updateData(n)})),this.socket.on("notifications.create",(e=>{m.add(e)})),this.socket.on("notifications.update",(e=>{m.add(e)})),this.socket.on("pins.create",(e=>{s.add(e)})),this.socket.on("pins.update",(e=>{s.add(e)})),this.socket.on("pins.delete",(e=>{s.remove(e.modelId)})),this.socket.on("stars.create",(e=>{a.add(e)})),this.socket.on("stars.update",(e=>{a.add(e)})),this.socket.on("stars.delete",(e=>{a.remove(e.modelId)})),this.socket.on("collections.add_user",(async e=>{c.add(e),await n.fetch(e.collectionId,{force:e.userId===y})})),this.socket.on("collections.remove_user",(e=>{c.remove(e.id);const t=d.get(e.collectionId);t&&!1===t.abilities.read&&n.remove(e.collectionId)})),this.socket.on("collections.add_group",(async e=>{i.add(e),await n.fetch(e.collectionId)})),this.socket.on("collections.remove_group",(async e=>{i.remove(e.id);const t=d.get(e.collectionId);t&&!1===t.abilities.read&&n.remove(e.collectionId)})),this.socket.on("collections.update_index",Qe((e=>{const t=n.get(e.collectionId);t?.updateIndex(e.index)}))),this.socket.on("fileOperations.create",(e=>{f.add(e)})),this.socket.on("fileOperations.update",(t=>{f.add(t),t.state===nt.Complete&&t.type===rt.Import&&t.user?.id===e.user?.id&&g.success(t.name,{description:this.props.t("Your import completed")})})),this.socket.on("imports.create",(e=>{v.add(e)})),this.socket.on("imports.update",(t=>{v.add(t),t.state===ot.Completed&&t.createdBy?.id===e.user?.id&&g.success(t.name,{description:this.props.t("Your import completed")})})),this.socket.on("subscriptions.create",(e=>{p.add(e)})),this.socket.on("subscriptions.delete",(e=>{p.remove(e.modelId)})),this.socket.on("users.update",(e=>{l.add(e)})),this.socket.on("users.demote",(async r=>{r.id===e.user?.id&&(t.all.forEach((e=>d.remove(e.id))),await n.fetchAll())})),this.socket.on("users.delete",(e=>{l.remove(e.modelId)})),this.socket.on("userMemberships.update",(async e=>{u.add(e)})),this.socket.on("join",(e=>{this.socket?.emit("join",e)})),this.socket.on("leave",(e=>{this.socket?.emit("leave",e)}))}}componentDidMount(){this.createConnection(),document.addEventListener(getVisibilityListener(),this.checkConnection)}componentWillUnmount(){this.socket&&(this.socket.authenticated=!1,this.socket.disconnect()),document.removeEventListener(getVisibilityListener(),this.checkConnection)}render(){return c(es.Provider,{value:this.socket,children:this.props.children})}};__decorateClass([it],ts.prototype,"socket",2),ts=__decorateClass([e],ts);const ns=Je()(yn(ts)),rs=Fe((()=>Be((()=>import("./settings.5EGqCYSv.js")),__vite__mapDeps([71,1,13,5,6,14,12,9,8,15,16,11,3,4,17,18,19,20,21,29,30,25,31])))),os=Fe((()=>Be((()=>import("./Archive.EmLCLt6O.js")),__vite__mapDeps([72,1,52,53,4,3,5,54,8,9,13,6,14,12,15,16,11,17,18,19,20,21,55,37,29,30,25,31])))),is=Fe((()=>Be((()=>import("./index.ONyROrOO.js")),__vite__mapDeps([73,1,2,12,9,54,8,13,5,6,14,15,16,11,3,4,17,18,19,20,21,74,75,52,53,55,76,68,56,57,70,38,30,29,25,31])))),ss=Fe((()=>Be((()=>import("./index.5JpVltn0.js")),__vite__mapDeps([77,1,64,30,6,13,5,14,12,9,8,15,16,11,3,4,17,18,19,20,21,78,79,40,74,60,54,80,2,67,38,65,37,56,57])))),as=Fe((()=>Be((()=>import("./Drafts.DKkxGZUZ.js")),__vite__mapDeps([81,1,82,42,8,9,3,4,5,13,6,14,12,15,16,11,17,18,19,20,21,2,75,52,53,54,55,37,83,29,30,25,31])))),cs=Fe((()=>Be((()=>import("./Home.Jf5BZVdS.js")),__vite__mapDeps([84,1,2,75,16,12,9,25,11,50,13,5,6,14,8,15,3,4,17,18,19,20,21,52,53,54,55,76,68,56,57,83,29,30,31])))),ls=Fe((()=>Be((()=>import("./index.OBvLokf1.js")),__vite__mapDeps([85,1,3,4,5,53,54,8,9,13,6,14,12,15,16,11,17,18,19,20,21,55,82,42,29,30,25,31])))),us=Fe((()=>Be((()=>import("./index.P37c2iVQ.js")),__vite__mapDeps([86,1,52,53,4,3,5,54,8,9,13,6,14,12,15,16,11,17,18,19,20,21,55,37,29,30,25,31])))),RedirectDocument=({match:e})=>c(at,{to:e.params.documentSlug?`/doc/${e.params.documentSlug}`:Oe()});const ds=e((function AuthenticatedRoutes(){const e=sn(),t=an(e);return c(ns,{children:c(pi,{children:c(a.Suspense,{fallback:c(u,{children:c(ct,{})}),children:m(Ge,{children:[t.createDocument&&c(st,{exact:!0,path:be(),component:as}),t.createDocument&&c(st,{exact:!0,path:ye(),component:os}),t.createDocument&&c(st,{exact:!0,path:Te(),component:us}),c(st,{path:`${Oe()}/:tab?`,component:cs}),c(at,{from:"/dashboard",to:Oe()}),c(at,{exact:!0,from:"/starred",to:Oe()}),c(at,{exact:!0,from:"/templates",to:Y("templates")}),c(at,{exact:!0,from:"/collections/*",to:"/collection/*"}),c(st,{exact:!0,path:"/collection/:id/new",component:Tn}),c(st,{exact:!0,path:"/collection/:id/:tab?",component:is}),c(st,{exact:!0,path:"/doc/new",component:Tn}),c(st,{exact:!0,path:`/d/${Ye}`,component:RedirectDocument}),c(st,{exact:!0,path:`/doc/${Ye}/history/:revisionId?`,component:ss}),c(st,{exact:!0,path:`/doc/${Ye}/insights`,component:ss}),c(st,{exact:!0,path:`/doc/${Ye}/edit`,component:ss}),c(st,{path:`/doc/${Ye}`,component:ss}),c(st,{exact:!0,path:`${_e()}/:query?`,component:ls}),c(st,{path:"/404",component:en}),c(rs,{}),c(st,{component:en})]})})})})})),hs=Object.freeze(Object.defineProperty({__proto__:null,default:ds},Symbol.toStringTag,{value:"Module"}));export{Br as C,Tn as D,Fr as E,Ir as I,LoadingError as L,UserChangeEmailDialog as U,ZapierIcon as Z,UserChangeNameDialog as a,UserSuspendDialog as b,updateUserRoleActionFactory as c,deleteUserActionFactory as d,Cr as e,Jr as f,Rr as g,usePaginatedRequest as h,or as i,useImportDocument as j,Ar as k,hs as l,Sr as r,useSettingsConfig as u};
