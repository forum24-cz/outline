const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.4lU6ZntV.js","assets/index.mlCxaiYE.js","assets/Switch.3DOmHSIs.js","assets/PopoverDisclosure.OO70kItq.js","assets/InputSelectPermission.lb2lIKIy.js","assets/EmojiPanel.TJcM4M0j.js","assets/DocumentContext.hhTeDqBR.js","assets/PlaceholderText.UNfhMHoO.js","assets/Scene.tZk0YIWv.js","assets/LoadingIndicatorBar.mGaD64ZX.js","assets/TeamLogo.qV1feKYB.js","assets/useBoolean.4JQO1FDN.js","assets/useCurrentUser.zlImhYTS.js","assets/Badge.sHfYRIgC.js","assets/Item.dGEOVRdT.js","assets/Time.rp9cc_zo.js","assets/index.esm.XsAbwjVB.js","assets/useCurrentTeam.fRZpnoZU.js","assets/usePolicy.wYF8wJNp.js","assets/SharedLayoutContext.2BBc39h7.js","assets/Emoji.r_ABO2XC.js","assets/PopoverButton.AWtPNgE3.js"])))=>i.map(i=>d[i]);
import{a as e,r as t,j as o,cx as i,h as n,c8 as c,n as a,A as s,C as r,o as l,cy as d,u as p,ar as h,Z as u,d as m,z as f,cz as g,T as b,B as v,L as C,p as x,a2 as y,F as I,aI as j,am as w,ak as D,a0 as A,a4 as P,b3 as S,cA as k,_ as L,cB as T,i as B,aZ as E,k as N,bH as R,aV as z,bk as U,cC as H,a8 as _,aK as F,cD as M,bf as O,S as q,aW as V,R as $,cq as W,H as Z,N as G}from"./index.mlCxaiYE.js";import{A as K,S as X}from"./Actions.u9jjnQ1W.js";import{C as J,P as Q}from"./Switch.3DOmHSIs.js";import{B as Y}from"./Star.r69PtoVf.js";import{V as ee,u as te,W as oe,a as ie,X as ne,E as ce}from"./DocumentContext.hhTeDqBR.js";import{L as ae}from"./LoadingIndicatorBar.mGaD64ZX.js";import{w as se}from"./index.njNghNAe.js";import{u as re}from"./useCurrentUser.zlImhYTS.js";import{u as le}from"./usePolicy.wYF8wJNp.js";import{I as de}from"./InputSearchPage.UJk7oQhb.js";import{a as pe}from"./Badge.sHfYRIgC.js";import{P as he}from"./PaginatedDocumentList.j-XTHEWP.js";import{P as ue}from"./PinnedDocuments.obxtC7YS.js";import{P as me}from"./PlaceholderText.UNfhMHoO.js";import{S as fe}from"./Scene.tZk0YIWv.js";import{T as ge,a as be}from"./Tabs.dkNXhqZm.js";import{u as ve}from"./useCommandBarActions.tFGIorji.js";import{C as Ce,j as xe,f as ye}from"./authenticated.03alztlO.js";import{a as Ie}from"./TeamLogo.qV1feKYB.js";import{F as je}from"./Facepile.0K3TyxgD.js";import{N as we}from"./Notice.4wB6_cwE.js";import{T as De}from"./Time.rp9cc_zo.js";import{u as Ae}from"./useCurrentTeam.fRZpnoZU.js";import{u as Pe,P as Se}from"./PopoverDisclosure.OO70kItq.js";import"./InputSelectPermission.lb2lIKIy.js";import"./Item.dGEOVRdT.js";import"./index.esm.XsAbwjVB.js";import"./useBoolean.4JQO1FDN.js";import"./SharedLayoutContext.2BBc39h7.js";import"./DocumentListItem.b25IHz8z.js";import"./Highlight.XZk1WX3z.js";import"./useTextStats.yvDOkpRe.js";import"./VisualElementDragControls.jrFnrF4j.js";import"./urls.doI9odX4.js";import"./ButtonLink.tgoiIjKJ.js";import"./routeHelpers.MPg4vHxP.js";const CollectionBreadcrumb=({collection:a})=>{const{t:s}=e(),r=t.useMemo((()=>{const e={type:"route",title:a.name,icon:o(J,{collection:a,expanded:!0}),to:i(a.path)},t=a.isArchived?{type:"route",icon:o(n.ArchiveIcon,{}),title:s("Archive"),to:c()}:void 0,r=[];return t&&r.push(t),r.push(e),r}),[a,s]);return o(Y,{items:r,highlightFirstItem:!0})},ke=se(d);const Le=a(s).withConfig({componentId:"sc-l7fh8g-0"})(["color:",";cursor:text;min-height:27px;"],r("placeholder")),Te=l((function CollectionDescription({collection:i}){const{collections:n}=p(),{t:c}=e(),a=re({rejectOnEmpty:!0}),s=le(i),r=t.useMemo((()=>h((async e=>{try{await i.save({data:e(!1)})}catch(t){throw u.error(c("Sorry, an error occurred saving the collection")),t}}),1e3)),[i,c]),l=t.useRef(null),d=l.current?.offsetHeight||0,b=t.useMemo((()=>({padding:"0 32px",margin:"0 -32px",paddingBottom:`calc(50vh - ${d}px)`})),[d]);return m(f,{children:[n.isSaving&&o(ae,{}),(i.hasDescription||s.update)&&m(t.Suspense,{fallback:o(Le,{children:"Loading…"}),children:[o(ee,{defaultValue:i.data,onChange:r,placeholder:`${c("Add a description")}…`,extensions:ke,maxLength:g.maxDescriptionLength,canUpdate:s.update,readOnly:!s.update,userId:a.id,editorStyle:b,embedsDisabled:!0}),o("div",{ref:l})]})]})}));const Be=l((function Actions({collection:t}){const{t:i}=e(),c=le(t);return m(f,{children:[c.createDocument&&m(f,{children:[o(K,{children:o(b,{content:i("New document"),shortcut:"n",placement:"bottom",children:o(v,{as:C,to:t?x(t.id):"",disabled:!t,icon:o(n.PlusIcon,{}),children:i("New doc")})})}),o(X,{})]}),o(K,{children:o(Ce,{collection:t,placement:"bottom-end",label:e=>o(v,{"aria-label":i("Collection menu"),icon:o(n.MoreIcon,{}),...e,borderOnHover:!0,neutral:!0})})})]})})),Ee=a(s).withConfig({componentId:"sc-o6xe6d-0"})(["opacity:0;pointer-events:none;"]),Ne=a.div.withConfig({componentId:"sc-o6xe6d-1"})(["outline-color:transparent !important;height:calc(100% - 56px);position:relative;",""],(({isDragActive:e,theme:t})=>e&&y(['&:after{display:block;content:"";position:absolute;top:24px;right:24px;left:24px;height:85vh;background:',";border-radius:8px;border:1px dashed ",";box-shadow:0 0 0 100px ",";z-index:1;}","{opacity:1;z-index:2;position:absolute;text-align:center;top:50vh;left:50%;transform:translateX(-50%);}"],t.background,t.divider,t.background,Ee))),Re=l((({children:i,disabled:n,accept:c,collectionId:a})=>{const{handleFiles:s,isImporting:r}=xe(a),{t:l}=e(),d=t.useCallback((()=>{u.error(l("Document not supported – try Markdown, Plain text, HTML, or Word"))}),[l]);return o(ye,{accept:c,onDropAccepted:s,onDropRejected:d,disabled:n,noClick:!0,multiple:!0,children:({getRootProps:e,getInputProps:t,isDragActive:n})=>m(Ne,{...e(),isDragActive:n,tabIndex:-1,children:[o("input",{...t()}),r&&o(ae,{}),i,o(Ee,{children:l("Drop documents to import")})]})})}));const ze=a(I).withConfig({componentId:"sc-1td1zah-0"})(["text-align:center;align-items:center;justify-content:center;margin:0 auto;max-width:380px;height:50vh;"]),Ue=l((function EmptyCollection({collection:e}){const t=e?e.name:"";return o(j,{children:o(ze,{column:!0,children:o(s,{as:"p",type:"secondary",children:o(w,{defaults:"<em>{{ collectionName }}</em> doesn’t contain any\n                    documents yet.",values:{collectionName:t},components:{em:o("strong",{})}})})})})})),He=l((({collection:i,limit:n=8})=>{const[c,a]=t.useState(!1),[s,r]=t.useState(0),[l,d]=t.useState(0),{t:h}=e(),{memberships:u,groupMemberships:m,users:f}=p(),g=f.inCollection(i.id),b=te(),v=D();if(t.useEffect((()=>{(async()=>{if(!i.permission&&!v){a(!0);try{const e={id:i.id,limit:n},[t,o]=await Promise.all([u.fetchPage(e),m.fetchPage(e)]);t[S]&&r(t[S].total??0),o[S]&&d(o[S].total??0)}finally{a(!1)}}})()}),[v,i.permission,i.id,m,u,n]),c||i.permission||v)return null;const C=s+l-g.length;return o(A,{context:b,tooltip:{content:s>0?l>0?l>1?h("{{ usersCount }} users and {{ groupsCount }} groups with access",{usersCount:s,groupsCount:l,count:s}):h("{{ usersCount }} users and a group have access",{usersCount:s,count:s}):h("{{ usersCount }} users with access",{usersCount:s,count:s}):h("{{ groupsCount }} groups with access",{groupsCount:l,count:l}),delay:250},width:"auto",height:"auto",children:o(j,{children:o(je,{size:Ie.Large,users:P(g,"lastActiveAt"),overflow:C,limit:n})})})}));function Notices({collection:t}){const{t:i}=e();return o(k,{children:t.isArchived&&!t.isDeleted&&m(we,{icon:o(n.ArchiveIcon,{}),children:[i("Archived by {{userName}}",{userName:t.archivedBy?.name??i("Unknown")})," ",o(De,{dateTime:t.archivedAt,addSuffix:!0})]})})}const _e=l((function ShareButton({collection:t}){const{t:i}=e(),{shares:c}=p(),a=Ae(),s=c.getByCollectionId(t.id),r=!1!==a.sharing&&!1!==t?.sharing&&s?.published,l=Pe({gutter:0,placement:"bottom-end",unstable_fixed:!0});if(D())return null;const d=r?o(n.GlobeIcon,{}):t.permission?void 0:o(n.PadlockIcon,{});return m(f,{children:[o(Se,{...l,children:e=>o(v,{icon:d,neutral:!0,...e,children:i("Share")})}),o(Q,{...l,"aria-label":i("Share"),width:400,scrollable:!1,children:o(oe,{collection:t,onRequestClose:l.hide,visible:l.visible})})]})})),Fe=t.lazy((()=>L((()=>import("./index.4lU6ZntV.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])))),Me=l((function _CollectionScene(){const n=T(),c=B(),a=E(),s=N(),{t:r}=e(),{documents:l,collections:d,ui:h}=p(),[u,g]=t.useState(!1),[b,v]=t.useState(),C=s.pathname,[,x]=R(),y=ie(),I=n.id||"",j=I.split("-").pop()??"",w=d.getByUrl(I)||d.get(I),D=le(w),{pins:A,count:P}=z(j,w?.id),[S,k]=U(`collection-tab:${w?.id}`,w?.hasDescription?"overview":"recent",{listen:!1}),L=t.useCallback(((e,t)=>w?.save({icon:e,color:t})),[w]);if(t.useEffect((()=>{x(C)}),[C,x]),t.useEffect((()=>{if(w?.name){const e=H(a.url,w);a.url!==e&&c.replace(e,c.location.state)}}),[w,w?.name,c,I,a.url]),t.useEffect((()=>(w&&h.setActiveCollection(w.id),()=>h.setActiveCollection(void 0))),[h,w]),t.useEffect((()=>{!async function fetchData(){if(!(D&&w||b||u))try{v(void 0),g(!0),await d.fetch(I)}catch(e){v(e)}finally{g(!1)}}()}),[d,u,w,b,I,D]),ve([ne],[h.activeCollectionId??"none"]),!w&&b)return o(ce,{});const G=D.update||w?.hasDescription,X=w?o(_,{value:w.icon??"collection",color:w.color||void 0,size:40}):null,tabProps=e=>({exact:!0,onClick:()=>k(e),to:{pathname:i(w.path,e),state:{sidebarContext:y}}});return w?o(fe,{centered:!1,textTitle:w.name,left:w.isArchived?o(CollectionBreadcrumb,{collection:w}):w.isEmpty?void 0:o(de,{source:"collection",placeholder:`${r("Search in collection")}…`,label:r("Search in collection"),collectionId:w.id}),title:m(f,{children:[o(J,{collection:w,expanded:!0})," ",w.name]}),actions:m(f,{children:[o(He,{collection:w}),o(K,{children:D.update&&o(_e,{collection:w})}),o(Be,{collection:w})]}),children:o(Re,{accept:l.importFileTypes.join(", "),disabled:!D.createDocument,collectionId:w.id,children:m(F,{withStickyHeader:!0,children:[o(Notices,{collection:w}),m(qe,{children:[o(M,{children:D.update?o(t.Suspense,{fallback:X,children:o(Fe,{icon:w.icon??"collection",color:w.color??O[0],initial:w.name[0],size:40,popoverPosition:"bottom-start",onChange:L,borderOnHover:!0})}):X}),w.name]}),o(ue,{pins:A,canUpdate:D.update,placeholderCount:P}),m(Oe,{children:[m(ge,{children:[G&&o(be,{...tabProps("overview"),children:r("Overview")}),o(be,{...tabProps("recent"),children:r("Documents")}),!w.isArchived&&m(f,{children:[o(be,{...tabProps("updated"),children:r("Recently updated")}),o(be,{...tabProps("published"),children:r("Recently published")}),o(be,{...tabProps("old"),children:r("Least recently updated")}),o(be,{...tabProps("alphabetical"),children:r("A–Z")})]})]}),m(q,{children:[o(V,{path:i(w.path),exact:!0,children:o($,{to:{pathname:i(w.path,S),state:{sidebarContext:y}}})}),o(V,{path:i(w.path,"overview"),children:G?o(Te,{collection:w}):o($,{to:{pathname:i(w.path,"recent"),state:{sidebarContext:y}}})}),w.isEmpty?o(Ue,{collection:w}):w.isArchived?o(V,{path:i(w.path,"recent"),exact:!0,children:o(he,{documents:l.archivedInCollection(w.id),fetch:l.fetchPage,options:{collectionId:w.id,parentDocumentId:null,sort:w.sort.field,direction:w.sort.direction,statusFilter:[W.Archived]},showParentDocuments:!0})}):m(f,{children:[o(V,{path:i(w.path,"alphabetical"),children:o(he,{documents:l.alphabeticalInCollection(w.id),fetch:l.fetchAlphabetical,options:{collectionId:w.id}},"alphabetical")}),o(V,{path:i(w.path,"old"),children:o(he,{documents:l.leastRecentlyUpdatedInCollection(w.id),fetch:l.fetchLeastRecentlyUpdated,options:{collectionId:w.id}},"old")}),o(V,{path:i(w.path,"published"),children:o(he,{documents:l.recentlyPublishedInCollection(w.id),fetch:l.fetchRecentlyPublished,options:{collectionId:w.id},showPublished:!0},"published")}),o(V,{path:i(w.path,"updated"),children:o(he,{documents:l.recentlyUpdatedInCollection(w.id),fetch:l.fetchRecentlyUpdated,options:{collectionId:w.id}},"updated")}),o(V,{path:i(w.path,"recent"),exact:!0,children:o(he,{documents:l.rootInCollection(w.id),fetch:l.fetchPage,options:{collectionId:w.id,parentDocumentId:null,sort:w.sort.field,direction:w.sort.direction},showParentDocuments:!0})})]})]})]})]})})}):m(F,{children:[o(Z,{children:o(me,{height:35})}),o(pe,{count:5})]})})),KeyedCollection=()=>{const e=T();return o(Me,{},e.id)},Oe=a.div.withConfig({componentId:"sc-1o9y8mq-0"})(["position:relative;background:",";"],r("background")),qe=a(Z).withConfig({componentId:"sc-1o9y8mq-1"})(["display:flex;align-items:center;position:relative;margin-left:40px;",""],G("tablet")`
    margin-left: 0;
  `);export{KeyedCollection as default};
