{"version":3,"file":"VisualElementDragControls.jrFnrF4j.js","sources":["../../../node_modules/hey-listen/dist/hey-listen.es.js","../../../node_modules/style-value-types/dist/es/color/utils.js","../../../node_modules/style-value-types/dist/es/color/hsla.js","../../../node_modules/style-value-types/dist/es/color/rgba.js","../../../node_modules/style-value-types/dist/es/color/hex.js","../../../node_modules/style-value-types/dist/es/color/index.js","../../../node_modules/style-value-types/dist/es/complex/index.js","../../../node_modules/style-value-types/dist/es/complex/filter.js","../../../node_modules/framer-motion/dist/es/render/utils/types.js","../../../node_modules/framer-motion/dist/es/events/use-dom-event.js","../../../node_modules/framer-motion/dist/es/gestures/utils/event-type.js","../../../node_modules/framer-motion/dist/es/events/event-info.js","../../../node_modules/framer-motion/dist/es/events/use-pointer-event.js","../../../node_modules/framer-motion/dist/es/events/utils.js","../../../node_modules/framer-motion/dist/es/gestures/drag/utils/lock.js","../../../node_modules/popmotion/dist/es/utils/clamp.js","../../../node_modules/popmotion/dist/es/animations/utils/find-spring.js","../../../node_modules/popmotion/dist/es/animations/generators/spring.js","../../../node_modules/popmotion/dist/es/utils/progress.js","../../../node_modules/popmotion/dist/es/utils/mix.js","../../../node_modules/popmotion/dist/es/utils/mix-color.js","../../../node_modules/popmotion/dist/es/utils/inc.js","../../../node_modules/popmotion/dist/es/utils/pipe.js","../../../node_modules/popmotion/dist/es/utils/mix-complex.js","../../../node_modules/popmotion/dist/es/utils/interpolate.js","../../../node_modules/popmotion/dist/es/easing/utils.js","../../../node_modules/popmotion/dist/es/easing/index.js","../../../node_modules/popmotion/dist/es/animations/generators/keyframes.js","../../../node_modules/popmotion/dist/es/animations/utils/detect-animation-from-options.js","../../../node_modules/popmotion/dist/es/animations/generators/decay.js","../../../node_modules/popmotion/dist/es/animations/utils/elapsed.js","../../../node_modules/popmotion/dist/es/animations/index.js","../../../node_modules/popmotion/dist/es/utils/velocity-per-second.js","../../../node_modules/popmotion/dist/es/utils/is-point.js","../../../node_modules/popmotion/dist/es/utils/is-point-3d.js","../../../node_modules/popmotion/dist/es/utils/distance.js","../../../node_modules/popmotion/dist/es/easing/cubic-bezier.js","../../../node_modules/framer-motion/dist/es/utils/time-conversion.js","../../../node_modules/framer-motion/dist/es/animation/utils/easing.js","../../../node_modules/framer-motion/dist/es/animation/utils/is-animatable.js","../../../node_modules/framer-motion/dist/es/animation/utils/default-transitions.js","../../../node_modules/framer-motion/dist/es/render/dom/value-types/defaults.js","../../../node_modules/framer-motion/dist/es/render/dom/value-types/animatable-none.js","../../../node_modules/framer-motion/dist/es/animation/utils/transitions.js","../../../node_modules/popmotion/dist/es/animations/inertia.js","../../../node_modules/framer-motion/dist/es/utils/array.js","../../../node_modules/framer-motion/dist/es/utils/subscription-manager.js","../../../node_modules/framer-motion/dist/es/value/index.js","../../../node_modules/framer-motion/dist/es/gestures/PanSession.js","../../../node_modules/framer-motion/dist/es/utils/each-axis.js","../../../node_modules/framer-motion/dist/es/gestures/drag/utils/constraints.js","../../../node_modules/framer-motion/dist/es/render/dom/projection/measure.js","../../../node_modules/framer-motion/dist/es/utils/geometry/delta-calc.js","../../../node_modules/framer-motion/dist/es/motion/features/layout/utils.js","../../../node_modules/framer-motion/dist/es/render/utils/is-draggable.js","../../../node_modules/framer-motion/dist/es/utils/geometry/delta-apply.js","../../../node_modules/framer-motion/dist/es/gestures/drag/VisualElementDragControls.js","../../../node_modules/framer-motion/dist/es/render/dom/projection/convert-to-relative.js"],"sourcesContent":["var warning = function () { };\r\nvar invariant = function () { };\r\nif (process.env.NODE_ENV !== 'production') {\r\n    warning = function (check, message) {\r\n        if (!check && typeof console !== 'undefined') {\r\n            console.warn(message);\r\n        }\r\n    };\r\n    invariant = function (check, message) {\r\n        if (!check) {\r\n            throw new Error(message);\r\n        }\r\n    };\r\n}\n\nexport { invariant, warning };\n","import { isString, singleColorRegex, floatRegex } from '../utils.js';\n\nvar isColorString = function (type, testProp) { return function (v) {\n    return Boolean((isString(v) && singleColorRegex.test(v) && v.startsWith(type)) ||\n        (testProp && Object.prototype.hasOwnProperty.call(v, testProp)));\n}; };\nvar splitColor = function (aName, bName, cName) { return function (v) {\n    var _a;\n    if (!isString(v))\n        return v;\n    var _b = v.match(floatRegex), a = _b[0], b = _b[1], c = _b[2], alpha = _b[3];\n    return _a = {},\n        _a[aName] = parseFloat(a),\n        _a[bName] = parseFloat(b),\n        _a[cName] = parseFloat(c),\n        _a.alpha = alpha !== undefined ? parseFloat(alpha) : 1,\n        _a;\n}; };\n\nexport { isColorString, splitColor };\n","import { alpha } from '../numbers/index.js';\nimport { percent } from '../numbers/units.js';\nimport { sanitize } from '../utils.js';\nimport { isColorString, splitColor } from './utils.js';\n\nvar hsla = {\n    test: isColorString('hsl', 'hue'),\n    parse: splitColor('hue', 'saturation', 'lightness'),\n    transform: function (_a) {\n        var hue = _a.hue, saturation = _a.saturation, lightness = _a.lightness, _b = _a.alpha, alpha$1 = _b === void 0 ? 1 : _b;\n        return ('hsla(' +\n            Math.round(hue) +\n            ', ' +\n            percent.transform(sanitize(saturation)) +\n            ', ' +\n            percent.transform(sanitize(lightness)) +\n            ', ' +\n            sanitize(alpha.transform(alpha$1)) +\n            ')');\n    },\n};\n\nexport { hsla };\n","import { __assign } from 'tslib';\nimport { number, alpha } from '../numbers/index.js';\nimport { sanitize, clamp } from '../utils.js';\nimport { isColorString, splitColor } from './utils.js';\n\nvar clampRgbUnit = clamp(0, 255);\nvar rgbUnit = __assign(__assign({}, number), { transform: function (v) { return Math.round(clampRgbUnit(v)); } });\nvar rgba = {\n    test: isColorString('rgb', 'red'),\n    parse: splitColor('red', 'green', 'blue'),\n    transform: function (_a) {\n        var red = _a.red, green = _a.green, blue = _a.blue, _b = _a.alpha, alpha$1 = _b === void 0 ? 1 : _b;\n        return 'rgba(' +\n            rgbUnit.transform(red) +\n            ', ' +\n            rgbUnit.transform(green) +\n            ', ' +\n            rgbUnit.transform(blue) +\n            ', ' +\n            sanitize(alpha.transform(alpha$1)) +\n            ')';\n    },\n};\n\nexport { rgbUnit, rgba };\n","import { rgba } from './rgba.js';\nimport { isColorString } from './utils.js';\n\nfunction parseHex(v) {\n    var r = '';\n    var g = '';\n    var b = '';\n    var a = '';\n    if (v.length > 5) {\n        r = v.substr(1, 2);\n        g = v.substr(3, 2);\n        b = v.substr(5, 2);\n        a = v.substr(7, 2);\n    }\n    else {\n        r = v.substr(1, 1);\n        g = v.substr(2, 1);\n        b = v.substr(3, 1);\n        a = v.substr(4, 1);\n        r += r;\n        g += g;\n        b += b;\n        a += a;\n    }\n    return {\n        red: parseInt(r, 16),\n        green: parseInt(g, 16),\n        blue: parseInt(b, 16),\n        alpha: a ? parseInt(a, 16) / 255 : 1,\n    };\n}\nvar hex = {\n    test: isColorString('#'),\n    parse: parseHex,\n    transform: rgba.transform,\n};\n\nexport { hex };\n","import { isString } from '../utils.js';\nimport { hex } from './hex.js';\nimport { hsla } from './hsla.js';\nimport { rgba } from './rgba.js';\n\nvar color = {\n    test: function (v) { return rgba.test(v) || hex.test(v) || hsla.test(v); },\n    parse: function (v) {\n        if (rgba.test(v)) {\n            return rgba.parse(v);\n        }\n        else if (hsla.test(v)) {\n            return hsla.parse(v);\n        }\n        else {\n            return hex.parse(v);\n        }\n    },\n    transform: function (v) {\n        return isString(v)\n            ? v\n            : v.hasOwnProperty('red')\n                ? rgba.transform(v)\n                : hsla.transform(v);\n    },\n};\n\nexport { color };\n","import { color } from '../color/index.js';\nimport { number } from '../numbers/index.js';\nimport { isString, floatRegex, colorRegex, sanitize } from '../utils.js';\n\nvar colorToken = '${c}';\nvar numberToken = '${n}';\nfunction test(v) {\n    var _a, _b, _c, _d;\n    return (isNaN(v) &&\n        isString(v) &&\n        ((_b = (_a = v.match(floatRegex)) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0) + ((_d = (_c = v.match(colorRegex)) === null || _c === void 0 ? void 0 : _c.length) !== null && _d !== void 0 ? _d : 0) > 0);\n}\nfunction analyse(v) {\n    var values = [];\n    var numColors = 0;\n    var colors = v.match(colorRegex);\n    if (colors) {\n        numColors = colors.length;\n        v = v.replace(colorRegex, colorToken);\n        values.push.apply(values, colors.map(color.parse));\n    }\n    var numbers = v.match(floatRegex);\n    if (numbers) {\n        v = v.replace(floatRegex, numberToken);\n        values.push.apply(values, numbers.map(number.parse));\n    }\n    return { values: values, numColors: numColors, tokenised: v };\n}\nfunction parse(v) {\n    return analyse(v).values;\n}\nfunction createTransformer(v) {\n    var _a = analyse(v), values = _a.values, numColors = _a.numColors, tokenised = _a.tokenised;\n    var numValues = values.length;\n    return function (v) {\n        var output = tokenised;\n        for (var i = 0; i < numValues; i++) {\n            output = output.replace(i < numColors ? colorToken : numberToken, i < numColors ? color.transform(v[i]) : sanitize(v[i]));\n        }\n        return output;\n    };\n}\nvar convertNumbersToZero = function (v) {\n    return typeof v === 'number' ? 0 : v;\n};\nfunction getAnimatableNone(v) {\n    var parsed = parse(v);\n    var transformer = createTransformer(v);\n    return transformer(parsed.map(convertNumbersToZero));\n}\nvar complex = { test: test, parse: parse, createTransformer: createTransformer, getAnimatableNone: getAnimatableNone };\n\nexport { complex };\n","import { __assign } from 'tslib';\nimport { complex } from './index.js';\nimport { floatRegex } from '../utils.js';\n\nvar maxDefaults = new Set(['brightness', 'contrast', 'saturate', 'opacity']);\nfunction applyDefaultFilter(v) {\n    var _a = v.slice(0, -1).split('('), name = _a[0], value = _a[1];\n    if (name === 'drop-shadow')\n        return v;\n    var number = (value.match(floatRegex) || [])[0];\n    if (!number)\n        return v;\n    var unit = value.replace(number, '');\n    var defaultValue = maxDefaults.has(name) ? 1 : 0;\n    if (number !== value)\n        defaultValue *= 100;\n    return name + '(' + defaultValue + unit + ')';\n}\nvar functionRegex = /([a-z-]*)\\(.*?\\)/g;\nvar filter = __assign(__assign({}, complex), { getAnimatableNone: function (v) {\n        var functions = v.match(functionRegex);\n        return functions ? functions.map(applyDefaultFilter).join(' ') : v;\n    } });\n\nexport { filter };\n","var AnimationType;\n(function (AnimationType) {\n    AnimationType[\"Animate\"] = \"animate\";\n    AnimationType[\"Hover\"] = \"whileHover\";\n    AnimationType[\"Tap\"] = \"whileTap\";\n    AnimationType[\"Drag\"] = \"whileDrag\";\n    AnimationType[\"Focus\"] = \"whileFocus\";\n    AnimationType[\"Exit\"] = \"exit\";\n})(AnimationType || (AnimationType = {}));\n\nexport { AnimationType };\n","import { useEffect } from 'react';\n\nfunction addDomEvent(target, eventName, handler, options) {\n    target.addEventListener(eventName, handler, options);\n    return function () { return target.removeEventListener(eventName, handler, options); };\n}\n/**\n * Attaches an event listener directly to the provided DOM element.\n *\n * Bypassing React's event system can be desirable, for instance when attaching non-passive\n * event handlers.\n *\n * ```jsx\n * const ref = useRef(null)\n *\n * useDomEvent(ref, 'wheel', onWheel, { passive: false })\n *\n * return <div ref={ref} />\n * ```\n *\n * @param ref - React.RefObject that's been provided to the element you want to bind the listener to.\n * @param eventName - Name of the event you want listen for.\n * @param handler - Function to fire when receiving the event.\n * @param options - Options to pass to `Event.addEventListener`.\n *\n * @public\n */\nfunction useDomEvent(ref, eventName, handler, options) {\n    useEffect(function () {\n        var element = ref.current;\n        if (handler && element) {\n            return addDomEvent(element, eventName, handler, options);\n        }\n    }, [ref, eventName, handler, options]);\n}\n\nexport { addDomEvent, useDomEvent };\n","function isMouseEvent(event) {\n    // PointerEvent inherits from MouseEvent so we can't use a straight instanceof check.\n    if (typeof PointerEvent !== \"undefined\" && event instanceof PointerEvent) {\n        return !!(event.pointerType === \"mouse\");\n    }\n    return event instanceof MouseEvent;\n}\nfunction isTouchEvent(event) {\n    var hasTouches = !!event.touches;\n    return hasTouches;\n}\n\nexport { isMouseEvent, isTouchEvent };\n","import { isTouchEvent } from '../gestures/utils/event-type.js';\n\n/**\n * Filters out events not attached to the primary pointer (currently left mouse button)\n * @param eventHandler\n */\nfunction filterPrimaryPointer(eventHandler) {\n    return function (event) {\n        var isMouseEvent = event instanceof MouseEvent;\n        var isPrimaryPointer = !isMouseEvent ||\n            (isMouseEvent && event.button === 0);\n        if (isPrimaryPointer) {\n            eventHandler(event);\n        }\n    };\n}\nvar defaultPagePoint = { pageX: 0, pageY: 0 };\nfunction pointFromTouch(e, pointType) {\n    if (pointType === void 0) { pointType = \"page\"; }\n    var primaryTouch = e.touches[0] || e.changedTouches[0];\n    var point = primaryTouch || defaultPagePoint;\n    return {\n        x: point[pointType + \"X\"],\n        y: point[pointType + \"Y\"],\n    };\n}\nfunction pointFromMouse(point, pointType) {\n    if (pointType === void 0) { pointType = \"page\"; }\n    return {\n        x: point[pointType + \"X\"],\n        y: point[pointType + \"Y\"],\n    };\n}\nfunction extractEventInfo(event, pointType) {\n    if (pointType === void 0) { pointType = \"page\"; }\n    return {\n        point: isTouchEvent(event)\n            ? pointFromTouch(event, pointType)\n            : pointFromMouse(event, pointType),\n    };\n}\nfunction getViewportPointFromEvent(event) {\n    return extractEventInfo(event, \"client\");\n}\nvar wrapHandler = function (handler, shouldFilterPrimaryPointer) {\n    if (shouldFilterPrimaryPointer === void 0) { shouldFilterPrimaryPointer = false; }\n    var listener = function (event) {\n        return handler(event, extractEventInfo(event));\n    };\n    return shouldFilterPrimaryPointer\n        ? filterPrimaryPointer(listener)\n        : listener;\n};\n\nexport { extractEventInfo, getViewportPointFromEvent, wrapHandler };\n","import { useDomEvent, addDomEvent } from './use-dom-event.js';\nimport { wrapHandler } from './event-info.js';\nimport { supportsPointerEvents, supportsTouchEvents, supportsMouseEvents } from './utils.js';\n\nvar mouseEventNames = {\n    pointerdown: \"mousedown\",\n    pointermove: \"mousemove\",\n    pointerup: \"mouseup\",\n    pointercancel: \"mousecancel\",\n    pointerover: \"mouseover\",\n    pointerout: \"mouseout\",\n    pointerenter: \"mouseenter\",\n    pointerleave: \"mouseleave\",\n};\nvar touchEventNames = {\n    pointerdown: \"touchstart\",\n    pointermove: \"touchmove\",\n    pointerup: \"touchend\",\n    pointercancel: \"touchcancel\",\n};\nfunction getPointerEventName(name) {\n    if (supportsPointerEvents()) {\n        return name;\n    }\n    else if (supportsTouchEvents()) {\n        return touchEventNames[name];\n    }\n    else if (supportsMouseEvents()) {\n        return mouseEventNames[name];\n    }\n    return name;\n}\nfunction addPointerEvent(target, eventName, handler, options) {\n    return addDomEvent(target, getPointerEventName(eventName), wrapHandler(handler, eventName === \"pointerdown\"), options);\n}\nfunction usePointerEvent(ref, eventName, handler, options) {\n    return useDomEvent(ref, getPointerEventName(eventName), handler && wrapHandler(handler, eventName === \"pointerdown\"), options);\n}\n\nexport { addPointerEvent, usePointerEvent };\n","import { isBrowser } from '../utils/is-browser.js';\n\n// We check for event support via functions in case they've been mocked by a testing suite.\nvar supportsPointerEvents = function () {\n    return isBrowser && window.onpointerdown === null;\n};\nvar supportsTouchEvents = function () {\n    return isBrowser && window.ontouchstart === null;\n};\nvar supportsMouseEvents = function () {\n    return isBrowser && window.onmousedown === null;\n};\n\nexport { supportsMouseEvents, supportsPointerEvents, supportsTouchEvents };\n","function createLock(name) {\n    var lock = null;\n    return function () {\n        var openLock = function () {\n            lock = null;\n        };\n        if (lock === null) {\n            lock = name;\n            return openLock;\n        }\n        return false;\n    };\n}\nvar globalHorizontalLock = createLock(\"dragHorizontal\");\nvar globalVerticalLock = createLock(\"dragVertical\");\nfunction getGlobalLock(drag) {\n    var lock = false;\n    if (drag === \"y\") {\n        lock = globalVerticalLock();\n    }\n    else if (drag === \"x\") {\n        lock = globalHorizontalLock();\n    }\n    else {\n        var openHorizontal_1 = globalHorizontalLock();\n        var openVertical_1 = globalVerticalLock();\n        if (openHorizontal_1 && openVertical_1) {\n            lock = function () {\n                openHorizontal_1();\n                openVertical_1();\n            };\n        }\n        else {\n            // Release the locks because we don't use them\n            if (openHorizontal_1)\n                openHorizontal_1();\n            if (openVertical_1)\n                openVertical_1();\n        }\n    }\n    return lock;\n}\nfunction isDragActive() {\n    // Check the gesture lock - if we get it, it means no drag gesture is active\n    // and we can safely fire the tap gesture.\n    var openGestureLock = getGlobalLock(true);\n    if (!openGestureLock)\n        return true;\n    openGestureLock();\n    return false;\n}\n\nexport { createLock, getGlobalLock, isDragActive };\n","var clamp = function (min, max, v) {\n    return Math.min(Math.max(v, min), max);\n};\n\nexport { clamp };\n","import { warning } from 'hey-listen';\nimport { clamp } from '../../utils/clamp.js';\n\nvar safeMin = 0.001;\nvar minDuration = 0.01;\nvar maxDuration = 10.0;\nvar minDamping = 0.05;\nvar maxDamping = 1;\nfunction findSpring(_a) {\n    var _b = _a.duration, duration = _b === void 0 ? 800 : _b, _c = _a.bounce, bounce = _c === void 0 ? 0.25 : _c, _d = _a.velocity, velocity = _d === void 0 ? 0 : _d, _e = _a.mass, mass = _e === void 0 ? 1 : _e;\n    var envelope;\n    var derivative;\n    warning(duration <= maxDuration * 1000, \"Spring duration must be 10 seconds or less\");\n    var dampingRatio = 1 - bounce;\n    dampingRatio = clamp(minDamping, maxDamping, dampingRatio);\n    duration = clamp(minDuration, maxDuration, duration / 1000);\n    if (dampingRatio < 1) {\n        envelope = function (undampedFreq) {\n            var exponentialDecay = undampedFreq * dampingRatio;\n            var delta = exponentialDecay * duration;\n            var a = exponentialDecay - velocity;\n            var b = calcAngularFreq(undampedFreq, dampingRatio);\n            var c = Math.exp(-delta);\n            return safeMin - (a / b) * c;\n        };\n        derivative = function (undampedFreq) {\n            var exponentialDecay = undampedFreq * dampingRatio;\n            var delta = exponentialDecay * duration;\n            var d = delta * velocity + velocity;\n            var e = Math.pow(dampingRatio, 2) * Math.pow(undampedFreq, 2) * duration;\n            var f = Math.exp(-delta);\n            var g = calcAngularFreq(Math.pow(undampedFreq, 2), dampingRatio);\n            var factor = -envelope(undampedFreq) + safeMin > 0 ? -1 : 1;\n            return (factor * ((d - e) * f)) / g;\n        };\n    }\n    else {\n        envelope = function (undampedFreq) {\n            var a = Math.exp(-undampedFreq * duration);\n            var b = (undampedFreq - velocity) * duration + 1;\n            return -safeMin + a * b;\n        };\n        derivative = function (undampedFreq) {\n            var a = Math.exp(-undampedFreq * duration);\n            var b = (velocity - undampedFreq) * (duration * duration);\n            return a * b;\n        };\n    }\n    var initialGuess = 5 / duration;\n    var undampedFreq = approximateRoot(envelope, derivative, initialGuess);\n    duration = duration * 1000;\n    if (isNaN(undampedFreq)) {\n        return {\n            stiffness: 100,\n            damping: 10,\n            duration: duration,\n        };\n    }\n    else {\n        var stiffness = Math.pow(undampedFreq, 2) * mass;\n        return {\n            stiffness: stiffness,\n            damping: dampingRatio * 2 * Math.sqrt(mass * stiffness),\n            duration: duration,\n        };\n    }\n}\nvar rootIterations = 12;\nfunction approximateRoot(envelope, derivative, initialGuess) {\n    var result = initialGuess;\n    for (var i = 1; i < rootIterations; i++) {\n        result = result - envelope(result) / derivative(result);\n    }\n    return result;\n}\nfunction calcAngularFreq(undampedFreq, dampingRatio) {\n    return undampedFreq * Math.sqrt(1 - dampingRatio * dampingRatio);\n}\n\nexport { calcAngularFreq, findSpring, maxDamping, maxDuration, minDamping, minDuration };\n","import { __rest, __assign } from 'tslib';\nimport { findSpring, calcAngularFreq } from '../utils/find-spring.js';\n\nvar durationKeys = [\"duration\", \"bounce\"];\nvar physicsKeys = [\"stiffness\", \"damping\", \"mass\"];\nfunction isSpringType(options, keys) {\n    return keys.some(function (key) { return options[key] !== undefined; });\n}\nfunction getSpringOptions(options) {\n    var springOptions = __assign({ velocity: 0.0, stiffness: 100, damping: 10, mass: 1.0, isResolvedFromDuration: false }, options);\n    if (!isSpringType(options, physicsKeys) &&\n        isSpringType(options, durationKeys)) {\n        var derived = findSpring(options);\n        springOptions = __assign(__assign(__assign({}, springOptions), derived), { velocity: 0.0, mass: 1.0 });\n        springOptions.isResolvedFromDuration = true;\n    }\n    return springOptions;\n}\nfunction spring(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0.0 : _b, _c = _a.to, to = _c === void 0 ? 1.0 : _c, _d = _a.restSpeed, restSpeed = _d === void 0 ? 2 : _d, restDelta = _a.restDelta, options = __rest(_a, [\"from\", \"to\", \"restSpeed\", \"restDelta\"]);\n    var state = { done: false, value: from };\n    var _e = getSpringOptions(options), stiffness = _e.stiffness, damping = _e.damping, mass = _e.mass, velocity = _e.velocity, duration = _e.duration, isResolvedFromDuration = _e.isResolvedFromDuration;\n    var resolveSpring = zero;\n    var resolveVelocity = zero;\n    function createSpring() {\n        var initialVelocity = velocity ? -(velocity / 1000) : 0.0;\n        var initialDelta = to - from;\n        var dampingRatio = damping / (2 * Math.sqrt(stiffness * mass));\n        var undampedAngularFreq = Math.sqrt(stiffness / mass) / 1000;\n        restDelta !== null && restDelta !== void 0 ? restDelta : (restDelta = Math.abs(to - from) <= 1 ? 0.01 : 0.4);\n        if (dampingRatio < 1) {\n            var angularFreq_1 = calcAngularFreq(undampedAngularFreq, dampingRatio);\n            resolveSpring = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                return (to -\n                    envelope *\n                        (((initialVelocity +\n                            dampingRatio * undampedAngularFreq * initialDelta) /\n                            angularFreq_1) *\n                            Math.sin(angularFreq_1 * t) +\n                            initialDelta * Math.cos(angularFreq_1 * t)));\n            };\n            resolveVelocity = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                return (dampingRatio *\n                    undampedAngularFreq *\n                    envelope *\n                    ((Math.sin(angularFreq_1 * t) *\n                        (initialVelocity +\n                            dampingRatio *\n                                undampedAngularFreq *\n                                initialDelta)) /\n                        angularFreq_1 +\n                        initialDelta * Math.cos(angularFreq_1 * t)) -\n                    envelope *\n                        (Math.cos(angularFreq_1 * t) *\n                            (initialVelocity +\n                                dampingRatio *\n                                    undampedAngularFreq *\n                                    initialDelta) -\n                            angularFreq_1 *\n                                initialDelta *\n                                Math.sin(angularFreq_1 * t)));\n            };\n        }\n        else if (dampingRatio === 1) {\n            resolveSpring = function (t) {\n                return to -\n                    Math.exp(-undampedAngularFreq * t) *\n                        (initialDelta +\n                            (initialVelocity + undampedAngularFreq * initialDelta) *\n                                t);\n            };\n        }\n        else {\n            var dampedAngularFreq_1 = undampedAngularFreq * Math.sqrt(dampingRatio * dampingRatio - 1);\n            resolveSpring = function (t) {\n                var envelope = Math.exp(-dampingRatio * undampedAngularFreq * t);\n                var freqForT = Math.min(dampedAngularFreq_1 * t, 300);\n                return (to -\n                    (envelope *\n                        ((initialVelocity +\n                            dampingRatio * undampedAngularFreq * initialDelta) *\n                            Math.sinh(freqForT) +\n                            dampedAngularFreq_1 *\n                                initialDelta *\n                                Math.cosh(freqForT))) /\n                        dampedAngularFreq_1);\n            };\n        }\n    }\n    createSpring();\n    return {\n        next: function (t) {\n            var current = resolveSpring(t);\n            if (!isResolvedFromDuration) {\n                var currentVelocity = resolveVelocity(t) * 1000;\n                var isBelowVelocityThreshold = Math.abs(currentVelocity) <= restSpeed;\n                var isBelowDisplacementThreshold = Math.abs(to - current) <= restDelta;\n                state.done =\n                    isBelowVelocityThreshold && isBelowDisplacementThreshold;\n            }\n            else {\n                state.done = t >= duration;\n            }\n            state.value = state.done ? to : current;\n            return state;\n        },\n        flipTarget: function () {\n            var _a;\n            velocity = -velocity;\n            _a = [to, from], from = _a[0], to = _a[1];\n            createSpring();\n        },\n    };\n}\nspring.needsInterpolation = function (a, b) {\n    return typeof a === \"string\" || typeof b === \"string\";\n};\nvar zero = function (_t) { return 0; };\n\nexport { spring };\n","var progress = function (from, to, value) {\n    var toFromDifference = to - from;\n    return toFromDifference === 0 ? 1 : (value - from) / toFromDifference;\n};\n\nexport { progress };\n","var mix = function (from, to, progress) {\n    return -progress * from + progress * to + from;\n};\n\nexport { mix };\n","import { __assign } from 'tslib';\nimport { mix } from './mix.js';\nimport { hex, rgba, hsla } from 'style-value-types';\nimport { invariant } from 'hey-listen';\n\nvar mixLinearColor = function (from, to, v) {\n    var fromExpo = from * from;\n    var toExpo = to * to;\n    return Math.sqrt(Math.max(0, v * (toExpo - fromExpo) + fromExpo));\n};\nvar colorTypes = [hex, rgba, hsla];\nvar getColorType = function (v) {\n    return colorTypes.find(function (type) { return type.test(v); });\n};\nvar notAnimatable = function (color) {\n    return \"'\" + color + \"' is not an animatable color. Use the equivalent color code instead.\";\n};\nvar mixColor = function (from, to) {\n    var fromColorType = getColorType(from);\n    var toColorType = getColorType(to);\n    invariant(!!fromColorType, notAnimatable(from));\n    invariant(!!toColorType, notAnimatable(to));\n    invariant(fromColorType.transform === toColorType.transform, \"Both colors must be hex/RGBA, OR both must be HSLA.\");\n    var fromColor = fromColorType.parse(from);\n    var toColor = toColorType.parse(to);\n    var blended = __assign({}, fromColor);\n    var mixFunc = fromColorType === hsla ? mix : mixLinearColor;\n    return function (v) {\n        for (var key in blended) {\n            if (key !== \"alpha\") {\n                blended[key] = mixFunc(fromColor[key], toColor[key], v);\n            }\n        }\n        blended.alpha = mix(fromColor.alpha, toColor.alpha, v);\n        return fromColorType.transform(blended);\n    };\n};\n\nexport { mixColor, mixLinearColor };\n","var zeroPoint = {\n    x: 0,\n    y: 0,\n    z: 0\n};\nvar isNum = function (v) { return typeof v === 'number'; };\n\nexport { isNum, zeroPoint };\n","var combineFunctions = function (a, b) { return function (v) { return b(a(v)); }; };\nvar pipe = function () {\n    var transformers = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        transformers[_i] = arguments[_i];\n    }\n    return transformers.reduce(combineFunctions);\n};\n\nexport { pipe };\n","import { __spreadArray, __assign } from 'tslib';\nimport { complex, color } from 'style-value-types';\nimport { mix } from './mix.js';\nimport { mixColor } from './mix-color.js';\nimport { isNum } from './inc.js';\nimport { pipe } from './pipe.js';\nimport { invariant } from 'hey-listen';\n\nfunction getMixer(origin, target) {\n    if (isNum(origin)) {\n        return function (v) { return mix(origin, target, v); };\n    }\n    else if (color.test(origin)) {\n        return mixColor(origin, target);\n    }\n    else {\n        return mixComplex(origin, target);\n    }\n}\nvar mixArray = function (from, to) {\n    var output = __spreadArray([], from);\n    var numValues = output.length;\n    var blendValue = from.map(function (fromThis, i) { return getMixer(fromThis, to[i]); });\n    return function (v) {\n        for (var i = 0; i < numValues; i++) {\n            output[i] = blendValue[i](v);\n        }\n        return output;\n    };\n};\nvar mixObject = function (origin, target) {\n    var output = __assign(__assign({}, origin), target);\n    var blendValue = {};\n    for (var key in output) {\n        if (origin[key] !== undefined && target[key] !== undefined) {\n            blendValue[key] = getMixer(origin[key], target[key]);\n        }\n    }\n    return function (v) {\n        for (var key in blendValue) {\n            output[key] = blendValue[key](v);\n        }\n        return output;\n    };\n};\nfunction analyse(value) {\n    var parsed = complex.parse(value);\n    var numValues = parsed.length;\n    var numNumbers = 0;\n    var numRGB = 0;\n    var numHSL = 0;\n    for (var i = 0; i < numValues; i++) {\n        if (numNumbers || typeof parsed[i] === \"number\") {\n            numNumbers++;\n        }\n        else {\n            if (parsed[i].hue !== undefined) {\n                numHSL++;\n            }\n            else {\n                numRGB++;\n            }\n        }\n    }\n    return { parsed: parsed, numNumbers: numNumbers, numRGB: numRGB, numHSL: numHSL };\n}\nvar mixComplex = function (origin, target) {\n    var template = complex.createTransformer(target);\n    var originStats = analyse(origin);\n    var targetStats = analyse(target);\n    invariant(originStats.numHSL === targetStats.numHSL &&\n        originStats.numRGB === targetStats.numRGB &&\n        originStats.numNumbers >= targetStats.numNumbers, \"Complex values '\" + origin + \"' and '\" + target + \"' too different to mix. Ensure all colors are of the same type.\");\n    return pipe(mixArray(originStats.parsed, targetStats.parsed), template);\n};\n\nexport { mixArray, mixComplex, mixObject };\n","import { progress } from './progress.js';\nimport { mix } from './mix.js';\nimport { mixColor } from './mix-color.js';\nimport { mixComplex, mixArray, mixObject } from './mix-complex.js';\nimport { color } from 'style-value-types';\nimport { clamp } from './clamp.js';\nimport { pipe } from './pipe.js';\nimport { invariant } from 'hey-listen';\n\nvar mixNumber = function (from, to) { return function (p) { return mix(from, to, p); }; };\nfunction detectMixerFactory(v) {\n    if (typeof v === 'number') {\n        return mixNumber;\n    }\n    else if (typeof v === 'string') {\n        if (color.test(v)) {\n            return mixColor;\n        }\n        else {\n            return mixComplex;\n        }\n    }\n    else if (Array.isArray(v)) {\n        return mixArray;\n    }\n    else if (typeof v === 'object') {\n        return mixObject;\n    }\n}\nfunction createMixers(output, ease, customMixer) {\n    var mixers = [];\n    var mixerFactory = customMixer || detectMixerFactory(output[0]);\n    var numMixers = output.length - 1;\n    for (var i = 0; i < numMixers; i++) {\n        var mixer = mixerFactory(output[i], output[i + 1]);\n        if (ease) {\n            var easingFunction = Array.isArray(ease) ? ease[i] : ease;\n            mixer = pipe(easingFunction, mixer);\n        }\n        mixers.push(mixer);\n    }\n    return mixers;\n}\nfunction fastInterpolate(_a, _b) {\n    var from = _a[0], to = _a[1];\n    var mixer = _b[0];\n    return function (v) { return mixer(progress(from, to, v)); };\n}\nfunction slowInterpolate(input, mixers) {\n    var inputLength = input.length;\n    var lastInputIndex = inputLength - 1;\n    return function (v) {\n        var mixerIndex = 0;\n        var foundMixerIndex = false;\n        if (v <= input[0]) {\n            foundMixerIndex = true;\n        }\n        else if (v >= input[lastInputIndex]) {\n            mixerIndex = lastInputIndex - 1;\n            foundMixerIndex = true;\n        }\n        if (!foundMixerIndex) {\n            var i = 1;\n            for (; i < inputLength; i++) {\n                if (input[i] > v || i === lastInputIndex) {\n                    break;\n                }\n            }\n            mixerIndex = i - 1;\n        }\n        var progressInRange = progress(input[mixerIndex], input[mixerIndex + 1], v);\n        return mixers[mixerIndex](progressInRange);\n    };\n}\nfunction interpolate(input, output, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.clamp, isClamp = _c === void 0 ? true : _c, ease = _b.ease, mixer = _b.mixer;\n    var inputLength = input.length;\n    invariant(inputLength === output.length, 'Both input and output ranges must be the same length');\n    invariant(!ease || !Array.isArray(ease) || ease.length === inputLength - 1, 'Array of easing functions must be of length `input.length - 1`, as it applies to the transitions **between** the defined values.');\n    if (input[0] > input[inputLength - 1]) {\n        input = [].concat(input);\n        output = [].concat(output);\n        input.reverse();\n        output.reverse();\n    }\n    var mixers = createMixers(output, ease, mixer);\n    var interpolator = inputLength === 2\n        ? fastInterpolate(input, mixers)\n        : slowInterpolate(input, mixers);\n    return isClamp\n        ? function (v) { return interpolator(clamp(input[0], input[inputLength - 1], v)); }\n        : interpolator;\n}\n\nexport { interpolate };\n","var reverseEasing = function (easing) { return function (p) { return 1 - easing(1 - p); }; };\nvar mirrorEasing = function (easing) { return function (p) {\n    return p <= 0.5 ? easing(2 * p) / 2 : (2 - easing(2 * (1 - p))) / 2;\n}; };\nvar createExpoIn = function (power) { return function (p) { return Math.pow(p, power); }; };\nvar createBackIn = function (power) { return function (p) {\n    return p * p * ((power + 1) * p - power);\n}; };\nvar createAnticipate = function (power) {\n    var backEasing = createBackIn(power);\n    return function (p) {\n        return (p *= 2) < 1\n            ? 0.5 * backEasing(p)\n            : 0.5 * (2 - Math.pow(2, -10 * (p - 1)));\n    };\n};\n\nexport { createAnticipate, createBackIn, createExpoIn, mirrorEasing, reverseEasing };\n","import { createExpoIn, reverseEasing, mirrorEasing, createBackIn, createAnticipate } from './utils.js';\n\nvar DEFAULT_OVERSHOOT_STRENGTH = 1.525;\nvar BOUNCE_FIRST_THRESHOLD = 4.0 / 11.0;\nvar BOUNCE_SECOND_THRESHOLD = 8.0 / 11.0;\nvar BOUNCE_THIRD_THRESHOLD = 9.0 / 10.0;\nvar linear = function (p) { return p; };\nvar easeIn = createExpoIn(2);\nvar easeOut = reverseEasing(easeIn);\nvar easeInOut = mirrorEasing(easeIn);\nvar circIn = function (p) { return 1 - Math.sin(Math.acos(p)); };\nvar circOut = reverseEasing(circIn);\nvar circInOut = mirrorEasing(circOut);\nvar backIn = createBackIn(DEFAULT_OVERSHOOT_STRENGTH);\nvar backOut = reverseEasing(backIn);\nvar backInOut = mirrorEasing(backIn);\nvar anticipate = createAnticipate(DEFAULT_OVERSHOOT_STRENGTH);\nvar ca = 4356.0 / 361.0;\nvar cb = 35442.0 / 1805.0;\nvar cc = 16061.0 / 1805.0;\nvar bounceOut = function (p) {\n    if (p === 1 || p === 0)\n        return p;\n    var p2 = p * p;\n    return p < BOUNCE_FIRST_THRESHOLD\n        ? 7.5625 * p2\n        : p < BOUNCE_SECOND_THRESHOLD\n            ? 9.075 * p2 - 9.9 * p + 3.4\n            : p < BOUNCE_THIRD_THRESHOLD\n                ? ca * p2 - cb * p + cc\n                : 10.8 * p * p - 20.52 * p + 10.72;\n};\nvar bounceIn = reverseEasing(bounceOut);\nvar bounceInOut = function (p) {\n    return p < 0.5\n        ? 0.5 * (1.0 - bounceOut(1.0 - p * 2.0))\n        : 0.5 * bounceOut(p * 2.0 - 1.0) + 0.5;\n};\n\nexport { anticipate, backIn, backInOut, backOut, bounceIn, bounceInOut, bounceOut, circIn, circInOut, circOut, easeIn, easeInOut, easeOut, linear };\n","import { interpolate } from '../../utils/interpolate.js';\nimport { easeInOut } from '../../easing/index.js';\n\nfunction defaultEasing(values, easing) {\n    return values.map(function () { return easing || easeInOut; }).splice(0, values.length - 1);\n}\nfunction defaultOffset(values) {\n    var numValues = values.length;\n    return values.map(function (_value, i) {\n        return i !== 0 ? i / (numValues - 1) : 0;\n    });\n}\nfunction convertOffsetToTimes(offset, duration) {\n    return offset.map(function (o) { return o * duration; });\n}\nfunction keyframes(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0 : _b, _c = _a.to, to = _c === void 0 ? 1 : _c, ease = _a.ease, offset = _a.offset, _d = _a.duration, duration = _d === void 0 ? 300 : _d;\n    var state = { done: false, value: from };\n    var values = Array.isArray(to) ? to : [from, to];\n    var times = convertOffsetToTimes(offset && offset.length === values.length\n        ? offset\n        : defaultOffset(values), duration);\n    function createInterpolator() {\n        return interpolate(times, values, {\n            ease: Array.isArray(ease) ? ease : defaultEasing(values, ease),\n        });\n    }\n    var interpolator = createInterpolator();\n    return {\n        next: function (t) {\n            state.value = interpolator(t);\n            state.done = t >= duration;\n            return state;\n        },\n        flipTarget: function () {\n            values.reverse();\n            interpolator = createInterpolator();\n        },\n    };\n}\n\nexport { convertOffsetToTimes, defaultEasing, defaultOffset, keyframes };\n","import { spring } from '../generators/spring.js';\nimport { keyframes } from '../generators/keyframes.js';\nimport { decay } from '../generators/decay.js';\n\nvar types = { keyframes: keyframes, spring: spring, decay: decay };\nfunction detectAnimationFromOptions(config) {\n    if (Array.isArray(config.to)) {\n        return keyframes;\n    }\n    else if (types[config.type]) {\n        return types[config.type];\n    }\n    var keys = new Set(Object.keys(config));\n    if (keys.has(\"ease\") ||\n        (keys.has(\"duration\") && !keys.has(\"dampingRatio\"))) {\n        return keyframes;\n    }\n    else if (keys.has(\"dampingRatio\") ||\n        keys.has(\"stiffness\") ||\n        keys.has(\"mass\") ||\n        keys.has(\"damping\") ||\n        keys.has(\"restSpeed\") ||\n        keys.has(\"restDelta\")) {\n        return spring;\n    }\n    return keyframes;\n}\n\nexport { detectAnimationFromOptions };\n","function decay(_a) {\n    var _b = _a.velocity, velocity = _b === void 0 ? 0 : _b, _c = _a.from, from = _c === void 0 ? 0 : _c, _d = _a.power, power = _d === void 0 ? 0.8 : _d, _e = _a.timeConstant, timeConstant = _e === void 0 ? 350 : _e, _f = _a.restDelta, restDelta = _f === void 0 ? 0.5 : _f, modifyTarget = _a.modifyTarget;\n    var state = { done: false, value: from };\n    var amplitude = power * velocity;\n    var ideal = from + amplitude;\n    var target = modifyTarget === undefined ? ideal : modifyTarget(ideal);\n    if (target !== ideal)\n        amplitude = target - from;\n    return {\n        next: function (t) {\n            var delta = -amplitude * Math.exp(-t / timeConstant);\n            state.done = !(delta > restDelta || delta < -restDelta);\n            state.value = state.done ? target : target + delta;\n            return state;\n        },\n        flipTarget: function () { },\n    };\n}\n\nexport { decay };\n","function loopElapsed(elapsed, duration, delay) {\n    if (delay === void 0) { delay = 0; }\n    return elapsed - duration - delay;\n}\nfunction reverseElapsed(elapsed, duration, delay, isForwardPlayback) {\n    if (delay === void 0) { delay = 0; }\n    if (isForwardPlayback === void 0) { isForwardPlayback = true; }\n    return isForwardPlayback\n        ? loopElapsed(duration + -elapsed, duration, delay)\n        : duration - (elapsed - duration) + delay;\n}\nfunction hasRepeatDelayElapsed(elapsed, duration, delay, isForwardPlayback) {\n    return isForwardPlayback ? elapsed >= duration + delay : elapsed <= -delay;\n}\n\nexport { hasRepeatDelayElapsed, loopElapsed, reverseElapsed };\n","import { __rest, __assign } from 'tslib';\nimport { detectAnimationFromOptions } from './utils/detect-animation-from-options.js';\nimport sync, { cancelSync } from 'framesync';\nimport { interpolate } from '../utils/interpolate.js';\nimport { hasRepeatDelayElapsed, reverseElapsed, loopElapsed } from './utils/elapsed.js';\n\nvar framesync = function (update) {\n    var passTimestamp = function (_a) {\n        var delta = _a.delta;\n        return update(delta);\n    };\n    return {\n        start: function () { return sync.update(passTimestamp, true); },\n        stop: function () { return cancelSync.update(passTimestamp); },\n    };\n};\nfunction animate(_a) {\n    var _b, _c;\n    var from = _a.from, _d = _a.autoplay, autoplay = _d === void 0 ? true : _d, _e = _a.driver, driver = _e === void 0 ? framesync : _e, _f = _a.elapsed, elapsed = _f === void 0 ? 0 : _f, _g = _a.repeat, repeatMax = _g === void 0 ? 0 : _g, _h = _a.repeatType, repeatType = _h === void 0 ? \"loop\" : _h, _j = _a.repeatDelay, repeatDelay = _j === void 0 ? 0 : _j, onPlay = _a.onPlay, onStop = _a.onStop, onComplete = _a.onComplete, onRepeat = _a.onRepeat, onUpdate = _a.onUpdate, options = __rest(_a, [\"from\", \"autoplay\", \"driver\", \"elapsed\", \"repeat\", \"repeatType\", \"repeatDelay\", \"onPlay\", \"onStop\", \"onComplete\", \"onRepeat\", \"onUpdate\"]);\n    var to = options.to;\n    var driverControls;\n    var repeatCount = 0;\n    var computedDuration = options.duration;\n    var latest;\n    var isComplete = false;\n    var isForwardPlayback = true;\n    var interpolateFromNumber;\n    var animator = detectAnimationFromOptions(options);\n    if ((_c = (_b = animator).needsInterpolation) === null || _c === void 0 ? void 0 : _c.call(_b, from, to)) {\n        interpolateFromNumber = interpolate([0, 100], [from, to], {\n            clamp: false,\n        });\n        from = 0;\n        to = 100;\n    }\n    var animation = animator(__assign(__assign({}, options), { from: from, to: to }));\n    function repeat() {\n        repeatCount++;\n        if (repeatType === \"reverse\") {\n            isForwardPlayback = repeatCount % 2 === 0;\n            elapsed = reverseElapsed(elapsed, computedDuration, repeatDelay, isForwardPlayback);\n        }\n        else {\n            elapsed = loopElapsed(elapsed, computedDuration, repeatDelay);\n            if (repeatType === \"mirror\")\n                animation.flipTarget();\n        }\n        isComplete = false;\n        onRepeat && onRepeat();\n    }\n    function complete() {\n        driverControls.stop();\n        onComplete && onComplete();\n    }\n    function update(delta) {\n        if (!isForwardPlayback)\n            delta = -delta;\n        elapsed += delta;\n        if (!isComplete) {\n            var state = animation.next(Math.max(0, elapsed));\n            latest = state.value;\n            if (interpolateFromNumber)\n                latest = interpolateFromNumber(latest);\n            isComplete = isForwardPlayback ? state.done : elapsed <= 0;\n        }\n        onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate(latest);\n        if (isComplete) {\n            if (repeatCount === 0)\n                computedDuration !== null && computedDuration !== void 0 ? computedDuration : (computedDuration = elapsed);\n            if (repeatCount < repeatMax) {\n                hasRepeatDelayElapsed(elapsed, computedDuration, repeatDelay, isForwardPlayback) && repeat();\n            }\n            else {\n                complete();\n            }\n        }\n    }\n    function play() {\n        onPlay === null || onPlay === void 0 ? void 0 : onPlay();\n        driverControls = driver(update);\n        driverControls.start();\n    }\n    autoplay && play();\n    return {\n        stop: function () {\n            onStop === null || onStop === void 0 ? void 0 : onStop();\n            driverControls.stop();\n        },\n    };\n}\n\nexport { animate };\n","function velocityPerSecond(velocity, frameDuration) {\n    return frameDuration ? velocity * (1000 / frameDuration) : 0;\n}\n\nexport { velocityPerSecond };\n","var isPoint = function (point) {\n    return point.hasOwnProperty('x') && point.hasOwnProperty('y');\n};\n\nexport { isPoint };\n","import { isPoint } from './is-point.js';\n\nvar isPoint3D = function (point) {\n    return isPoint(point) && point.hasOwnProperty('z');\n};\n\nexport { isPoint3D };\n","import { isPoint } from './is-point.js';\nimport { isPoint3D } from './is-point-3d.js';\nimport { isNum } from './inc.js';\n\nvar distance1D = function (a, b) { return Math.abs(a - b); };\nfunction distance(a, b) {\n    if (isNum(a) && isNum(b)) {\n        return distance1D(a, b);\n    }\n    else if (isPoint(a) && isPoint(b)) {\n        var xDelta = distance1D(a.x, b.x);\n        var yDelta = distance1D(a.y, b.y);\n        var zDelta = isPoint3D(a) && isPoint3D(b) ? distance1D(a.z, b.z) : 0;\n        return Math.sqrt(Math.pow(xDelta, 2) + Math.pow(yDelta, 2) + Math.pow(zDelta, 2));\n    }\n}\n\nexport { distance };\n","import { linear } from './index.js';\n\nvar a = function (a1, a2) { return 1.0 - 3.0 * a2 + 3.0 * a1; };\nvar b = function (a1, a2) { return 3.0 * a2 - 6.0 * a1; };\nvar c = function (a1) { return 3.0 * a1; };\nvar calcBezier = function (t, a1, a2) {\n    return ((a(a1, a2) * t + b(a1, a2)) * t + c(a1)) * t;\n};\nvar getSlope = function (t, a1, a2) {\n    return 3.0 * a(a1, a2) * t * t + 2.0 * b(a1, a2) * t + c(a1);\n};\nvar subdivisionPrecision = 0.0000001;\nvar subdivisionMaxIterations = 10;\nfunction binarySubdivide(aX, aA, aB, mX1, mX2) {\n    var currentX;\n    var currentT;\n    var i = 0;\n    do {\n        currentT = aA + (aB - aA) / 2.0;\n        currentX = calcBezier(currentT, mX1, mX2) - aX;\n        if (currentX > 0.0) {\n            aB = currentT;\n        }\n        else {\n            aA = currentT;\n        }\n    } while (Math.abs(currentX) > subdivisionPrecision &&\n        ++i < subdivisionMaxIterations);\n    return currentT;\n}\nvar newtonIterations = 8;\nvar newtonMinSlope = 0.001;\nfunction newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n    for (var i = 0; i < newtonIterations; ++i) {\n        var currentSlope = getSlope(aGuessT, mX1, mX2);\n        if (currentSlope === 0.0) {\n            return aGuessT;\n        }\n        var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n        aGuessT -= currentX / currentSlope;\n    }\n    return aGuessT;\n}\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\nfunction cubicBezier(mX1, mY1, mX2, mY2) {\n    if (mX1 === mY1 && mX2 === mY2)\n        return linear;\n    var sampleValues = new Float32Array(kSplineTableSize);\n    for (var i = 0; i < kSplineTableSize; ++i) {\n        sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n    }\n    function getTForX(aX) {\n        var intervalStart = 0.0;\n        var currentSample = 1;\n        var lastSample = kSplineTableSize - 1;\n        for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n            intervalStart += kSampleStepSize;\n        }\n        --currentSample;\n        var dist = (aX - sampleValues[currentSample]) /\n            (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n        var guessForT = intervalStart + dist * kSampleStepSize;\n        var initialSlope = getSlope(guessForT, mX1, mX2);\n        if (initialSlope >= newtonMinSlope) {\n            return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n        }\n        else if (initialSlope === 0.0) {\n            return guessForT;\n        }\n        else {\n            return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n        }\n    }\n    return function (t) {\n        return t === 0 || t === 1 ? t : calcBezier(getTForX(t), mY1, mY2);\n    };\n}\n\nexport { cubicBezier };\n","/**\n * Converts seconds to milliseconds\n *\n * @param seconds - Time in seconds.\n * @return milliseconds - Converted time in milliseconds.\n */\nvar secondsToMilliseconds = function (seconds) { return seconds * 1000; };\n\nexport { secondsToMilliseconds };\n","import { __read } from 'tslib';\nimport { invariant } from 'hey-listen';\nimport { cubicBezier, linear, easeIn, easeInOut, easeOut, circIn, circInOut, circOut, backIn, backInOut, backOut, anticipate, bounceIn, bounceInOut, bounceOut } from 'popmotion';\n\nvar easingLookup = {\n    linear: linear,\n    easeIn: easeIn,\n    easeInOut: easeInOut,\n    easeOut: easeOut,\n    circIn: circIn,\n    circInOut: circInOut,\n    circOut: circOut,\n    backIn: backIn,\n    backInOut: backInOut,\n    backOut: backOut,\n    anticipate: anticipate,\n    bounceIn: bounceIn,\n    bounceInOut: bounceInOut,\n    bounceOut: bounceOut,\n};\nvar easingDefinitionToFunction = function (definition) {\n    if (Array.isArray(definition)) {\n        // If cubic bezier definition, create bezier curve\n        invariant(definition.length === 4, \"Cubic bezier arrays must contain four numerical values.\");\n        var _a = __read(definition, 4), x1 = _a[0], y1 = _a[1], x2 = _a[2], y2 = _a[3];\n        return cubicBezier(x1, y1, x2, y2);\n    }\n    else if (typeof definition === \"string\") {\n        // Else lookup from table\n        invariant(easingLookup[definition] !== undefined, \"Invalid easing type '\" + definition + \"'\");\n        return easingLookup[definition];\n    }\n    return definition;\n};\nvar isEasingArray = function (ease) {\n    return Array.isArray(ease) && typeof ease[0] !== \"number\";\n};\n\nexport { easingDefinitionToFunction, isEasingArray };\n","import { complex } from 'style-value-types';\n\n/**\n * Check if a value is animatable. Examples:\n *\n * ✅: 100, \"100px\", \"#fff\"\n * ❌: \"block\", \"url(2.jpg)\"\n * @param value\n *\n * @internal\n */\nvar isAnimatable = function (key, value) {\n    // If the list of keys tat might be non-animatable grows, replace with Set\n    if (key === \"zIndex\")\n        return false;\n    // If it's a number or a keyframes array, we can animate it. We might at some point\n    // need to do a deep isAnimatable check of keyframes, or let Popmotion handle this,\n    // but for now lets leave it like this for performance reasons\n    if (typeof value === \"number\" || Array.isArray(value))\n        return true;\n    if (typeof value === \"string\" && // It's animatable if we have a string\n        complex.test(value) && // And it contains numbers and/or colors\n        !value.startsWith(\"url(\") // Unless it starts with \"url(\"\n    ) {\n        return true;\n    }\n    return false;\n};\n\nexport { isAnimatable };\n","import { __assign } from 'tslib';\nimport { isKeyframesTarget } from './is-keyframes-target.js';\n\nvar underDampedSpring = function () { return ({\n    type: \"spring\",\n    stiffness: 500,\n    damping: 25,\n    restDelta: 0.5,\n    restSpeed: 10,\n}); };\nvar criticallyDampedSpring = function (to) { return ({\n    type: \"spring\",\n    stiffness: 550,\n    damping: to === 0 ? 2 * Math.sqrt(550) : 30,\n    restDelta: 0.01,\n    restSpeed: 10,\n}); };\nvar linearTween = function () { return ({\n    type: \"keyframes\",\n    ease: \"linear\",\n    duration: 0.3,\n}); };\nvar keyframes = function (values) { return ({\n    type: \"keyframes\",\n    duration: 0.8,\n    values: values,\n}); };\nvar defaultTransitions = {\n    x: underDampedSpring,\n    y: underDampedSpring,\n    z: underDampedSpring,\n    rotate: underDampedSpring,\n    rotateX: underDampedSpring,\n    rotateY: underDampedSpring,\n    rotateZ: underDampedSpring,\n    scaleX: criticallyDampedSpring,\n    scaleY: criticallyDampedSpring,\n    scale: criticallyDampedSpring,\n    opacity: linearTween,\n    backgroundColor: linearTween,\n    color: linearTween,\n    default: criticallyDampedSpring,\n};\nvar getDefaultTransition = function (valueKey, to) {\n    var transitionFactory;\n    if (isKeyframesTarget(to)) {\n        transitionFactory = keyframes;\n    }\n    else {\n        transitionFactory =\n            defaultTransitions[valueKey] || defaultTransitions.default;\n    }\n    return __assign({ to: to }, transitionFactory(to));\n};\n\nexport { criticallyDampedSpring, getDefaultTransition, linearTween, underDampedSpring };\n","import { __assign } from 'tslib';\nimport { color, filter } from 'style-value-types';\nimport { numberValueTypes } from './number.js';\n\n/**\n * A map of default value types for common values\n */\nvar defaultValueTypes = __assign(__assign({}, numberValueTypes), { \n    // Color props\n    color: color, backgroundColor: color, outlineColor: color, fill: color, stroke: color, \n    // Border props\n    borderColor: color, borderTopColor: color, borderRightColor: color, borderBottomColor: color, borderLeftColor: color, filter: filter, WebkitFilter: filter });\n/**\n * Gets the default ValueType for the provided value key\n */\nvar getDefaultValueType = function (key) { return defaultValueTypes[key]; };\n\nexport { defaultValueTypes, getDefaultValueType };\n","import { filter, complex } from 'style-value-types';\nimport { getDefaultValueType } from './defaults.js';\n\nfunction getAnimatableNone(key, value) {\n    var _a;\n    var defaultValueType = getDefaultValueType(key);\n    if (defaultValueType !== filter)\n        defaultValueType = complex;\n    // If value is not recognised as animatable, ie \"none\", create an animatable version origin based on the target\n    return (_a = defaultValueType.getAnimatableNone) === null || _a === void 0 ? void 0 : _a.call(defaultValueType, value);\n}\n\nexport { getAnimatableNone };\n","import { __assign, __rest, __spreadArray, __read } from 'tslib';\nimport { inertia, animate } from 'popmotion';\nimport { secondsToMilliseconds } from '../../utils/time-conversion.js';\nimport { isEasingArray, easingDefinitionToFunction } from './easing.js';\nimport { isAnimatable } from './is-animatable.js';\nimport { getDefaultTransition } from './default-transitions.js';\nimport { warning } from 'hey-listen';\nimport { getAnimatableNone } from '../../render/dom/value-types/animatable-none.js';\n\n/**\n * Decide whether a transition is defined on a given Transition.\n * This filters out orchestration options and returns true\n * if any options are left.\n */\nfunction isTransitionDefined(_a) {\n    _a.when; _a.delay; _a.delayChildren; _a.staggerChildren; _a.staggerDirection; _a.repeat; _a.repeatType; _a.repeatDelay; _a.from; var transition = __rest(_a, [\"when\", \"delay\", \"delayChildren\", \"staggerChildren\", \"staggerDirection\", \"repeat\", \"repeatType\", \"repeatDelay\", \"from\"]);\n    return !!Object.keys(transition).length;\n}\nvar legacyRepeatWarning = false;\n/**\n * Convert Framer Motion's Transition type into Popmotion-compatible options.\n */\nfunction convertTransitionToAnimationOptions(_a) {\n    var ease = _a.ease, times = _a.times, yoyo = _a.yoyo, flip = _a.flip, loop = _a.loop, transition = __rest(_a, [\"ease\", \"times\", \"yoyo\", \"flip\", \"loop\"]);\n    var options = __assign({}, transition);\n    if (times)\n        options[\"offset\"] = times;\n    /**\n     * Convert any existing durations from seconds to milliseconds\n     */\n    if (transition.duration)\n        options[\"duration\"] = secondsToMilliseconds(transition.duration);\n    if (transition.repeatDelay)\n        options.repeatDelay = secondsToMilliseconds(transition.repeatDelay);\n    /**\n     * Map easing names to Popmotion's easing functions\n     */\n    if (ease) {\n        options[\"ease\"] = isEasingArray(ease)\n            ? ease.map(easingDefinitionToFunction)\n            : easingDefinitionToFunction(ease);\n    }\n    /**\n     * Support legacy transition API\n     */\n    if (transition.type === \"tween\")\n        options.type = \"keyframes\";\n    /**\n     * TODO: These options are officially removed from the API.\n     */\n    if (yoyo || loop || flip) {\n        warning(!legacyRepeatWarning, \"yoyo, loop and flip have been removed from the API. Replace with repeat and repeatType options.\");\n        legacyRepeatWarning = true;\n        if (yoyo) {\n            options.repeatType = \"reverse\";\n        }\n        else if (loop) {\n            options.repeatType = \"loop\";\n        }\n        else if (flip) {\n            options.repeatType = \"mirror\";\n        }\n        options.repeat = loop || yoyo || flip || transition.repeat;\n    }\n    /**\n     * TODO: Popmotion 9 has the ability to automatically detect whether to use\n     * a keyframes or spring animation, but does so by detecting velocity and other spring options.\n     * It'd be good to introduce a similar thing here.\n     */\n    if (transition.type !== \"spring\")\n        options.type = \"keyframes\";\n    return options;\n}\n/**\n * Get the delay for a value by checking Transition with decreasing specificity.\n */\nfunction getDelayFromTransition(transition, key) {\n    var _a;\n    var valueTransition = getValueTransition(transition, key) || {};\n    return (_a = valueTransition.delay) !== null && _a !== void 0 ? _a : 0;\n}\nfunction hydrateKeyframes(options) {\n    if (Array.isArray(options.to) && options.to[0] === null) {\n        options.to = __spreadArray([], __read(options.to));\n        options.to[0] = options.from;\n    }\n    return options;\n}\nfunction getPopmotionAnimationOptions(transition, options, key) {\n    var _a;\n    if (Array.isArray(options.to)) {\n        (_a = transition.duration) !== null && _a !== void 0 ? _a : (transition.duration = 0.8);\n    }\n    hydrateKeyframes(options);\n    /**\n     * Get a default transition if none is determined to be defined.\n     */\n    if (!isTransitionDefined(transition)) {\n        transition = __assign(__assign({}, transition), getDefaultTransition(key, options.to));\n    }\n    return __assign(__assign({}, options), convertTransitionToAnimationOptions(transition));\n}\n/**\n *\n */\nfunction getAnimation(key, value, target, transition, onComplete) {\n    var _a;\n    var valueTransition = getValueTransition(transition, key);\n    var origin = (_a = valueTransition.from) !== null && _a !== void 0 ? _a : value.get();\n    var isTargetAnimatable = isAnimatable(key, target);\n    if (origin === \"none\" && isTargetAnimatable && typeof target === \"string\") {\n        /**\n         * If we're trying to animate from \"none\", try and get an animatable version\n         * of the target. This could be improved to work both ways.\n         */\n        origin = getAnimatableNone(key, target);\n    }\n    else if (isZero(origin) && typeof target === \"string\") {\n        origin = getZeroUnit(target);\n    }\n    else if (!Array.isArray(target) &&\n        isZero(target) &&\n        typeof origin === \"string\") {\n        target = getZeroUnit(origin);\n    }\n    var isOriginAnimatable = isAnimatable(key, origin);\n    warning(isOriginAnimatable === isTargetAnimatable, \"You are trying to animate \" + key + \" from \\\"\" + origin + \"\\\" to \\\"\" + target + \"\\\". \" + origin + \" is not an animatable value - to enable this animation set \" + origin + \" to a value animatable to \" + target + \" via the `style` property.\");\n    function start() {\n        var options = {\n            from: origin,\n            to: target,\n            velocity: value.getVelocity(),\n            onComplete: onComplete,\n            onUpdate: function (v) { return value.set(v); },\n        };\n        return valueTransition.type === \"inertia\" ||\n            valueTransition.type === \"decay\"\n            ? inertia(__assign(__assign({}, options), valueTransition))\n            : animate(__assign(__assign({}, getPopmotionAnimationOptions(valueTransition, options, key)), { onUpdate: function (v) {\n                    var _a;\n                    options.onUpdate(v);\n                    (_a = valueTransition.onUpdate) === null || _a === void 0 ? void 0 : _a.call(valueTransition, v);\n                }, onComplete: function () {\n                    var _a;\n                    options.onComplete();\n                    (_a = valueTransition.onComplete) === null || _a === void 0 ? void 0 : _a.call(valueTransition);\n                } }));\n    }\n    function set() {\n        var _a;\n        value.set(target);\n        onComplete();\n        (_a = valueTransition === null || valueTransition === void 0 ? void 0 : valueTransition.onComplete) === null || _a === void 0 ? void 0 : _a.call(valueTransition);\n        return { stop: function () { } };\n    }\n    return !isOriginAnimatable ||\n        !isTargetAnimatable ||\n        valueTransition.type === false\n        ? set\n        : start;\n}\nfunction isZero(value) {\n    return (value === 0 ||\n        (typeof value === \"string\" &&\n            parseFloat(value) === 0 &&\n            value.indexOf(\" \") === -1));\n}\nfunction getZeroUnit(potentialUnitType) {\n    return typeof potentialUnitType === \"number\"\n        ? 0\n        : getAnimatableNone(\"\", potentialUnitType);\n}\nfunction getValueTransition(transition, key) {\n    return transition[key] || transition[\"default\"] || transition;\n}\n/**\n * Start animation on a MotionValue. This function is an interface between\n * Framer Motion and Popmotion\n *\n * @internal\n */\nfunction startAnimation(key, value, target, transition) {\n    if (transition === void 0) { transition = {}; }\n    return value.start(function (onComplete) {\n        var delayTimer;\n        var controls;\n        var animation = getAnimation(key, value, target, transition, onComplete);\n        var delay = getDelayFromTransition(transition, key);\n        var start = function () { return (controls = animation()); };\n        if (delay) {\n            delayTimer = setTimeout(start, secondsToMilliseconds(delay));\n        }\n        else {\n            start();\n        }\n        return function () {\n            clearTimeout(delayTimer);\n            controls === null || controls === void 0 ? void 0 : controls.stop();\n        };\n    });\n}\n\nexport { convertTransitionToAnimationOptions, getDelayFromTransition, getPopmotionAnimationOptions, getValueTransition, getZeroUnit, hydrateKeyframes, isTransitionDefined, isZero, startAnimation };\n","import { __assign } from 'tslib';\nimport { animate } from './index.js';\nimport { velocityPerSecond } from '../utils/velocity-per-second.js';\nimport { getFrameData } from 'framesync';\n\nfunction inertia(_a) {\n    var _b = _a.from, from = _b === void 0 ? 0 : _b, _c = _a.velocity, velocity = _c === void 0 ? 0 : _c, min = _a.min, max = _a.max, _d = _a.power, power = _d === void 0 ? 0.8 : _d, _e = _a.timeConstant, timeConstant = _e === void 0 ? 750 : _e, _f = _a.bounceStiffness, bounceStiffness = _f === void 0 ? 500 : _f, _g = _a.bounceDamping, bounceDamping = _g === void 0 ? 10 : _g, _h = _a.restDelta, restDelta = _h === void 0 ? 1 : _h, modifyTarget = _a.modifyTarget, driver = _a.driver, onUpdate = _a.onUpdate, onComplete = _a.onComplete;\n    var currentAnimation;\n    function isOutOfBounds(v) {\n        return (min !== undefined && v < min) || (max !== undefined && v > max);\n    }\n    function boundaryNearest(v) {\n        if (min === undefined)\n            return max;\n        if (max === undefined)\n            return min;\n        return Math.abs(min - v) < Math.abs(max - v) ? min : max;\n    }\n    function startAnimation(options) {\n        currentAnimation === null || currentAnimation === void 0 ? void 0 : currentAnimation.stop();\n        currentAnimation = animate(__assign(__assign({}, options), { driver: driver, onUpdate: function (v) {\n                var _a;\n                onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate(v);\n                (_a = options.onUpdate) === null || _a === void 0 ? void 0 : _a.call(options, v);\n            }, onComplete: onComplete }));\n    }\n    function startSpring(options) {\n        startAnimation(__assign({ type: \"spring\", stiffness: bounceStiffness, damping: bounceDamping, restDelta: restDelta }, options));\n    }\n    if (isOutOfBounds(from)) {\n        startSpring({ from: from, velocity: velocity, to: boundaryNearest(from) });\n    }\n    else {\n        var target = power * velocity + from;\n        if (typeof modifyTarget !== \"undefined\")\n            target = modifyTarget(target);\n        var boundary_1 = boundaryNearest(target);\n        var heading_1 = boundary_1 === min ? -1 : 1;\n        var prev_1;\n        var current_1;\n        var checkBoundary = function (v) {\n            prev_1 = current_1;\n            current_1 = v;\n            velocity = velocityPerSecond(v - prev_1, getFrameData().delta);\n            if ((heading_1 === 1 && v > boundary_1) ||\n                (heading_1 === -1 && v < boundary_1)) {\n                startSpring({ from: v, to: boundary_1, velocity: velocity });\n            }\n        };\n        startAnimation({\n            type: \"decay\",\n            from: from,\n            velocity: velocity,\n            timeConstant: timeConstant,\n            power: power,\n            restDelta: restDelta,\n            modifyTarget: modifyTarget,\n            onUpdate: isOutOfBounds(target) ? checkBoundary : undefined,\n        });\n    }\n    return {\n        stop: function () { return currentAnimation === null || currentAnimation === void 0 ? void 0 : currentAnimation.stop(); },\n    };\n}\n\nexport { inertia };\n","function addUniqueItem(arr, item) {\n    arr.indexOf(item) === -1 && arr.push(item);\n}\nfunction removeItem(arr, item) {\n    var index = arr.indexOf(item);\n    index > -1 && arr.splice(index, 1);\n}\n\nexport { addUniqueItem, removeItem };\n","import { addUniqueItem, removeItem } from './array.js';\n\nvar SubscriptionManager = /** @class */ (function () {\n    function SubscriptionManager() {\n        this.subscriptions = [];\n    }\n    SubscriptionManager.prototype.add = function (handler) {\n        var _this = this;\n        addUniqueItem(this.subscriptions, handler);\n        return function () { return removeItem(_this.subscriptions, handler); };\n    };\n    SubscriptionManager.prototype.notify = function (a, b, c) {\n        var numSubscriptions = this.subscriptions.length;\n        if (!numSubscriptions)\n            return;\n        if (numSubscriptions === 1) {\n            /**\n             * If there's only a single handler we can just call it without invoking a loop.\n             */\n            this.subscriptions[0](a, b, c);\n        }\n        else {\n            for (var i = 0; i < numSubscriptions; i++) {\n                /**\n                 * Check whether the handler exists before firing as it's possible\n                 * the subscriptions were modified during this loop running.\n                 */\n                var handler = this.subscriptions[i];\n                handler && handler(a, b, c);\n            }\n        }\n    };\n    SubscriptionManager.prototype.getSize = function () {\n        return this.subscriptions.length;\n    };\n    SubscriptionManager.prototype.clear = function () {\n        this.subscriptions.length = 0;\n    };\n    return SubscriptionManager;\n}());\n\nexport { SubscriptionManager };\n","import sync, { getFrameData } from 'framesync';\nimport { velocityPerSecond } from 'popmotion';\nimport { SubscriptionManager } from '../utils/subscription-manager.js';\n\nvar isFloat = function (value) {\n    return !isNaN(parseFloat(value));\n};\n/**\n * `MotionValue` is used to track the state and velocity of motion values.\n *\n * @public\n */\nvar MotionValue = /** @class */ (function () {\n    /**\n     * @param init - The initiating value\n     * @param config - Optional configuration options\n     *\n     * -  `transformer`: A function to transform incoming values with.\n     *\n     * @internal\n     */\n    function MotionValue(init) {\n        var _this = this;\n        /**\n         * Duration, in milliseconds, since last updating frame.\n         *\n         * @internal\n         */\n        this.timeDelta = 0;\n        /**\n         * Timestamp of the last time this `MotionValue` was updated.\n         *\n         * @internal\n         */\n        this.lastUpdated = 0;\n        /**\n         * Functions to notify when the `MotionValue` updates.\n         *\n         * @internal\n         */\n        this.updateSubscribers = new SubscriptionManager();\n        /**\n         * Functions to notify when the velocity updates.\n         *\n         * @internal\n         */\n        this.velocityUpdateSubscribers = new SubscriptionManager();\n        /**\n         * Functions to notify when the `MotionValue` updates and `render` is set to `true`.\n         *\n         * @internal\n         */\n        this.renderSubscribers = new SubscriptionManager();\n        /**\n         * Tracks whether this value can output a velocity. Currently this is only true\n         * if the value is numerical, but we might be able to widen the scope here and support\n         * other value types.\n         *\n         * @internal\n         */\n        this.canTrackVelocity = false;\n        this.updateAndNotify = function (v, render) {\n            if (render === void 0) { render = true; }\n            _this.prev = _this.current;\n            _this.current = v;\n            // Update timestamp\n            var _a = getFrameData(), delta = _a.delta, timestamp = _a.timestamp;\n            if (_this.lastUpdated !== timestamp) {\n                _this.timeDelta = delta;\n                _this.lastUpdated = timestamp;\n                sync.postRender(_this.scheduleVelocityCheck);\n            }\n            // Update update subscribers\n            if (_this.prev !== _this.current) {\n                _this.updateSubscribers.notify(_this.current);\n            }\n            // Update velocity subscribers\n            if (_this.velocityUpdateSubscribers.getSize()) {\n                _this.velocityUpdateSubscribers.notify(_this.getVelocity());\n            }\n            // Update render subscribers\n            if (render) {\n                _this.renderSubscribers.notify(_this.current);\n            }\n        };\n        /**\n         * Schedule a velocity check for the next frame.\n         *\n         * This is an instanced and bound function to prevent generating a new\n         * function once per frame.\n         *\n         * @internal\n         */\n        this.scheduleVelocityCheck = function () { return sync.postRender(_this.velocityCheck); };\n        /**\n         * Updates `prev` with `current` if the value hasn't been updated this frame.\n         * This ensures velocity calculations return `0`.\n         *\n         * This is an instanced and bound function to prevent generating a new\n         * function once per frame.\n         *\n         * @internal\n         */\n        this.velocityCheck = function (_a) {\n            var timestamp = _a.timestamp;\n            if (timestamp !== _this.lastUpdated) {\n                _this.prev = _this.current;\n                _this.velocityUpdateSubscribers.notify(_this.getVelocity());\n            }\n        };\n        this.hasAnimated = false;\n        this.prev = this.current = init;\n        this.canTrackVelocity = isFloat(this.current);\n    }\n    /**\n     * Adds a function that will be notified when the `MotionValue` is updated.\n     *\n     * It returns a function that, when called, will cancel the subscription.\n     *\n     * When calling `onChange` inside a React component, it should be wrapped with the\n     * `useEffect` hook. As it returns an unsubscribe function, this should be returned\n     * from the `useEffect` function to ensure you don't add duplicate subscribers..\n     *\n     * @library\n     *\n     * ```jsx\n     * function MyComponent() {\n     *   const x = useMotionValue(0)\n     *   const y = useMotionValue(0)\n     *   const opacity = useMotionValue(1)\n     *\n     *   useEffect(() => {\n     *     function updateOpacity() {\n     *       const maxXY = Math.max(x.get(), y.get())\n     *       const newOpacity = transform(maxXY, [0, 100], [1, 0])\n     *       opacity.set(newOpacity)\n     *     }\n     *\n     *     const unsubscribeX = x.onChange(updateOpacity)\n     *     const unsubscribeY = y.onChange(updateOpacity)\n     *\n     *     return () => {\n     *       unsubscribeX()\n     *       unsubscribeY()\n     *     }\n     *   }, [])\n     *\n     *   return <Frame x={x} />\n     * }\n     * ```\n     *\n     * @motion\n     *\n     * ```jsx\n     * export const MyComponent = () => {\n     *   const x = useMotionValue(0)\n     *   const y = useMotionValue(0)\n     *   const opacity = useMotionValue(1)\n     *\n     *   useEffect(() => {\n     *     function updateOpacity() {\n     *       const maxXY = Math.max(x.get(), y.get())\n     *       const newOpacity = transform(maxXY, [0, 100], [1, 0])\n     *       opacity.set(newOpacity)\n     *     }\n     *\n     *     const unsubscribeX = x.onChange(updateOpacity)\n     *     const unsubscribeY = y.onChange(updateOpacity)\n     *\n     *     return () => {\n     *       unsubscribeX()\n     *       unsubscribeY()\n     *     }\n     *   }, [])\n     *\n     *   return <motion.div style={{ x }} />\n     * }\n     * ```\n     *\n     * @internalremarks\n     *\n     * We could look into a `useOnChange` hook if the above lifecycle management proves confusing.\n     *\n     * ```jsx\n     * useOnChange(x, () => {})\n     * ```\n     *\n     * @param subscriber - A function that receives the latest value.\n     * @returns A function that, when called, will cancel this subscription.\n     *\n     * @public\n     */\n    MotionValue.prototype.onChange = function (subscription) {\n        return this.updateSubscribers.add(subscription);\n    };\n    MotionValue.prototype.clearListeners = function () {\n        this.updateSubscribers.clear();\n    };\n    /**\n     * Adds a function that will be notified when the `MotionValue` requests a render.\n     *\n     * @param subscriber - A function that's provided the latest value.\n     * @returns A function that, when called, will cancel this subscription.\n     *\n     * @internal\n     */\n    MotionValue.prototype.onRenderRequest = function (subscription) {\n        // Render immediately\n        subscription(this.get());\n        return this.renderSubscribers.add(subscription);\n    };\n    /**\n     * Attaches a passive effect to the `MotionValue`.\n     *\n     * @internal\n     */\n    MotionValue.prototype.attach = function (passiveEffect) {\n        this.passiveEffect = passiveEffect;\n    };\n    /**\n     * Sets the state of the `MotionValue`.\n     *\n     * @remarks\n     *\n     * ```jsx\n     * const x = useMotionValue(0)\n     * x.set(10)\n     * ```\n     *\n     * @param latest - Latest value to set.\n     * @param render - Whether to notify render subscribers. Defaults to `true`\n     *\n     * @public\n     */\n    MotionValue.prototype.set = function (v, render) {\n        if (render === void 0) { render = true; }\n        if (!render || !this.passiveEffect) {\n            this.updateAndNotify(v, render);\n        }\n        else {\n            this.passiveEffect(v, this.updateAndNotify);\n        }\n    };\n    /**\n     * Returns the latest state of `MotionValue`\n     *\n     * @returns - The latest state of `MotionValue`\n     *\n     * @public\n     */\n    MotionValue.prototype.get = function () {\n        return this.current;\n    };\n    /**\n     * @public\n     */\n    MotionValue.prototype.getPrevious = function () {\n        return this.prev;\n    };\n    /**\n     * Returns the latest velocity of `MotionValue`\n     *\n     * @returns - The latest velocity of `MotionValue`. Returns `0` if the state is non-numerical.\n     *\n     * @public\n     */\n    MotionValue.prototype.getVelocity = function () {\n        // This could be isFloat(this.prev) && isFloat(this.current), but that would be wasteful\n        return this.canTrackVelocity\n            ? // These casts could be avoided if parseFloat would be typed better\n                velocityPerSecond(parseFloat(this.current) -\n                    parseFloat(this.prev), this.timeDelta)\n            : 0;\n    };\n    /**\n     * Registers a new animation to control this `MotionValue`. Only one\n     * animation can drive a `MotionValue` at one time.\n     *\n     * ```jsx\n     * value.start()\n     * ```\n     *\n     * @param animation - A function that starts the provided animation\n     *\n     * @internal\n     */\n    MotionValue.prototype.start = function (animation) {\n        var _this = this;\n        this.stop();\n        return new Promise(function (resolve) {\n            _this.hasAnimated = true;\n            _this.stopAnimation = animation(resolve);\n        }).then(function () { return _this.clearAnimation(); });\n    };\n    /**\n     * Stop the currently active animation.\n     *\n     * @public\n     */\n    MotionValue.prototype.stop = function () {\n        if (this.stopAnimation)\n            this.stopAnimation();\n        this.clearAnimation();\n    };\n    /**\n     * Returns `true` if this value is currently animating.\n     *\n     * @public\n     */\n    MotionValue.prototype.isAnimating = function () {\n        return !!this.stopAnimation;\n    };\n    MotionValue.prototype.clearAnimation = function () {\n        this.stopAnimation = null;\n    };\n    /**\n     * Destroy and clean up subscribers to this `MotionValue`.\n     *\n     * The `MotionValue` hooks like `useMotionValue` and `useTransform` automatically\n     * handle the lifecycle of the returned `MotionValue`, so this method is only necessary if you've manually\n     * created a `MotionValue` via the `motionValue` function.\n     *\n     * @public\n     */\n    MotionValue.prototype.destroy = function () {\n        this.updateSubscribers.clear();\n        this.renderSubscribers.clear();\n        this.stop();\n    };\n    return MotionValue;\n}());\n/**\n * @internal\n */\nfunction motionValue(init) {\n    return new MotionValue(init);\n}\n\nexport { MotionValue, motionValue };\n","import { __assign } from 'tslib';\nimport { isMouseEvent, isTouchEvent } from './utils/event-type.js';\nimport { extractEventInfo } from '../events/event-info.js';\nimport sync, { getFrameData, cancelSync } from 'framesync';\nimport { secondsToMilliseconds } from '../utils/time-conversion.js';\nimport { addPointerEvent } from '../events/use-pointer-event.js';\nimport { distance, pipe } from 'popmotion';\n\n/**\n * @internal\n */\nvar PanSession = /** @class */ (function () {\n    function PanSession(event, handlers, _a) {\n        var _this = this;\n        var _b = _a === void 0 ? {} : _a, transformPagePoint = _b.transformPagePoint;\n        /**\n         * @internal\n         */\n        this.startEvent = null;\n        /**\n         * @internal\n         */\n        this.lastMoveEvent = null;\n        /**\n         * @internal\n         */\n        this.lastMoveEventInfo = null;\n        /**\n         * @internal\n         */\n        this.handlers = {};\n        this.updatePoint = function () {\n            if (!(_this.lastMoveEvent && _this.lastMoveEventInfo))\n                return;\n            var info = getPanInfo(_this.lastMoveEventInfo, _this.history);\n            var isPanStarted = _this.startEvent !== null;\n            // Only start panning if the offset is larger than 3 pixels. If we make it\n            // any larger than this we'll want to reset the pointer history\n            // on the first update to avoid visual snapping to the cursoe.\n            var isDistancePastThreshold = distance(info.offset, { x: 0, y: 0 }) >= 3;\n            if (!isPanStarted && !isDistancePastThreshold)\n                return;\n            var point = info.point;\n            var timestamp = getFrameData().timestamp;\n            _this.history.push(__assign(__assign({}, point), { timestamp: timestamp }));\n            var _a = _this.handlers, onStart = _a.onStart, onMove = _a.onMove;\n            if (!isPanStarted) {\n                onStart && onStart(_this.lastMoveEvent, info);\n                _this.startEvent = _this.lastMoveEvent;\n            }\n            onMove && onMove(_this.lastMoveEvent, info);\n        };\n        this.handlePointerMove = function (event, info) {\n            _this.lastMoveEvent = event;\n            _this.lastMoveEventInfo = transformPoint(info, _this.transformPagePoint);\n            // Because Safari doesn't trigger mouseup events when it's above a `<select>`\n            if (isMouseEvent(event) && event.buttons === 0) {\n                _this.handlePointerUp(event, info);\n                return;\n            }\n            // Throttle mouse move event to once per frame\n            sync.update(_this.updatePoint, true);\n        };\n        this.handlePointerUp = function (event, info) {\n            _this.end();\n            var _a = _this.handlers, onEnd = _a.onEnd, onSessionEnd = _a.onSessionEnd;\n            var panInfo = getPanInfo(transformPoint(info, _this.transformPagePoint), _this.history);\n            if (_this.startEvent && onEnd) {\n                onEnd(event, panInfo);\n            }\n            onSessionEnd && onSessionEnd(event, panInfo);\n        };\n        // If we have more than one touch, don't start detecting this gesture\n        if (isTouchEvent(event) && event.touches.length > 1)\n            return;\n        this.handlers = handlers;\n        this.transformPagePoint = transformPagePoint;\n        var info = extractEventInfo(event);\n        var initialInfo = transformPoint(info, this.transformPagePoint);\n        var point = initialInfo.point;\n        var timestamp = getFrameData().timestamp;\n        this.history = [__assign(__assign({}, point), { timestamp: timestamp })];\n        var onSessionStart = handlers.onSessionStart;\n        onSessionStart &&\n            onSessionStart(event, getPanInfo(initialInfo, this.history));\n        this.removeListeners = pipe(addPointerEvent(window, \"pointermove\", this.handlePointerMove), addPointerEvent(window, \"pointerup\", this.handlePointerUp), addPointerEvent(window, \"pointercancel\", this.handlePointerUp));\n    }\n    PanSession.prototype.updateHandlers = function (handlers) {\n        this.handlers = handlers;\n    };\n    PanSession.prototype.end = function () {\n        this.removeListeners && this.removeListeners();\n        cancelSync.update(this.updatePoint);\n    };\n    return PanSession;\n}());\nfunction transformPoint(info, transformPagePoint) {\n    return transformPagePoint ? { point: transformPagePoint(info.point) } : info;\n}\nfunction subtractPoint(a, b) {\n    return { x: a.x - b.x, y: a.y - b.y };\n}\nfunction getPanInfo(_a, history) {\n    var point = _a.point;\n    return {\n        point: point,\n        delta: subtractPoint(point, lastDevicePoint(history)),\n        offset: subtractPoint(point, startDevicePoint(history)),\n        velocity: getVelocity(history, 0.1),\n    };\n}\nfunction startDevicePoint(history) {\n    return history[0];\n}\nfunction lastDevicePoint(history) {\n    return history[history.length - 1];\n}\nfunction getVelocity(history, timeDelta) {\n    if (history.length < 2) {\n        return { x: 0, y: 0 };\n    }\n    var i = history.length - 1;\n    var timestampedPoint = null;\n    var lastPoint = lastDevicePoint(history);\n    while (i >= 0) {\n        timestampedPoint = history[i];\n        if (lastPoint.timestamp - timestampedPoint.timestamp >\n            secondsToMilliseconds(timeDelta)) {\n            break;\n        }\n        i--;\n    }\n    if (!timestampedPoint) {\n        return { x: 0, y: 0 };\n    }\n    var time = (lastPoint.timestamp - timestampedPoint.timestamp) / 1000;\n    if (time === 0) {\n        return { x: 0, y: 0 };\n    }\n    var currentVelocity = {\n        x: (lastPoint.x - timestampedPoint.x) / time,\n        y: (lastPoint.y - timestampedPoint.y) / time,\n    };\n    if (currentVelocity.x === Infinity) {\n        currentVelocity.x = 0;\n    }\n    if (currentVelocity.y === Infinity) {\n        currentVelocity.y = 0;\n    }\n    return currentVelocity;\n}\n\nexport { PanSession };\n","// Call a handler once for each axis\nfunction eachAxis(handler) {\n    return [handler(\"x\"), handler(\"y\")];\n}\n\nexport { eachAxis };\n","import { __read } from 'tslib';\nimport { mix } from 'popmotion';\n\n/**\n * Apply constraints to a point. These constraints are both physical along an\n * axis, and an elastic factor that determines how much to constrain the point\n * by if it does lie outside the defined parameters.\n */\nfunction applyConstraints(point, _a, elastic) {\n    var min = _a.min, max = _a.max;\n    if (min !== undefined && point < min) {\n        // If we have a min point defined, and this is outside of that, constrain\n        point = elastic ? mix(min, point, elastic.min) : Math.max(point, min);\n    }\n    else if (max !== undefined && point > max) {\n        // If we have a max point defined, and this is outside of that, constrain\n        point = elastic ? mix(max, point, elastic.max) : Math.min(point, max);\n    }\n    return point;\n}\n/**\n * Calculates a min projection point based on a pointer, pointer progress\n * within the drag target, and constraints.\n *\n * For instance if an element was 100px width, we were dragging from 0.25\n * along this axis, the pointer is at 200px, and there were no constraints,\n * we would calculate a min projection point of 175px.\n */\nfunction calcConstrainedMinPoint(point, length, progress, constraints, elastic) {\n    // Calculate a min point for this axis and apply it to the current pointer\n    var min = point - length * progress;\n    return constraints ? applyConstraints(min, constraints, elastic) : min;\n}\n/**\n * Calculate constraints in terms of the viewport when defined relatively to the\n * measured axis. This is measured from the nearest edge, so a max constraint of 200\n * on an axis with a max value of 300 would return a constraint of 500 - axis length\n */\nfunction calcRelativeAxisConstraints(axis, min, max) {\n    return {\n        min: min !== undefined ? axis.min + min : undefined,\n        max: max !== undefined\n            ? axis.max + max - (axis.max - axis.min)\n            : undefined,\n    };\n}\n/**\n * Calculate constraints in terms of the viewport when\n * defined relatively to the measured bounding box.\n */\nfunction calcRelativeConstraints(layoutBox, _a) {\n    var top = _a.top, left = _a.left, bottom = _a.bottom, right = _a.right;\n    return {\n        x: calcRelativeAxisConstraints(layoutBox.x, left, right),\n        y: calcRelativeAxisConstraints(layoutBox.y, top, bottom),\n    };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative axis\n */\nfunction calcViewportAxisConstraints(layoutAxis, constraintsAxis) {\n    var _a;\n    var min = constraintsAxis.min - layoutAxis.min;\n    var max = constraintsAxis.max - layoutAxis.max;\n    // If the constraints axis is actually smaller than the layout axis then we can\n    // flip the constraints\n    if (constraintsAxis.max - constraintsAxis.min <\n        layoutAxis.max - layoutAxis.min) {\n        _a = __read([max, min], 2), min = _a[0], max = _a[1];\n    }\n    return {\n        min: layoutAxis.min + min,\n        max: layoutAxis.min + max,\n    };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative box\n */\nfunction calcViewportConstraints(layoutBox, constraintsBox) {\n    return {\n        x: calcViewportAxisConstraints(layoutBox.x, constraintsBox.x),\n        y: calcViewportAxisConstraints(layoutBox.y, constraintsBox.y),\n    };\n}\n/**\n * Calculate the an axis position based on two axes and a progress value.\n */\nfunction calcPositionFromProgress(axis, constraints, progress) {\n    var axisLength = axis.max - axis.min;\n    var min = mix(constraints.min, constraints.max - axisLength, progress);\n    return { min: min, max: min + axisLength };\n}\n/**\n * Rebase the calculated viewport constraints relative to the layout.min point.\n */\nfunction rebaseAxisConstraints(layout, constraints) {\n    var relativeConstraints = {};\n    if (constraints.min !== undefined) {\n        relativeConstraints.min = constraints.min - layout.min;\n    }\n    if (constraints.max !== undefined) {\n        relativeConstraints.max = constraints.max - layout.min;\n    }\n    return relativeConstraints;\n}\nvar defaultElastic = 0.35;\n/**\n * Accepts a dragElastic prop and returns resolved elastic values for each axis.\n */\nfunction resolveDragElastic(dragElastic) {\n    if (dragElastic === false) {\n        dragElastic = 0;\n    }\n    else if (dragElastic === true) {\n        dragElastic = defaultElastic;\n    }\n    return {\n        x: resolveAxisElastic(dragElastic, \"left\", \"right\"),\n        y: resolveAxisElastic(dragElastic, \"top\", \"bottom\"),\n    };\n}\nfunction resolveAxisElastic(dragElastic, minLabel, maxLabel) {\n    return {\n        min: resolvePointElastic(dragElastic, minLabel),\n        max: resolvePointElastic(dragElastic, maxLabel),\n    };\n}\nfunction resolvePointElastic(dragElastic, label) {\n    var _a;\n    return typeof dragElastic === \"number\"\n        ? dragElastic\n        : (_a = dragElastic[label]) !== null && _a !== void 0 ? _a : 0;\n}\n\nexport { applyConstraints, calcConstrainedMinPoint, calcPositionFromProgress, calcRelativeAxisConstraints, calcRelativeConstraints, calcViewportAxisConstraints, calcViewportConstraints, defaultElastic, rebaseAxisConstraints, resolveAxisElastic, resolveDragElastic, resolvePointElastic };\n","import { convertBoundingBoxToAxisBox, transformBoundingBox } from '../../../utils/geometry/index.js';\n\n/**\n * Measure and return the element bounding box.\n *\n * We convert the box into an AxisBox2D to make it easier to work with each axis\n * individually and programmatically.\n *\n * This function optionally accepts a transformPagePoint function which allows us to compensate\n * for, for instance, measuring the element within a scaled plane like a Framer devivce preview component.\n */\nfunction getBoundingBox(element, transformPagePoint) {\n    var box = element.getBoundingClientRect();\n    return convertBoundingBoxToAxisBox(transformBoundingBox(box, transformPagePoint));\n}\n\nexport { getBoundingBox };\n","import { mix, distance, clamp, progress } from 'popmotion';\n\nvar clampProgress = function (v) { return clamp(0, 1, v); };\n/**\n * Returns true if the provided value is within maxDistance of the provided target\n */\nfunction isNear(value, target, maxDistance) {\n    if (target === void 0) { target = 0; }\n    if (maxDistance === void 0) { maxDistance = 0.01; }\n    return distance(value, target) < maxDistance;\n}\nfunction calcLength(axis) {\n    return axis.max - axis.min;\n}\n/**\n * Calculate a transform origin relative to the source axis, between 0-1, that results\n * in an asthetically pleasing scale/transform needed to project from source to target.\n */\nfunction calcOrigin(source, target) {\n    var origin = 0.5;\n    var sourceLength = calcLength(source);\n    var targetLength = calcLength(target);\n    if (targetLength > sourceLength) {\n        origin = progress(target.min, target.max - sourceLength, source.min);\n    }\n    else if (sourceLength > targetLength) {\n        origin = progress(source.min, source.max - targetLength, target.min);\n    }\n    return clampProgress(origin);\n}\n/**\n * Update the AxisDelta with a transform that projects source into target.\n *\n * The transform `origin` is optional. If not provided, it'll be automatically\n * calculated based on the relative positions of the two bounding boxes.\n */\nfunction updateAxisDelta(delta, source, target, origin) {\n    if (origin === void 0) { origin = 0.5; }\n    delta.origin = origin;\n    delta.originPoint = mix(source.min, source.max, delta.origin);\n    delta.scale = calcLength(target) / calcLength(source);\n    if (isNear(delta.scale, 1, 0.0001))\n        delta.scale = 1;\n    delta.translate =\n        mix(target.min, target.max, delta.origin) - delta.originPoint;\n    if (isNear(delta.translate))\n        delta.translate = 0;\n}\n/**\n * Update the BoxDelta with a transform that projects the source into the target.\n *\n * The transform `origin` is optional. If not provided, it'll be automatically\n * calculated based on the relative positions of the two bounding boxes.\n */\nfunction updateBoxDelta(delta, source, target, origin) {\n    updateAxisDelta(delta.x, source.x, target.x, defaultOrigin(origin.originX));\n    updateAxisDelta(delta.y, source.y, target.y, defaultOrigin(origin.originY));\n}\n/**\n * Currently this only accepts numerical origins, measured as 0-1, but could\n * accept pixel values by comparing to the target axis.\n */\nfunction defaultOrigin(origin) {\n    return typeof origin === \"number\" ? origin : 0.5;\n}\nfunction calcRelativeAxis(target, relative, parent) {\n    target.min = parent.min + relative.min;\n    target.max = target.min + calcLength(relative);\n}\nfunction calcRelativeBox(projection, parentProjection) {\n    calcRelativeAxis(projection.target.x, projection.relativeTarget.x, parentProjection.target.x);\n    calcRelativeAxis(projection.target.y, projection.relativeTarget.y, parentProjection.target.y);\n}\n\nexport { calcOrigin, calcRelativeAxis, calcRelativeBox, isNear, updateAxisDelta, updateBoxDelta };\n","import { mix } from 'popmotion';\n\nfunction tweenAxis(target, prev, next, p) {\n    target.min = mix(prev.min, next.min, p);\n    target.max = mix(prev.max, next.max, p);\n}\nfunction calcRelativeOffsetAxis(parent, child) {\n    return {\n        min: child.min - parent.min,\n        max: child.max - parent.min,\n    };\n}\nfunction calcRelativeOffset(parent, child) {\n    return {\n        x: calcRelativeOffsetAxis(parent.x, child.x),\n        y: calcRelativeOffsetAxis(parent.y, child.y),\n    };\n}\nfunction checkIfParentHasChanged(prev, next) {\n    var prevId = prev.getLayoutId();\n    var nextId = next.getLayoutId();\n    return prevId !== nextId || (nextId === undefined && prev !== next);\n}\n\nexport { calcRelativeOffset, calcRelativeOffsetAxis, checkIfParentHasChanged, tweenAxis };\n","function isDraggable(visualElement) {\n    var _a = visualElement.getProps(), drag = _a.drag, _dragX = _a._dragX;\n    return drag && !_dragX;\n}\n\nexport { isDraggable };\n","import { __read } from 'tslib';\nimport { mix } from 'popmotion';\nimport { isDraggable } from '../../render/utils/is-draggable.js';\n\n/**\n * Reset an axis to the provided origin box.\n *\n * This is a mutative operation.\n */\nfunction resetAxis(axis, originAxis) {\n    axis.min = originAxis.min;\n    axis.max = originAxis.max;\n}\n/**\n * Reset a box to the provided origin box.\n *\n * This is a mutative operation.\n */\nfunction resetBox(box, originBox) {\n    resetAxis(box.x, originBox.x);\n    resetAxis(box.y, originBox.y);\n}\n/**\n * Scales a point based on a factor and an originPoint\n */\nfunction scalePoint(point, scale, originPoint) {\n    var distanceFromOrigin = point - originPoint;\n    var scaled = scale * distanceFromOrigin;\n    return originPoint + scaled;\n}\n/**\n * Applies a translate/scale delta to a point\n */\nfunction applyPointDelta(point, translate, scale, originPoint, boxScale) {\n    if (boxScale !== undefined) {\n        point = scalePoint(point, boxScale, originPoint);\n    }\n    return scalePoint(point, scale, originPoint) + translate;\n}\n/**\n * Applies a translate/scale delta to an axis\n */\nfunction applyAxisDelta(axis, translate, scale, originPoint, boxScale) {\n    if (translate === void 0) { translate = 0; }\n    if (scale === void 0) { scale = 1; }\n    axis.min = applyPointDelta(axis.min, translate, scale, originPoint, boxScale);\n    axis.max = applyPointDelta(axis.max, translate, scale, originPoint, boxScale);\n}\n/**\n * Applies a translate/scale delta to a box\n */\nfunction applyBoxDelta(box, _a) {\n    var x = _a.x, y = _a.y;\n    applyAxisDelta(box.x, x.translate, x.scale, x.originPoint);\n    applyAxisDelta(box.y, y.translate, y.scale, y.originPoint);\n}\n/**\n * Apply a transform to an axis from the latest resolved motion values.\n * This function basically acts as a bridge between a flat motion value map\n * and applyAxisDelta\n */\nfunction applyAxisTransforms(final, axis, transforms, _a) {\n    var _b = __read(_a, 3), key = _b[0], scaleKey = _b[1], originKey = _b[2];\n    // Copy the current axis to the final axis before mutation\n    final.min = axis.min;\n    final.max = axis.max;\n    var axisOrigin = transforms[originKey] !== undefined ? transforms[originKey] : 0.5;\n    var originPoint = mix(axis.min, axis.max, axisOrigin);\n    // Apply the axis delta to the final axis\n    applyAxisDelta(final, transforms[key], transforms[scaleKey], originPoint, transforms.scale);\n}\n/**\n * The names of the motion values we want to apply as translation, scale and origin.\n */\nvar xKeys = [\"x\", \"scaleX\", \"originX\"];\nvar yKeys = [\"y\", \"scaleY\", \"originY\"];\n/**\n * Apply a transform to a box from the latest resolved motion values.\n */\nfunction applyBoxTransforms(finalBox, box, transforms) {\n    applyAxisTransforms(finalBox.x, box.x, transforms, xKeys);\n    applyAxisTransforms(finalBox.y, box.y, transforms, yKeys);\n}\n/**\n * Remove a delta from a point. This is essentially the steps of applyPointDelta in reverse\n */\nfunction removePointDelta(point, translate, scale, originPoint, boxScale) {\n    point -= translate;\n    point = scalePoint(point, 1 / scale, originPoint);\n    if (boxScale !== undefined) {\n        point = scalePoint(point, 1 / boxScale, originPoint);\n    }\n    return point;\n}\n/**\n * Remove a delta from an axis. This is essentially the steps of applyAxisDelta in reverse\n */\nfunction removeAxisDelta(axis, translate, scale, origin, boxScale) {\n    if (translate === void 0) { translate = 0; }\n    if (scale === void 0) { scale = 1; }\n    if (origin === void 0) { origin = 0.5; }\n    var originPoint = mix(axis.min, axis.max, origin) - translate;\n    axis.min = removePointDelta(axis.min, translate, scale, originPoint, boxScale);\n    axis.max = removePointDelta(axis.max, translate, scale, originPoint, boxScale);\n}\n/**\n * Remove a transforms from an axis. This is essentially the steps of applyAxisTransforms in reverse\n * and acts as a bridge between motion values and removeAxisDelta\n */\nfunction removeAxisTransforms(axis, transforms, _a) {\n    var _b = __read(_a, 3), key = _b[0], scaleKey = _b[1], originKey = _b[2];\n    removeAxisDelta(axis, transforms[key], transforms[scaleKey], transforms[originKey], transforms.scale);\n}\n/**\n * Remove a transforms from an box. This is essentially the steps of applyAxisBox in reverse\n * and acts as a bridge between motion values and removeAxisDelta\n */\nfunction removeBoxTransforms(box, transforms) {\n    removeAxisTransforms(box.x, transforms, xKeys);\n    removeAxisTransforms(box.y, transforms, yKeys);\n}\n/**\n * Apply a tree of deltas to a box. We do this to calculate the effect of all the transforms\n * in a tree upon our box before then calculating how to project it into our desired viewport-relative box\n *\n * This is the final nested loop within updateLayoutDelta for future refactoring\n */\nfunction applyTreeDeltas(box, treeScale, treePath) {\n    var treeLength = treePath.length;\n    if (!treeLength)\n        return;\n    // Reset the treeScale\n    treeScale.x = treeScale.y = 1;\n    var node;\n    var delta;\n    for (var i = 0; i < treeLength; i++) {\n        node = treePath[i];\n        delta = node.getLayoutState().delta;\n        // Incoporate each ancestor's scale into a culmulative treeScale for this component\n        treeScale.x *= delta.x.scale;\n        treeScale.y *= delta.y.scale;\n        // Apply each ancestor's calculated delta into this component's recorded layout box\n        applyBoxDelta(box, delta);\n        // If this is a draggable ancestor, also incorporate the node's transform to the layout box\n        if (isDraggable(node)) {\n            applyBoxTransforms(box, box, node.getLatestValues());\n        }\n    }\n}\n\nexport { applyAxisDelta, applyAxisTransforms, applyBoxDelta, applyBoxTransforms, applyPointDelta, applyTreeDeltas, removeAxisDelta, removeAxisTransforms, removeBoxTransforms, removePointDelta, resetAxis, resetBox, scalePoint };\n","import { __rest, __assign, __spreadArray, __read } from 'tslib';\nimport { invariant } from 'hey-listen';\nimport { PanSession } from '../PanSession.js';\nimport { getGlobalLock } from './utils/lock.js';\nimport { isRefObject } from '../../utils/is-ref-object.js';\nimport { addPointerEvent } from '../../events/use-pointer-event.js';\nimport { addDomEvent } from '../../events/use-dom-event.js';\nimport { getViewportPointFromEvent } from '../../events/event-info.js';\nimport { axisBox, convertAxisBoxToBoundingBox, convertBoundingBoxToAxisBox } from '../../utils/geometry/index.js';\nimport { eachAxis } from '../../utils/each-axis.js';\nimport { calcRelativeConstraints, resolveDragElastic, rebaseAxisConstraints, calcViewportConstraints, applyConstraints, calcConstrainedMinPoint, calcPositionFromProgress, defaultElastic } from './utils/constraints.js';\nimport { getBoundingBox } from '../../render/dom/projection/measure.js';\nimport { calcOrigin } from '../../utils/geometry/delta-calc.js';\nimport { startAnimation } from '../../animation/utils/transitions.js';\nimport { AnimationType } from '../../render/utils/types.js';\nimport { collectProjectingAncestors, updateLayoutMeasurement, collectProjectingChildren } from '../../render/dom/projection/utils.js';\nimport { progress } from 'popmotion';\nimport { convertToRelativeProjection } from '../../render/dom/projection/convert-to-relative.js';\nimport { calcRelativeOffset } from '../../motion/features/layout/utils.js';\nimport { flushLayout, batchLayout } from '../../render/dom/utils/batch-layout.js';\nimport { flushSync } from 'framesync';\n\nvar elementDragControls = new WeakMap();\n/**\n *\n */\nvar lastPointerEvent;\nvar VisualElementDragControls = /** @class */ (function () {\n    function VisualElementDragControls(_a) {\n        var visualElement = _a.visualElement;\n        /**\n         * Track whether we're currently dragging.\n         *\n         * @internal\n         */\n        this.isDragging = false;\n        /**\n         * The current direction of drag, or `null` if both.\n         *\n         * @internal\n         */\n        this.currentDirection = null;\n        /**\n         * The permitted boundaries of travel, in pixels.\n         *\n         * @internal\n         */\n        this.constraints = false;\n        /**\n         * The per-axis resolved elastic values.\n         *\n         * @internal\n         */\n        this.elastic = axisBox();\n        /**\n         * A reference to the host component's latest props.\n         *\n         * @internal\n         */\n        this.props = {};\n        /**\n         * @internal\n         */\n        this.hasMutatedConstraints = false;\n        /**\n         * Track the initial position of the cursor relative to the dragging element\n         * when dragging starts as a value of 0-1 on each axis. We then use this to calculate\n         * an ideal bounding box for the VisualElement renderer to project into every frame.\n         *\n         * @internal\n         */\n        this.cursorProgress = {\n            x: 0.5,\n            y: 0.5,\n        };\n        // When updating _dragX, or _dragY instead of the VisualElement,\n        // persist their values between drag gestures.\n        this.originPoint = {};\n        // This is a reference to the global drag gesture lock, ensuring only one component\n        // can \"capture\" the drag of one or both axes.\n        // TODO: Look into moving this into pansession?\n        this.openGlobalLock = null;\n        /**\n         * @internal\n         */\n        this.panSession = null;\n        this.visualElement = visualElement;\n        this.visualElement.enableLayoutProjection();\n        elementDragControls.set(visualElement, this);\n    }\n    /**\n     * Instantiate a PanSession for the drag gesture\n     *\n     * @public\n     */\n    VisualElementDragControls.prototype.start = function (originEvent, _a) {\n        var _this = this;\n        var _b = _a === void 0 ? {} : _a, _c = _b.snapToCursor, snapToCursor = _c === void 0 ? false : _c, cursorProgress = _b.cursorProgress;\n        var onSessionStart = function (event) {\n            var _a;\n            // Stop any animations on both axis values immediately. This allows the user to throw and catch\n            // the component.\n            _this.stopMotion();\n            /**\n             * Save the initial point. We'll use this to calculate the pointer's position rather\n             * than the one we receive when the gesture actually starts. By then, the pointer will\n             * have already moved, and the perception will be of the pointer \"slipping\" across the element\n             */\n            var initialPoint = getViewportPointFromEvent(event).point;\n            (_a = _this.cancelLayout) === null || _a === void 0 ? void 0 : _a.call(_this);\n            _this.cancelLayout = batchLayout(function (read, write) {\n                var ancestors = collectProjectingAncestors(_this.visualElement);\n                var children = collectProjectingChildren(_this.visualElement);\n                var tree = __spreadArray(__spreadArray([], __read(ancestors)), __read(children));\n                var hasManuallySetCursorOrigin = false;\n                /**\n                 * Apply a simple lock to the projection target. This ensures no animations\n                 * can run on the projection box while this lock is active.\n                 */\n                _this.isLayoutDrag() && _this.visualElement.lockProjectionTarget();\n                write(function () {\n                    tree.forEach(function (element) { return element.resetTransform(); });\n                });\n                read(function () {\n                    updateLayoutMeasurement(_this.visualElement);\n                    children.forEach(updateLayoutMeasurement);\n                });\n                write(function () {\n                    tree.forEach(function (element) { return element.restoreTransform(); });\n                    if (snapToCursor) {\n                        hasManuallySetCursorOrigin = _this.snapToCursor(initialPoint);\n                    }\n                });\n                read(function () {\n                    var isRelativeDrag = Boolean(_this.getAxisMotionValue(\"x\") && !_this.isExternalDrag());\n                    if (!isRelativeDrag) {\n                        _this.visualElement.rebaseProjectionTarget(true, _this.visualElement.measureViewportBox(false));\n                    }\n                    _this.visualElement.scheduleUpdateLayoutProjection();\n                    /**\n                     * When dragging starts, we want to find where the cursor is relative to the bounding box\n                     * of the element. Every frame, we calculate a new bounding box using this relative position\n                     * and let the visualElement renderer figure out how to reproject the element into this bounding\n                     * box.\n                     *\n                     * By doing it this way, rather than applying an x/y transform directly to the element,\n                     * we can ensure the component always visually sticks to the cursor as we'd expect, even\n                     * if the DOM element itself changes layout as a result of React updates the user might\n                     * make based on the drag position.\n                     */\n                    var projection = _this.visualElement.projection;\n                    eachAxis(function (axis) {\n                        if (!hasManuallySetCursorOrigin) {\n                            var _a = projection.target[axis], min = _a.min, max = _a.max;\n                            _this.cursorProgress[axis] = cursorProgress\n                                ? cursorProgress[axis]\n                                : progress(min, max, initialPoint[axis]);\n                        }\n                        /**\n                         * If we have external drag MotionValues, record their origin point. On pointermove\n                         * we'll apply the pan gesture offset directly to this value.\n                         */\n                        var axisValue = _this.getAxisMotionValue(axis);\n                        if (axisValue) {\n                            _this.originPoint[axis] = axisValue.get();\n                        }\n                    });\n                });\n                write(function () {\n                    flushSync.update();\n                    flushSync.preRender();\n                    flushSync.render();\n                    flushSync.postRender();\n                });\n                read(function () { return _this.resolveDragConstraints(); });\n            });\n        };\n        var onStart = function (event, info) {\n            var _a, _b, _c;\n            // Attempt to grab the global drag gesture lock - maybe make this part of PanSession\n            var _d = _this.props, drag = _d.drag, dragPropagation = _d.dragPropagation;\n            if (drag && !dragPropagation) {\n                if (_this.openGlobalLock)\n                    _this.openGlobalLock();\n                _this.openGlobalLock = getGlobalLock(drag);\n                // If we don 't have the lock, don't start dragging\n                if (!_this.openGlobalLock)\n                    return;\n            }\n            flushLayout();\n            // Set current drag status\n            _this.isDragging = true;\n            _this.currentDirection = null;\n            // Fire onDragStart event\n            (_b = (_a = _this.props).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, event, info);\n            (_c = _this.visualElement.animationState) === null || _c === void 0 ? void 0 : _c.setActive(AnimationType.Drag, true);\n        };\n        var onMove = function (event, info) {\n            var _a, _b, _c, _d;\n            var _e = _this.props, dragPropagation = _e.dragPropagation, dragDirectionLock = _e.dragDirectionLock;\n            // If we didn't successfully receive the gesture lock, early return.\n            if (!dragPropagation && !_this.openGlobalLock)\n                return;\n            var offset = info.offset;\n            // Attempt to detect drag direction if directionLock is true\n            if (dragDirectionLock && _this.currentDirection === null) {\n                _this.currentDirection = getCurrentDirection(offset);\n                // If we've successfully set a direction, notify listener\n                if (_this.currentDirection !== null) {\n                    (_b = (_a = _this.props).onDirectionLock) === null || _b === void 0 ? void 0 : _b.call(_a, _this.currentDirection);\n                }\n                return;\n            }\n            // Update each point with the latest position\n            _this.updateAxis(\"x\", info.point, offset);\n            _this.updateAxis(\"y\", info.point, offset);\n            // Fire onDrag event\n            (_d = (_c = _this.props).onDrag) === null || _d === void 0 ? void 0 : _d.call(_c, event, info);\n            // Update the last pointer event\n            lastPointerEvent = event;\n        };\n        var onSessionEnd = function (event, info) {\n            return _this.stop(event, info);\n        };\n        var transformPagePoint = this.props.transformPagePoint;\n        this.panSession = new PanSession(originEvent, {\n            onSessionStart: onSessionStart,\n            onStart: onStart,\n            onMove: onMove,\n            onSessionEnd: onSessionEnd,\n        }, { transformPagePoint: transformPagePoint });\n    };\n    VisualElementDragControls.prototype.resolveDragConstraints = function () {\n        var _this = this;\n        var _a = this.props, dragConstraints = _a.dragConstraints, dragElastic = _a.dragElastic;\n        var layout = this.visualElement.getLayoutState().layoutCorrected;\n        if (dragConstraints) {\n            this.constraints = isRefObject(dragConstraints)\n                ? this.resolveRefConstraints(layout, dragConstraints)\n                : calcRelativeConstraints(layout, dragConstraints);\n        }\n        else {\n            this.constraints = false;\n        }\n        this.elastic = resolveDragElastic(dragElastic);\n        /**\n         * If we're outputting to external MotionValues, we want to rebase the measured constraints\n         * from viewport-relative to component-relative.\n         */\n        if (this.constraints && !this.hasMutatedConstraints) {\n            eachAxis(function (axis) {\n                if (_this.getAxisMotionValue(axis)) {\n                    _this.constraints[axis] = rebaseAxisConstraints(layout[axis], _this.constraints[axis]);\n                }\n            });\n        }\n    };\n    VisualElementDragControls.prototype.resolveRefConstraints = function (layoutBox, constraints) {\n        var _a = this.props, onMeasureDragConstraints = _a.onMeasureDragConstraints, transformPagePoint = _a.transformPagePoint;\n        var constraintsElement = constraints.current;\n        invariant(constraintsElement !== null, \"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.\");\n        this.constraintsBox = getBoundingBox(constraintsElement, transformPagePoint);\n        var measuredConstraints = calcViewportConstraints(layoutBox, this.constraintsBox);\n        /**\n         * If there's an onMeasureDragConstraints listener we call it and\n         * if different constraints are returned, set constraints to that\n         */\n        if (onMeasureDragConstraints) {\n            var userConstraints = onMeasureDragConstraints(convertAxisBoxToBoundingBox(measuredConstraints));\n            this.hasMutatedConstraints = !!userConstraints;\n            if (userConstraints) {\n                measuredConstraints = convertBoundingBoxToAxisBox(userConstraints);\n            }\n        }\n        return measuredConstraints;\n    };\n    VisualElementDragControls.prototype.cancelDrag = function () {\n        var _a, _b;\n        this.visualElement.unlockProjectionTarget();\n        (_a = this.cancelLayout) === null || _a === void 0 ? void 0 : _a.call(this);\n        this.isDragging = false;\n        this.panSession && this.panSession.end();\n        this.panSession = null;\n        if (!this.props.dragPropagation && this.openGlobalLock) {\n            this.openGlobalLock();\n            this.openGlobalLock = null;\n        }\n        (_b = this.visualElement.animationState) === null || _b === void 0 ? void 0 : _b.setActive(AnimationType.Drag, false);\n    };\n    VisualElementDragControls.prototype.stop = function (event, info) {\n        var _a, _b, _c;\n        (_a = this.panSession) === null || _a === void 0 ? void 0 : _a.end();\n        this.panSession = null;\n        var isDragging = this.isDragging;\n        this.cancelDrag();\n        if (!isDragging)\n            return;\n        var velocity = info.velocity;\n        this.animateDragEnd(velocity);\n        (_c = (_b = this.props).onDragEnd) === null || _c === void 0 ? void 0 : _c.call(_b, event, info);\n    };\n    VisualElementDragControls.prototype.snapToCursor = function (point) {\n        var _this = this;\n        return eachAxis(function (axis) {\n            var drag = _this.props.drag;\n            // If we're not dragging this axis, do an early return.\n            if (!shouldDrag(axis, drag, _this.currentDirection))\n                return;\n            var axisValue = _this.getAxisMotionValue(axis);\n            if (axisValue) {\n                var box = _this.visualElement.getLayoutState().layout;\n                var length_1 = box[axis].max - box[axis].min;\n                var center = box[axis].min + length_1 / 2;\n                var offset = point[axis] - center;\n                _this.originPoint[axis] = point[axis];\n                axisValue.set(offset);\n            }\n            else {\n                _this.cursorProgress[axis] = 0.5;\n                return true;\n            }\n        }).includes(true);\n    };\n    /**\n     * Update the specified axis with the latest pointer information.\n     */\n    VisualElementDragControls.prototype.updateAxis = function (axis, point, offset) {\n        var drag = this.props.drag;\n        // If we're not dragging this axis, do an early return.\n        if (!shouldDrag(axis, drag, this.currentDirection))\n            return;\n        return this.getAxisMotionValue(axis)\n            ? this.updateAxisMotionValue(axis, offset)\n            : this.updateVisualElementAxis(axis, point);\n    };\n    VisualElementDragControls.prototype.updateAxisMotionValue = function (axis, offset) {\n        var axisValue = this.getAxisMotionValue(axis);\n        if (!offset || !axisValue)\n            return;\n        var nextValue = this.originPoint[axis] + offset[axis];\n        var update = this.constraints\n            ? applyConstraints(nextValue, this.constraints[axis], this.elastic[axis])\n            : nextValue;\n        axisValue.set(update);\n    };\n    VisualElementDragControls.prototype.updateVisualElementAxis = function (axis, point) {\n        var _a;\n        // Get the actual layout bounding box of the element\n        var axisLayout = this.visualElement.getLayoutState().layout[axis];\n        // Calculate its current length. In the future we might want to lerp this to animate\n        // between lengths if the layout changes as we change the DOM\n        var axisLength = axisLayout.max - axisLayout.min;\n        // Get the initial progress that the pointer sat on this axis on gesture start.\n        var axisProgress = this.cursorProgress[axis];\n        // Calculate a new min point based on the latest pointer position, constraints and elastic\n        var min = calcConstrainedMinPoint(point[axis], axisLength, axisProgress, (_a = this.constraints) === null || _a === void 0 ? void 0 : _a[axis], this.elastic[axis]);\n        // Update the axis viewport target with this new min and the length\n        this.visualElement.setProjectionTargetAxis(axis, min, min + axisLength);\n    };\n    VisualElementDragControls.prototype.setProps = function (_a) {\n        var _b = _a.drag, drag = _b === void 0 ? false : _b, _c = _a.dragDirectionLock, dragDirectionLock = _c === void 0 ? false : _c, _d = _a.dragPropagation, dragPropagation = _d === void 0 ? false : _d, _e = _a.dragConstraints, dragConstraints = _e === void 0 ? false : _e, _f = _a.dragElastic, dragElastic = _f === void 0 ? defaultElastic : _f, _g = _a.dragMomentum, dragMomentum = _g === void 0 ? true : _g, remainingProps = __rest(_a, [\"drag\", \"dragDirectionLock\", \"dragPropagation\", \"dragConstraints\", \"dragElastic\", \"dragMomentum\"]);\n        this.props = __assign({ drag: drag,\n            dragDirectionLock: dragDirectionLock,\n            dragPropagation: dragPropagation,\n            dragConstraints: dragConstraints,\n            dragElastic: dragElastic,\n            dragMomentum: dragMomentum }, remainingProps);\n    };\n    /**\n     * Drag works differently depending on which props are provided.\n     *\n     * - If _dragX and _dragY are provided, we output the gesture delta directly to those motion values.\n     * - If the component will perform layout animations, we output the gesture to the component's\n     *      visual bounding box\n     * - Otherwise, we apply the delta to the x/y motion values.\n     */\n    VisualElementDragControls.prototype.getAxisMotionValue = function (axis) {\n        var _a = this.props, layout = _a.layout, layoutId = _a.layoutId;\n        var dragKey = \"_drag\" + axis.toUpperCase();\n        if (this.props[dragKey]) {\n            return this.props[dragKey];\n        }\n        else if (!layout && layoutId === undefined) {\n            return this.visualElement.getValue(axis, 0);\n        }\n    };\n    VisualElementDragControls.prototype.isLayoutDrag = function () {\n        return !this.getAxisMotionValue(\"x\");\n    };\n    VisualElementDragControls.prototype.isExternalDrag = function () {\n        var _a = this.props, _dragX = _a._dragX, _dragY = _a._dragY;\n        return _dragX || _dragY;\n    };\n    VisualElementDragControls.prototype.animateDragEnd = function (velocity) {\n        var _this = this;\n        var _a = this.props, drag = _a.drag, dragMomentum = _a.dragMomentum, dragElastic = _a.dragElastic, dragTransition = _a.dragTransition;\n        /**\n         * Everything beyond the drag gesture should be performed with\n         * relative projection so children stay in sync with their parent element.\n         */\n        var isRelative = convertToRelativeProjection(this.visualElement, this.isLayoutDrag() && !this.isExternalDrag());\n        /**\n         * If we had previously resolved constraints relative to the viewport,\n         * we need to also convert those to a relative coordinate space for the animation\n         */\n        var constraints = this.constraints || {};\n        if (isRelative &&\n            Object.keys(constraints).length &&\n            this.isLayoutDrag()) {\n            var projectionParent = this.visualElement.getProjectionParent();\n            if (projectionParent) {\n                var relativeConstraints_1 = calcRelativeOffset(projectionParent.projection.targetFinal, constraints);\n                eachAxis(function (axis) {\n                    var _a = relativeConstraints_1[axis], min = _a.min, max = _a.max;\n                    constraints[axis] = {\n                        min: isNaN(min) ? undefined : min,\n                        max: isNaN(max) ? undefined : max,\n                    };\n                });\n            }\n        }\n        var momentumAnimations = eachAxis(function (axis) {\n            var _a;\n            if (!shouldDrag(axis, drag, _this.currentDirection)) {\n                return;\n            }\n            var transition = (_a = constraints === null || constraints === void 0 ? void 0 : constraints[axis]) !== null && _a !== void 0 ? _a : {};\n            /**\n             * Overdamp the boundary spring if `dragElastic` is disabled. There's still a frame\n             * of spring animations so we should look into adding a disable spring option to `inertia`.\n             * We could do something here where we affect the `bounceStiffness` and `bounceDamping`\n             * using the value of `dragElastic`.\n             */\n            var bounceStiffness = dragElastic ? 200 : 1000000;\n            var bounceDamping = dragElastic ? 40 : 10000000;\n            var inertia = __assign(__assign({ type: \"inertia\", velocity: dragMomentum ? velocity[axis] : 0, bounceStiffness: bounceStiffness,\n                bounceDamping: bounceDamping, timeConstant: 750, restDelta: 1, restSpeed: 10 }, dragTransition), transition);\n            // If we're not animating on an externally-provided `MotionValue` we can use the\n            // component's animation controls which will handle interactions with whileHover (etc),\n            // otherwise we just have to animate the `MotionValue` itself.\n            return _this.getAxisMotionValue(axis)\n                ? _this.startAxisValueAnimation(axis, inertia)\n                : _this.visualElement.startLayoutAnimation(axis, inertia, isRelative);\n        });\n        // Run all animations and then resolve the new drag constraints.\n        return Promise.all(momentumAnimations).then(function () {\n            var _a, _b;\n            (_b = (_a = _this.props).onDragTransitionEnd) === null || _b === void 0 ? void 0 : _b.call(_a);\n        });\n    };\n    VisualElementDragControls.prototype.stopMotion = function () {\n        var _this = this;\n        eachAxis(function (axis) {\n            var axisValue = _this.getAxisMotionValue(axis);\n            axisValue\n                ? axisValue.stop()\n                : _this.visualElement.stopLayoutAnimation();\n        });\n    };\n    VisualElementDragControls.prototype.startAxisValueAnimation = function (axis, transition) {\n        var axisValue = this.getAxisMotionValue(axis);\n        if (!axisValue)\n            return;\n        var currentValue = axisValue.get();\n        axisValue.set(currentValue);\n        axisValue.set(currentValue); // Set twice to hard-reset velocity\n        return startAnimation(axis, axisValue, 0, transition);\n    };\n    VisualElementDragControls.prototype.scalePoint = function () {\n        var _this = this;\n        var _a = this.props, drag = _a.drag, dragConstraints = _a.dragConstraints;\n        if (!isRefObject(dragConstraints) || !this.constraintsBox)\n            return;\n        // Stop any current animations as there can be some visual glitching if we resize mid animation\n        this.stopMotion();\n        // Record the relative progress of the targetBox relative to the constraintsBox\n        var boxProgress = { x: 0, y: 0 };\n        eachAxis(function (axis) {\n            boxProgress[axis] = calcOrigin(_this.visualElement.projection.target[axis], _this.constraintsBox[axis]);\n        });\n        /**\n         * For each axis, calculate the current progress of the layout axis within the constraints.\n         * Then, using the latest layout and constraints measurements, reposition the new layout axis\n         * proportionally within the constraints.\n         */\n        this.updateConstraints(function () {\n            eachAxis(function (axis) {\n                if (!shouldDrag(axis, drag, null))\n                    return;\n                // Calculate the position of the targetBox relative to the constraintsBox using the\n                // previously calculated progress\n                var _a = calcPositionFromProgress(_this.visualElement.projection.target[axis], _this.constraintsBox[axis], boxProgress[axis]), min = _a.min, max = _a.max;\n                _this.visualElement.setProjectionTargetAxis(axis, min, max);\n            });\n        });\n        /**\n         * If any other draggable components are queuing the same tasks synchronously\n         * this will wait until they've all been scheduled before flushing.\n         */\n        setTimeout(flushLayout, 1);\n    };\n    VisualElementDragControls.prototype.updateConstraints = function (onReady) {\n        var _this = this;\n        this.cancelLayout = batchLayout(function (read, write) {\n            var ancestors = collectProjectingAncestors(_this.visualElement);\n            write(function () {\n                return ancestors.forEach(function (element) { return element.resetTransform(); });\n            });\n            read(function () { return updateLayoutMeasurement(_this.visualElement); });\n            write(function () {\n                return ancestors.forEach(function (element) { return element.restoreTransform(); });\n            });\n            read(function () {\n                _this.resolveDragConstraints();\n            });\n            if (onReady)\n                write(onReady);\n        });\n    };\n    VisualElementDragControls.prototype.mount = function (visualElement) {\n        var _this = this;\n        var element = visualElement.getInstance();\n        /**\n         * Attach a pointerdown event listener on this DOM element to initiate drag tracking.\n         */\n        var stopPointerListener = addPointerEvent(element, \"pointerdown\", function (event) {\n            var _a = _this.props, drag = _a.drag, _b = _a.dragListener, dragListener = _b === void 0 ? true : _b;\n            drag && dragListener && _this.start(event);\n        });\n        /**\n         * Attach a window resize listener to scale the draggable target within its defined\n         * constraints as the window resizes.\n         */\n        var stopResizeListener = addDomEvent(window, \"resize\", function () {\n            _this.scalePoint();\n        });\n        /**\n         * Ensure drag constraints are resolved correctly relative to the dragging element\n         * whenever its layout changes.\n         */\n        var stopLayoutUpdateListener = visualElement.onLayoutUpdate(function () {\n            if (_this.isDragging) {\n                _this.resolveDragConstraints();\n            }\n        });\n        /**\n         * If the previous component with this same layoutId was dragging at the time\n         * it was unmounted, we want to continue the same gesture on this component.\n         */\n        var prevDragCursor = visualElement.prevDragCursor;\n        if (prevDragCursor) {\n            this.start(lastPointerEvent, { cursorProgress: prevDragCursor });\n        }\n        /**\n         * Return a function that will teardown the drag gesture\n         */\n        return function () {\n            stopPointerListener === null || stopPointerListener === void 0 ? void 0 : stopPointerListener();\n            stopResizeListener === null || stopResizeListener === void 0 ? void 0 : stopResizeListener();\n            stopLayoutUpdateListener === null || stopLayoutUpdateListener === void 0 ? void 0 : stopLayoutUpdateListener();\n            _this.cancelDrag();\n        };\n    };\n    return VisualElementDragControls;\n}());\nfunction shouldDrag(direction, drag, currentDirection) {\n    return ((drag === true || drag === direction) &&\n        (currentDirection === null || currentDirection === direction));\n}\n/**\n * Based on an x/y offset determine the current drag direction. If both axis' offsets are lower\n * than the provided threshold, return `null`.\n *\n * @param offset - The x/y offset from origin.\n * @param lockThreshold - (Optional) - the minimum absolute offset before we can determine a drag direction.\n */\nfunction getCurrentDirection(offset, lockThreshold) {\n    if (lockThreshold === void 0) { lockThreshold = 10; }\n    var direction = null;\n    if (Math.abs(offset.y) > lockThreshold) {\n        direction = \"y\";\n    }\n    else if (Math.abs(offset.x) > lockThreshold) {\n        direction = \"x\";\n    }\n    return direction;\n}\n\nexport { VisualElementDragControls, elementDragControls };\n","import { calcRelativeOffset } from '../../../motion/features/layout/utils.js';\nimport { eachAxis } from '../../../utils/each-axis.js';\nimport { removeBoxTransforms } from '../../../utils/geometry/delta-apply.js';\n\n/**\n * Returns a boolean stating whether or not we converted the projection\n * to relative projection.\n */\nfunction convertToRelativeProjection(visualElement, isLayoutDrag) {\n    if (isLayoutDrag === void 0) { isLayoutDrag = true; }\n    var projectionParent = visualElement.getProjectionParent();\n    if (!projectionParent)\n        return false;\n    var offset;\n    if (isLayoutDrag) {\n        offset = calcRelativeOffset(projectionParent.projection.target, visualElement.projection.target);\n        removeBoxTransforms(offset, projectionParent.getLatestValues());\n    }\n    else {\n        offset = calcRelativeOffset(projectionParent.getLayoutState().layout, visualElement.getLayoutState().layout);\n    }\n    eachAxis(function (axis) {\n        return visualElement.setProjectionTargetAxis(axis, offset[axis].min, offset[axis].max, true);\n    });\n    return true;\n}\n\nexport { convertToRelativeProjection };\n"],"names":["invariant","isColorString","type","testProp","v","Boolean","isString","singleColorRegex","test","startsWith","Object","prototype","hasOwnProperty","call","splitColor","aName","bName","cName","_a","_b","match","floatRegex","a","b","c","alpha","parseFloat","hsla","parse","transform","hue","saturation","lightness","alpha$1","Math","round","percent","sanitize","clampRgbUnit","clamp","rgbUnit","__assign","number","rgba","red","green","blue","hex","parseHex","r","g","length","substr","parseInt","color","colorToken","numberToken","analyse","values","numColors","colors","colorRegex","replace","push","apply","map","numbers","tokenised","createTransformer","numValues","output","i","convertNumbersToZero","complex","_c","_d","isNaN","getAnimatableNone","parsed","transformer","maxDefaults","Set","applyDefaultFilter","slice","split","name","value","unit","defaultValue","has","AnimationType","functionRegex","filter","functions","join","addDomEvent","target","eventName","handler","options","addEventListener","removeEventListener","useDomEvent","ref","useEffect","element","current","isMouseEvent","event","PointerEvent","pointerType","MouseEvent","isTouchEvent","touches","defaultPagePoint","pageX","pageY","pointFromTouch","e","pointType","point","changedTouches","x","y","pointFromMouse","extractEventInfo","wrapHandler","shouldFilterPrimaryPointer","listener","filterPrimaryPointer","eventHandler","button","mouseEventNames","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","pointerenter","pointerleave","touchEventNames","getPointerEventName","isBrowser","window","onpointerdown","ontouchstart","onmousedown","addPointerEvent","usePointerEvent","createLock","lock","globalHorizontalLock","globalVerticalLock","getGlobalLock","drag","openHorizontal_1","openVertical_1","isDragActive","openGestureLock","min","max","safeMin","findSpring","envelope","derivative","duration","bounce","velocity","_e","mass","dampingRatio","undampedFreq","exponentialDecay","delta","calcAngularFreq","exp","d","pow","f","approximateRoot","initialGuess","result","rootIterations","stiffness","damping","sqrt","durationKeys","physicsKeys","isSpringType","keys","some","key","spring","from","to","restSpeed","restDelta","__rest","state","done","getSpringOptions","springOptions","isResolvedFromDuration","derived","resolveSpring","zero","resolveVelocity","createSpring","initialVelocity","initialDelta","undampedAngularFreq","abs","angularFreq_1","t","sin","cos","dampedAngularFreq_1","freqForT","sinh","cosh","next","currentVelocity","isBelowVelocityThreshold","isBelowDisplacementThreshold","flipTarget","needsInterpolation","_t","progress","toFromDifference","mix","mixLinearColor","fromExpo","toExpo","colorTypes","getColorType","find","mixColor","fromColorType","toColorType","fromColor","toColor","blended","mixFunc","isNum","combineFunctions","pipe","transformers","_i","arguments","reduce","getMixer","origin","mixComplex","mixArray","__spreadArray","blendValue","fromThis","mixObject","numNumbers","numRGB","numHSL","template","originStats","targetStats","mixNumber","p","createMixers","ease","customMixer","mixers","mixerFactory","detectMixerFactory","Array","isArray","numMixers","mixer","easingFunction","interpolate","input","isClamp","inputLength","concat","reverse","interpolator","fastInterpolate","slowInterpolate","lastInputIndex","mixerIndex","foundMixerIndex","progressInRange","power","reverseEasing","easing","mirrorEasing","createBackIn","BOUNCE_FIRST_THRESHOLD","BOUNCE_SECOND_THRESHOLD","linear","easeIn","easeOut","easeInOut","circIn","acos","circOut","circInOut","backIn","backOut","backInOut","anticipate","backEasing","createAnticipate","ca","cb","cc","bounceOut","p2","bounceIn","defaultEasing","splice","keyframes","offset","times","convertOffsetToTimes","o","defaultOffset","_value","createInterpolator","types","decay","timeConstant","_f","modifyTarget","amplitude","ideal","loopElapsed","elapsed","delay","framesync","update","passTimestamp","start","sync","stop","cancelSync","animate","driverControls","latest","interpolateFromNumber","autoplay","driver","_g","repeat","repeatMax","_h","repeatType","_j","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate","repeatCount","computedDuration","isComplete","isForwardPlayback","animator","detectAnimationFromOptions","config","animation","reverseElapsed","hasRepeatDelayElapsed","complete","play","velocityPerSecond","frameDuration","isPoint","isPoint3D","distance1D","distance","xDelta","yDelta","zDelta","z","a1","a2","calcBezier","getSlope","kSampleStepSize","cubicBezier","mX1","mY1","mX2","mY2","sampleValues","Float32Array","getTForX","aX","intervalStart","currentSample","kSplineTableSize","guessForT","initialSlope","newtonRaphsonIterate","aGuessT","currentSlope","binarySubdivide","aA","aB","currentX","currentT","secondsToMilliseconds","seconds","easingLookup","bounceInOut","easingDefinitionToFunction","definition","__read","isAnimatable","underDampedSpring","criticallyDampedSpring","linearTween","defaultTransitions","rotate","rotateX","rotateY","rotateZ","scaleX","scaleY","scale","opacity","backgroundColor","default","defaultValueTypes","numberValueTypes","outlineColor","fill","stroke","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","WebkitFilter","getDefaultValueType","defaultValueType","convertTransitionToAnimationOptions","yoyo","flip","loop","transition","isEasingArray","getPopmotionAnimationOptions","valueKey","transitionFactory","hydrateKeyframes","isTransitionDefined","when","delayChildren","staggerChildren","staggerDirection","isKeyframesTarget","getAnimation","valueTransition","getValueTransition","get","isTargetAnimatable","isZero","getZeroUnit","getVelocity","set","inertia","currentAnimation","bounceStiffness","bounceDamping","isOutOfBounds","boundaryNearest","startAnimation","startSpring","prev_1","current_1","boundary_1","heading_1","getFrameData","indexOf","potentialUnitType","delayTimer","controls","getDelayFromTransition","setTimeout","clearTimeout","addUniqueItem","arr","item","removeItem","index","SubscriptionManager","this","subscriptions","add","_this","notify","numSubscriptions","getSize","clear","MotionValue","init","timeDelta","lastUpdated","updateSubscribers","velocityUpdateSubscribers","renderSubscribers","canTrackVelocity","updateAndNotify","render","prev","timestamp","postRender","scheduleVelocityCheck","velocityCheck","hasAnimated","onChange","subscription","clearListeners","onRenderRequest","attach","passiveEffect","getPrevious","Promise","resolve","stopAnimation","then","clearAnimation","isAnimating","destroy","motionValue","PanSession","handlers","transformPagePoint","startEvent","lastMoveEvent","lastMoveEventInfo","updatePoint","info","getPanInfo","history","isPanStarted","isDistancePastThreshold","onStart","onMove","handlePointerMove","transformPoint","buttons","handlePointerUp","end","onEnd","onSessionEnd","panInfo","initialInfo","onSessionStart","removeListeners","updateHandlers","subtractPoint","lastDevicePoint","startDevicePoint","timestampedPoint","lastPoint","time","Infinity","eachAxis","applyConstraints","elastic","calcRelativeAxisConstraints","axis","calcViewportAxisConstraints","layoutAxis","constraintsAxis","resolveAxisElastic","dragElastic","minLabel","maxLabel","resolvePointElastic","label","getBoundingBox","box","getBoundingClientRect","convertBoundingBoxToAxisBox","transformBoundingBox","isNear","maxDistance","calcLength","calcOrigin","source","sourceLength","targetLength","updateAxisDelta","originPoint","translate","updateBoxDelta","defaultOrigin","originX","originY","calcRelativeAxis","relative","parent","calcRelativeBox","projection","parentProjection","relativeTarget","tweenAxis","calcRelativeOffsetAxis","child","calcRelativeOffset","checkIfParentHasChanged","prevId","getLayoutId","nextId","isDraggable","visualElement","getProps","_dragX","resetAxis","originAxis","resetBox","originBox","scalePoint","applyPointDelta","boxScale","applyAxisDelta","applyBoxDelta","applyAxisTransforms","final","transforms","scaleKey","originKey","axisOrigin","xKeys","yKeys","applyBoxTransforms","finalBox","removePointDelta","removeAxisTransforms","removeAxisDelta","removeBoxTransforms","applyTreeDeltas","treeScale","treePath","treeLength","node","getLayoutState","getLatestValues","lastPointerEvent","elementDragControls","WeakMap","VisualElementDragControls","isDragging","currentDirection","constraints","axisBox","props","hasMutatedConstraints","cursorProgress","openGlobalLock","panSession","enableLayoutProjection","originEvent","snapToCursor","stopMotion","initialPoint","getViewportPointFromEvent","cancelLayout","batchLayout","read","write","ancestors","collectProjectingAncestors","children","collectProjectingChildren","tree","hasManuallySetCursorOrigin","isLayoutDrag","lockProjectionTarget","forEach","resetTransform","updateLayoutMeasurement","restoreTransform","getAxisMotionValue","isExternalDrag","rebaseProjectionTarget","measureViewportBox","scheduleUpdateLayoutProjection","axisValue","flushSync","preRender","resolveDragConstraints","dragPropagation","onDragStart","animationState","setActive","Drag","dragDirectionLock","getCurrentDirection","lockThreshold","direction","onDirectionLock","updateAxis","onDrag","dragConstraints","layout","layoutCorrected","isRefObject","resolveRefConstraints","calcRelativeConstraints","layoutBox","top","left","bottom","right","resolveDragElastic","rebaseAxisConstraints","relativeConstraints","onMeasureDragConstraints","constraintsElement","constraintsBox","measuredConstraints","calcViewportConstraints","userConstraints","convertAxisBoxToBoundingBox","cancelDrag","unlockProjectionTarget","animateDragEnd","onDragEnd","shouldDrag","length_1","center","includes","updateAxisMotionValue","updateVisualElementAxis","nextValue","axisLayout","axisLength","axisProgress","calcConstrainedMinPoint","setProjectionTargetAxis","setProps","dragMomentum","remainingProps","layoutId","dragKey","toUpperCase","getValue","_dragY","dragTransition","isRelative","convertToRelativeProjection","projectionParent","getProjectionParent","relativeConstraints_1","targetFinal","momentumAnimations","startAxisValueAnimation","startLayoutAnimation","all","onDragTransitionEnd","stopLayoutAnimation","currentValue","boxProgress","updateConstraints","calcPositionFromProgress","flushLayout","onReady","mount","stopPointerListener","getInstance","dragListener","stopResizeListener","stopLayoutUpdateListener","onLayoutUpdate","prevDragCursor"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57]}