import{o as e,u as t,a as s,as as r,at as a,au as i,r as d,Z as l,d as o,j as n,h as c,H as m,I as g,B as u}from"./index.mlCxaiYE.js";import{u as p}from"./index.esm.XsAbwjVB.js";import{S as h}from"./Scene.tZk0YIWv.js";import{S as f}from"./SettingRow.96ERny3f.js";const b=e((function SelfHosted(){const{integrations:e}=t(),{t:b}=s(),S=r(e.orderedData,{type:a.Embed,service:i.Diagrams}),w=r(e.orderedData,{type:a.Embed,service:i.Grist}),{register:U,reset:y,handleSubmit:v,formState:I}=p({mode:"all",defaultValues:{drawIoUrl:S?.settings.url,gristUrl:w?.settings.url}});d.useEffect((()=>{e.fetchPage({type:a.Embed})}),[e]),d.useEffect((()=>{y({drawIoUrl:S?.settings.url,gristUrl:w?.settings.url})}),[S,w,y]);const E=d.useCallback((async t=>{try{t.drawIoUrl?await e.save({id:S?.id,type:a.Embed,service:i.Diagrams,settings:{url:t.drawIoUrl}}):await(S?.delete()),t.gristUrl?await e.save({id:w?.id,type:a.Embed,service:i.Grist,settings:{url:t.gristUrl}}):await(w?.delete()),l.success(b("Settings saved"))}catch(s){l.error(s.message)}}),[e,S,w,b]);return o(h,{title:b("Self Hosted"),icon:n(c.BuildingBlocksIcon,{}),children:[n(m,{children:b("Self Hosted")}),o("form",{onSubmit:v(E),children:[n(f,{label:b("Draw.io deployment"),name:"drawIoUrl",description:b("Add your self-hosted draw.io installation url here to enable automatic embedding of diagrams within documents."),border:!1,children:n(g,{placeholder:"https://app.diagrams.net/",pattern:"https?://.*",...U("drawIoUrl")})}),n(f,{label:b("Grist deployment"),name:"gristUrl",description:b("Add your self-hosted grist installation URL here."),border:!1,children:n(g,{placeholder:"https://docs.getgrist.com/",pattern:"https?://.*",...U("gristUrl")})}),n(u,{type:"submit",disabled:I.isSubmitting,children:I.isSubmitting?`${b("Saving")}â€¦`:b("Save")})]})]})}));export{b as default};
