import{ck as e,aM as n,cl as t,cm as a,cn as o,n as i,b as s,j as r,a0 as l,a1 as c,C as d,A as u,a5 as m,bj as h,bi as p,F as g,ah as f,a as k,r as y,d as v,z as b,b4 as j,co as C,bk as w,cp as x}from"./index.mlCxaiYE.js";import{F as S,G as T,b as E,M as F,H as q,I,J as A,K as M}from"./DocumentContext.hhTeDqBR.js";import{E as O}from"./Emoji.r_ABO2XC.js";import{e as P,f as z}from"./InputSelectPermission.lb2lIKIy.js";var R=(e=>(e.All="All",e.Frequent="Frequent",e.Search="Search",e))(R||{});const D={All:e.t("All"),Frequent:e.t("Frequently Used"),Search:e.t("Search Results"),People:e.t("Smileys & People"),Nature:e.t("Animals & Nature"),Foods:e.t("Food & Drink"),Activity:e.t("Activity"),Places:e.t("Travel & Places"),Objects:e.t("Objects"),Symbols:e.t("Symbols"),Flags:e.t("Flags")},G={Get:24,Track:30},$="icon-state",B="icons-freq",_="emojis-freq",N="last-icon",W="last-emoji",getStorageKey=e=>`${$}.${e}`,H=getStorageKey("emoji-skintone"),J=getStorageKey(B),K=getStorageKey(_),Q=getStorageKey(N),U=getStorageKey(W),sortFrequencies=e=>e.sort(((e,n)=>e[1]>=n[1]?-1:1));var V=t,L=a,X=o,Y=Math.ceil,Z=Math.max;const ee=n((function chunk(e,n,t){n=(t?L(e,n,t):void 0===n)?1:Z(X(n),0);var a=null==e?0:e.length;if(!a||n<1)return[];for(var o=0,i=0,s=Array(Y(a/n));o<a;)s[i++]=V(e,o,o+=n);return s})),Row=({index:e,style:n,data:t})=>{const{data:a,columns:o}=t,i=a[e];return r(te,{style:n,columns:o,children:i})},ne=i(S).withConfig({componentId:"sc-2w90cn-0"})(["padding:0px 12px;overflow-x:hidden !important;& > div{position:relative;}"]),te=i.div.withConfig({componentId:"sc-2w90cn-1"})(["display:grid;grid-template-columns:",";align-content:center;"],(({columns:e})=>`repeat(${e}, 1fr)`)),ae=s.forwardRef((({width:e,height:n,data:t,columns:a,itemWidth:o},i)=>r(ne,{outerRef:i,width:e,height:n,itemCount:t.length,itemSize:o,itemData:{data:t,columns:a},children:Row}))),oe=i(l).withConfig({componentId:"sc-168pamw-0"})(["width:32px;height:32px;padding:4px;&:","{background:",";}"],c,d("listItemHoverBackground")),ie=i(u).withConfig({componentId:"sc-1rh0iz1-0"})(["grid-column:1 / -1;padding-left:6px;"]),se=i.svg.withConfig({componentId:"sc-1rh0iz1-1"})(["transition:color 150ms ease-in-out,fill 150ms ease-in-out;transition-delay:var(--delay);"]),re=s.forwardRef((({width:e,height:n,data:t,onIconSelect:a},o)=>{const i=Math.floor((e-24)/32),s=m(t.flatMap((e=>{if(0===e.icons.length)return[];const n=r(ie,{type:"tertiary",size:"xsmall",weight:"bold",children:D[e.category]},e.category),t=e.icons.map((e=>e.type===h.SVG?r(oe,{onClick:()=>a({id:e.name,value:e.name}),style:{"--delay":`${e.delay}ms`},children:r(se,{as:p.getComponent(e.name),color:e.color,children:e.initial})},e.name):r(oe,{onClick:()=>a({id:e.id,value:e.value}),children:r(O,{width:24,height:24,children:e.value})},e.id)));return[[n],...ee(t,i)]})));return r(ae,{ref:o,width:e,height:n,data:s,columns:i,itemWidth:32})})),SkinTonePicker=({skinTone:e,onChange:n})=>{const{t:t}=k(),a=s.useMemo((()=>T({id:"hand"})),[]),o=E({placement:"bottom-end"}),i=s.useCallback((e=>{o.hide(),n(e)}),[o,n]),l=s.useMemo((()=>Object.entries(a).map((([e,n])=>y.createElement(P,{...o,key:n.value},(t=>r(oe,{...t,onClick:()=>i(e),children:r(O,{width:24,height:24,children:n.value})})))))),[o,a,i]);return v(b,{children:[r(F,{...o,children:n=>r(ce,{...n,"aria-label":t("Choose default skin tone"),children:a[e].value})}),r(z,{...o,"aria-label":t("Choose default skin tone"),children:e=>r(le,{...e,children:l})})]})},le=i(g).withConfig({componentId:"sc-1wt2m05-0"})(["z-index:",";padding:4px;border-radius:4px;background:",";box-shadow:",";"],f.menu,d("menuBackground"),d("menuShadow")),ce=i(l).withConfig({componentId:"sc-1wt2m05-1"})(["width:32px;height:32px;border:1px solid ",";padding:4px;&:","{border:1px solid ",";}"],d("inputBorder"),c,d("inputBorderFocused")),EmojiPanel=({panelWidth:e,query:n,panelActive:t,onEmojiChange:a,onQueryChange:o,height:i=410})=>{const{t:l}=k(),c=s.useRef(null),d=s.useRef(null),{emojiSkinTone:u,setEmojiSkinTone:m,incrementEmojiCount:h,getFreqEmojis:p}=(()=>{const[e,n]=w(H,x.Default),[t,a]=w(K,{}),[o,i]=w(U,void 0);return{emojiSkinTone:e,setEmojiSkinTone:n,incrementEmojiCount:s.useCallback((e=>{t[e]=(t[e]??0)+1,a({...t}),i(e)}),[t,a,i]),getFreqEmojis:s.useCallback((()=>{const e=Object.entries(t);e.length>G.Track&&(sortFrequencies(e).splice(G.Track),a(Object.fromEntries(e)));const n=sortFrequencies(e).slice(0,G.Get).map((([e,n])=>e)),i=n.includes(o??"");return o&&!i&&(n.pop(),n.push(o)),n}),[t,a,o])}})(),f=s.useMemo((()=>p()),[p]),y=s.useCallback((e=>{o(e.target.value)}),[o]),b=s.useCallback((e=>{m(e)}),[m]),j=s.useCallback((({id:e,value:n})=>{a(n),h(e)}),[a,h]),C=""!==n?getSearchResults({query:n,skinTone:u}):getAllEmojis({skinTone:u,freqEmojis:f});return s.useEffect((()=>{d.current&&(d.current.scrollTop=0),c.current?.focus()}),[t]),v(g,{column:!0,children:[v(de,{align:"center",gap:12,children:[r(ue,{ref:c,value:n,placeholder:`${l("Search emoji")}â€¦`,onChange:y}),r(SkinTonePicker,{skinTone:u,onChange:b})]}),r(re,{ref:d,width:e,height:i-48,data:C,onIconSelect:j})]})},getSearchResults=({query:e,skinTone:n})=>{const t=q({query:e,skinTone:n});return[{category:R.Search,icons:t.map((e=>({type:h.Emoji,id:e.id,value:e.value})))}]},getAllEmojis=({skinTone:e,freqEmojis:n})=>{const t=I({skinTone:e}),getCategoryData=e=>({category:e,icons:(t[e]??[]).map((e=>({type:h.Emoji,id:e.id,value:e.value})))});return A((()=>{const t=M({ids:n,skinTone:e});return{category:R.Frequent,icons:t.map((e=>({type:h.Emoji,id:e.id,value:e.value})))}})(),getCategoryData(C.People),getCategoryData(C.Nature),getCategoryData(C.Foods),getCategoryData(C.Activity),getCategoryData(C.Places),getCategoryData(C.Objects),getCategoryData(C.Symbols),getCategoryData(C.Flags))},de=i(g).withConfig({componentId:"sc-11su3tn-0"})(["height:48px;padding:6px 12px 0px;"]),ue=i(j).withConfig({componentId:"sc-11su3tn-1"})(["flex-grow:1;"]),me=Object.freeze(Object.defineProperty({__proto__:null,default:EmojiPanel},Symbol.toStringTag,{value:"Module"}));export{R as D,EmojiPanel as E,G as F,re as G,me as a,J as i,Q as l,sortFrequencies as s};
