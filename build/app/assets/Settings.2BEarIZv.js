import{b6 as e,q as t,a as i,j as r,B as n,b7 as s,o as a,u as o,w as c,e as l,r as u,au as d,d as h,H as m,am as p,z as b,A as g,F as f,h as H}from"./index.mlCxaiYE.js";import{L as G,C as w}from"./List.EsUl4VzT.js";import{T,a as U}from"./TeamLogo.qV1feKYB.js";import{L as _}from"./Item.dGEOVRdT.js";import{N as v}from"./Notice.4wB6_cwE.js";import{P as j}from"./PlaceholderText.UNfhMHoO.js";import{S as y}from"./Scene.tZk0YIWv.js";import{T as C}from"./Time.rp9cc_zo.js";import{I}from"./index.HcJMMie_.js";import{u as A}from"./useCurrentTeam.fRZpnoZU.js";import{i as B}from"./routeHelpers.MPg4vHxP.js";import"./useBoolean.4JQO1FDN.js";const P=class _GitHubUtils{static get url(){return B("github")}static errorUrl(e){return`${this.url}?error=${e}`}static callbackUrl({baseUrl:t,params:i}={baseUrl:`${e.URL}`,params:void 0}){return i?`${t}/api/github.callback?${i}`:`${t}/api/github.callback`}static authUrl(i){const r=`https://github.com/apps/${e.GITHUB_APP_NAME}/installations/new`,n={client_id:this.clientId,redirect_uri:this.callbackUrl(),state:i};return`${r}?${t.stringify(n)}`}static installRequestUrl(){return`${this.url}?install_request=true`}static getColorForStatus(e){switch(e){case"open":return"#238636";case"done":return"#a371f7";case"closed":return"#f85149";case"merged":return"#8250df";default:return"#848d97"}}};P.clientId=e.GITHUB_CLIENT_ID;let $=P;function GitHubConnectButton(e){const{t:t}=i(),a=A();return r(n,{onClick:()=>s($.authUrl(a.id)),neutral:!0,...e,children:t("Connect")})}const k=a((function GitHub(){const{integrations:e}=o(),{t:t}=i(),n=c(),s=n.get("error"),a=n.get("install_request"),A=l.APP_NAME,B=l.GITHUB_APP_NAME;return u.useEffect((()=>{e.fetchAll({service:d.GitHub,withRelations:!0})}),[e]),h(y,{title:"GitHub",icon:r(I,{}),children:[r(m,{children:"GitHub"}),"access_denied"===s&&r(v,{children:h(p,{children:["Whoops, you need to accept the permissions in GitHub to connect"," ",{appName:A}," to your workspace. Try again?"]})}),"unauthenticated"===s&&r(v,{children:r(p,{children:"Something went wrong while authenticating your request. Please try logging in again."})}),"true"===a&&r(v,{children:h(p,{children:["The owner of GitHub account has been requested to install the"," ",{githubAppName:B}," GitHub app. Once approved, previews will be shown for respective links."]})}),l.GITHUB_CLIENT_ID?h(b,{children:[r(g,{as:"p",children:h(p,{children:["Enable previews of GitHub issues and pull requests in documents by connecting a GitHub organization or specific repositories to"," ",A,"."]})}),e.github.length?h(b,{children:[r(m,{as:"h2",children:h(f,{justify:"space-between",auto:!0,children:[t("Connected"),r(GitHubConnectButton,{icon:r(H.PlusIcon,{})})]})}),r(G,{children:e.github.map((e=>{const i=e.settings?.github?.installation.account,n=e.user?e.user.name:void 0;return r(_,{small:!0,title:i?.name,subtitle:n?h(b,{children:[h(p,{children:["Enabled by ",{integrationCreatedBy:n}]})," ","Â·"," ",r(C,{dateTime:e.createdAt,relative:!1,format:{en_US:"MMMM d, y"}})]}):r(j,{}),image:r(T,{src:i?.avatarUrl,size:U.Large}),actions:r(w,{onClick:e.delete,confirmationMessage:t("Disconnecting will prevent previewing GitHub links from this organization in documents. Are you sure?")})},i?.id)}))})]}):r("p",{children:r(GitHubConnectButton,{icon:r(I,{})})})]}):r(v,{children:r(p,{children:"The GitHub integration is currently disabled. Please set the associated environment variables and restart the server to enable the integration."})})]})}));export{k as default};
