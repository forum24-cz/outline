import{bY as e,r as t,aw as i,aM as n,bZ as s,n as b,F as w,C as x,B as C,x as O,b_ as M,b$ as j,c0 as P,j as I,c1 as R,d as k,c2 as U,o as S,a as D}from"./index.mlCxaiYE.js";import{a as T,A}from"./TeamLogo.qV1feKYB.js";import{f as E}from"./authenticated.03alztlO.js";import{L as B}from"./LoadingIndicatorBar.mGaD64ZX.js";import{w as L}from"./Badge.sHfYRIgC.js";var z={exports:{}};const _=n(z.exports=function(e,t){function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=o(e),n=o(t);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s2(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function a(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)),n}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){s2(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(null==e)return{};var i,n=function(e,t){if(null==e)return{};for(var i,n={},s=Object.keys(e),b=0;b<s.length;b++)i=s[b],0<=t.indexOf(i)||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols)for(var s=Object.getOwnPropertySymbols(e),b=0;b<s.length;b++)i=s[b],0<=t.indexOf(i)||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i]);return n}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n,s=h(e);return!(n=t?(i=h(this).constructor,Reflect.construct(s,arguments,i)):s.apply(this,arguments))||"object"!=typeof n&&"function"!=typeof n?d(this):n}}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,s=!1,b=void 0;try{for(var w,x=e[Symbol.iterator]();!(n=(w=x.next()).done)&&(i.push(w.value),!t||i.length!==t);n=!0);}catch(C){s=!0,b=C}finally{try{n||null==x.return||x.return()}finally{if(s)throw b}}return i}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(e,t){return new Promise((function(i,n){var s,b=new Image;b.onload=function(){return i(b)},b.onerror=n,0==(null!==(s=e)&&!!s.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&t&&(b.crossOrigin=t),b.src=e}))}var s,b=!("undefined"==typeof window||"undefined"==typeof navigator||!("ontouchstart"in window||0<navigator.msMaxTouchPoints)),w="undefined"!=typeof File,x={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},C=b?x.touch:x.desktop,O="undefined"!=typeof window&&window.devicePixelRatio?window.devicePixelRatio:1,M={x:.5,y:.5},j=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a2,n.default.Component);var e,t=p(a2);function a2(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a2),s2(d(i=t.call(this,e)),"state",{drag:!1,my:null,mx:null,image:M}),s2(d(i),"handleImageReady",(function(e){var t=i.getInitialSize(e.width,e.height);t.resource=e,t.x=.5,t.y=.5,t.backgroundColor=i.props.backgroundColor,i.setState({drag:!1,image:t},i.props.onImageReady),i.props.onLoadSuccess(t)})),s2(d(i),"clearImage",(function(){i.canvas.getContext("2d").clearRect(0,0,i.canvas.width,i.canvas.height),i.setState({image:M})})),s2(d(i),"handleMouseDown",(function(e){(e=e||window.event).preventDefault(),i.setState({drag:!0,mx:null,my:null})})),s2(d(i),"handleMouseUp",(function(){i.state.drag&&(i.setState({drag:!1}),i.props.onMouseUp())})),s2(d(i),"handleMouseMove",(function(e){var t,n,s,b,w,x,C,O,M,j,P,I,R,k,U,S;e=e||window.event,!1!==i.state.drag&&(e.preventDefault(),s={mx:t=e.targetTouches?e.targetTouches[0].pageX:e.clientX,my:n=e.targetTouches?e.targetTouches[0].pageY:e.clientY},S=i.props.rotate,S=(S%=360)<0?S+360:S,i.state.mx&&i.state.my&&(b=i.state.mx-t,w=i.state.my-n,x=i.state.image.width*i.props.scale,C=i.state.image.height*i.props.scale,M=(O=i.getCroppingRect()).x,j=O.y,M*=x,j*=C,P=function(e){return e*(Math.PI/180)},I=Math.cos(P(S)),k=j+-b*(R=Math.sin(P(S)))+w*I,U={x:(M+b*I+w*R)/x+1/i.props.scale*i.getXScale()/2,y:k/C+1/i.props.scale*i.getYScale()/2},i.props.onPositionChange(U),s.image=y(y({},i.state.image),U)),i.setState(s),i.props.onMouseMove(e))})),s2(d(i),"setCanvas",(function(e){i.canvas=e})),i.canvas=null,i}return(e=[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(O=1);var e,t,i=this.canvas.getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint(i),document&&(e=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(i){e=!1}return e}()&&{passive:!1},t=C.native,document.addEventListener(t.move,this.handleMouseMove,e),document.addEventListener(t.up,this.handleMouseUp,e),b&&(document.addEventListener(t.mouseMove,this.handleMouseMove,e),document.addEventListener(t.mouseUp,this.handleMouseUp,e)))}},{key:"componentDidUpdate",value:function(e,t){this.props.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height||this.props.backgroundColor!==e.backgroundColor?this.loadImage(this.props.image):this.props.image||t.image===M||this.clearImage();var i=this.canvas.getContext("2d");i.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint(i),this.paintImage(i,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y&&t.backgroundColor===this.state.backgroundColor||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){var e;document&&(e=C.native,document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),b&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1)))}},{key:"isVertical",value:function(){return!this.props.disableCanvasRotation&&this.props.rotate%180!=0}},{key:"getBorders",value:function(e){var t=0<arguments.length&&void 0!==e?e:this.props.border;return Array.isArray(t)?t:[t,t]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,i=e.height,n=e.rotate,s=e.border,b={},w=m(this.getBorders(s),2),x=w[0],C=w[1],O=t,M=i;return this.isVertical()?(b.width=M,b.height=O):(b.width=O,b.height=M),b.width+=2*x,b.height+=2*C,{canvas:b,rotate:n,width:t,height:i,border:s}}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var i=document.createElement("canvas");this.isVertical()?(i.width=e.height,i.height=e.width):(i.width=e.width,i.height=e.height);var n=i.getContext("2d");return n.translate(i.width/2,i.height/2),n.rotate(this.props.rotate*Math.PI/180),n.translate(-i.width/2,-i.height/2),this.isVertical()&&n.translate((i.width-i.height)/2,(i.height-i.width)/2),t.backgroundColor&&(n.fillStyle=t.backgroundColor,n.fillRect(-e.x,-e.y,t.resource.width,t.resource.height)),n.drawImage(t.resource,-e.x,-e.y),i}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,i=e.height,n=document.createElement("canvas");return this.isVertical()?(n.width=i,n.height=t):(n.width=t,n.height=i),this.paintImage(n.getContext("2d"),this.state.image,0,1),n}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),i=1/this.props.scale*this.getYScale(),n={x:e.x-t/2,y:e.y-i/2,width:t,height:i},s=0,b=1-n.width,w=0,x=1-n.height;return(this.props.disableBoundaryChecks||1<t||1<i)&&(s=-n.width,w=-n.height,x=b=1),y(y({},n),{},{x:Math.max(s,Math.min(n.x,b)),y:Math.max(w,Math.min(n.y,x))})}},{key:"loadImage",value:function(e){var t;w&&e instanceof File?this.loadingImage=(t=e,new Promise((function(e,i){var n=new FileReader;n.onload=function(t){try{var n=v(t.target.result);e(n)}catch(s){i(s)}},n.readAsDataURL(t)})).then(this.handleImageReady).catch(this.props.onLoadFailure)):"string"==typeof e&&(this.loadingImage=v(e,this.props.crossOrigin).then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(e,t){var i,n,s=this.getDimensions();return t/e<s.height/s.width?n=e*((i=this.getDimensions().height)/t):i=t*((n=this.getDimensions().width)/e),{height:i,width:n}}},{key:"paintImage",value:function(e,t,i,n){var s,b=3<arguments.length&&void 0!==n?n:O;t.resource&&(s=this.calculatePosition(t,i),e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(b,b),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,s.x,s.y,s.width,s.height),t.backgroundColor&&(e.fillStyle=t.backgroundColor,e.fillRect(s.x,s.y,s.width,s.height)),e.restore())}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var i=m(this.getBorders(t),2),n=i[0],s=i[1],b=this.getCroppingRect(),w=e.width*this.props.scale,x=e.height*this.props.scale,C=-b.x*w,O=-b.y*x;return this.isVertical()?(C+=s,O+=n):(C+=n,O+=s),{x:C,y:O,height:x,width:w}}},{key:"paint",value:function(e){e.save(),e.scale(O,O),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t,i,n,s,b,w,x,C,M=this.props.borderRadius,j=this.getDimensions(),P=m(this.getBorders(j.border),2),I=P[0],R=P[1],k=j.canvas.height,U=j.canvas.width;M=Math.max(M,0),M=Math.min(M,U/2-I,k/2-R),e.beginPath(),t=e,s=U-2*(i=I),b=k-2*(n=R),0===(w=M)?t.rect(i,n,s,b):(x=s-w,C=b-w,t.translate(i,n),t.arc(w,w,w,Math.PI,1.5*Math.PI),t.lineTo(x,0),t.arc(x,w,w,1.5*Math.PI,2*Math.PI),t.lineTo(s,C),t.arc(x,C,w,2*Math.PI,.5*Math.PI),t.lineTo(w,b),t.arc(w,C,w,.5*Math.PI,Math.PI),t.translate(-i,-n)),e.rect(U,0,-U,k),e.fill("evenodd"),e.restore()}},{key:"render",value:function(){var e=this.props,t=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.backgroundColor,e.style),i=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,e.disableCanvasRotation,l(e,["scale","rotate","image","border","borderRadius","width","height","position","color","backgroundColor","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling","disableCanvasRotation"])),s=this.getDimensions(),w={width:s.canvas.width,height:s.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},x={width:s.canvas.width*O,height:s.canvas.height*O,style:y(y({},w),t)};return x[C.react.down]=this.handleMouseDown,b&&(x[C.react.mouseDown]=this.handleMouseDown),n.default.createElement("canvas",u({ref:this.setCanvas},x,i))}}])&&r(a2.prototype,e),a2}();return s2(j,"propTypes",{scale:i.default.number,rotate:i.default.number,image:i.default.oneOfType([i.default.string].concat(function(e){if(Array.isArray(e))return f(e)}(s=w?[i.default.instanceOf(File)]:[])||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(s)||g(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),border:i.default.oneOfType([i.default.number,i.default.arrayOf(i.default.number)]),borderRadius:i.default.number,width:i.default.number,height:i.default.number,position:i.default.shape({x:i.default.number,y:i.default.number}),color:i.default.arrayOf(i.default.number),backgroundColor:i.default.string,crossOrigin:i.default.oneOf(["","anonymous","use-credentials"]),onLoadFailure:i.default.func,onLoadSuccess:i.default.func,onImageReady:i.default.func,onImageChange:i.default.func,onMouseUp:i.default.func,onMouseMove:i.default.func,onPositionChange:i.default.func,disableBoundaryChecks:i.default.bool,disableHiDPIScaling:i.default.bool,disableCanvasRotation:i.default.bool}),s2(j,"defaultProps",{scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1,disableCanvasRotation:!0}),j}(e,t));
/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _defineProperty(e,t,i){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_extends.apply(this,arguments)}function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var F,H,W,V,$,K,Y,X,q={exports:{}};F=q,"undefined"!=typeof window&&(H=window,W=H.HTMLCanvasElement&&H.HTMLCanvasElement.prototype,V=H.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),$=V&&H.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),K=H.BlobBuilder||H.WebKitBlobBuilder||H.MozBlobBuilder||H.MSBlobBuilder,Y=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,X=(V||K)&&H.atob&&H.ArrayBuffer&&H.Uint8Array&&function(e){var t,i,n,s,b,w,x,C,O;if(!(t=e.match(Y)))throw new Error("invalid data URI");for(i=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),n=!!t[4],s=e.slice(t[0].length),b=n?atob(s):decodeURIComponent(s),w=new ArrayBuffer(b.length),x=new Uint8Array(w),C=0;C<b.length;C+=1)x[C]=b.charCodeAt(C);return V?new Blob([$?x:w],{type:i}):((O=new K).append(w),O.getBlob(i))},H.HTMLCanvasElement&&!W.toBlob&&(W.mozGetAsFile?W.toBlob=function(e,t,i){var n=this;setTimeout((function(){i&&W.toDataURL&&X?e(X(n.toDataURL(t,i))):e(n.mozGetAsFile("blob",t))}))}:W.toDataURL&&X&&(W.msToBlob?W.toBlob=function(e,t,i){var n=this;setTimeout((function(){(t&&"image/png"!==t||i)&&W.toDataURL&&X?e(X(n.toDataURL(t,i))):e(n.msToBlob(t))}))}:W.toBlob=function(e,t,i){var n=this;setTimeout((function(){e(X(n.toDataURL(t,i)))}))})),F.exports?F.exports=X:H.dataURLtoBlob=X);var N=q.exports,G={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Z="undefined"!=typeof window&&void 0!==window.document?window:{},J=function isPositiveNumber2(e){return e>0&&e<1/0},Q=Array.prototype.slice;function toArray(e){return Array.from?Array.from(e):Q.call(e)}var ee=/^image\/.+$/;function isImageType(e){return ee.test(e)}var te=String.fromCharCode;var re=Z.btoa;function arrayBufferToDataURL(e,t){for(var i=[],n=new Uint8Array(e);n.length>0;)i.push(te.apply(null,toArray(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(t,";base64,").concat(re(i.join("")))}function resetAndGetOrientation(e){var t,i=new DataView(e);try{var n,s,b;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var w=i.byteLength,x=2;x+1<w;){if(255===i.getUint8(x)&&225===i.getUint8(x+1)){s=x;break}x+=1}if(s){var C=s+10;if("Exif"===function getStringFromCharCode(e,t,i){var n,s="";for(i+=t,n=t;n<i;n+=1)s+=te(e.getUint8(n));return s}(i,s+4,4)){var O=i.getUint16(C);if(((n=18761===O)||19789===O)&&42===i.getUint16(C+2,n)){var M=i.getUint32(C+4,n);M>=8&&(b=C+M)}}}if(b){var j,P,I=i.getUint16(b,n);for(P=0;P<I;P+=1)if(j=b+12*P+2,274===i.getUint16(j,n)){j+=8,t=i.getUint16(j,n),i.setUint16(j,1,n);break}}}catch(R){t=1}return t}var oe=/\.\d*(?:0|9){12}\d*$/;function normalizeDecimalNumber(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return oe.test(e)?Math.round(e*t)/t:e}function getAdjustedSizes(e){var t=e.aspectRatio,i=e.height,n=e.width,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",b=J(n),w=J(i);if(b&&w){var x=i*t;("contain"===s||"none"===s)&&x>n||"cover"===s&&x<n?i=n/t:n=i*t}else b?i=n/t:w&&(n=i*t);return{width:n,height:i}}var ie=Z.ArrayBuffer,ae=Z.FileReader,ne=Z.URL||Z.webkitURL,se=/\.\w+$/,ce=Z.Compressor,he=function(){function Compressor2(e,t){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Compressor2),this.file=e,this.exif=[],this.image=new Image,this.options=_objectSpread2(_objectSpread2({},G),t),this.aborted=!1,this.result=null,this.init()}return function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}(Compressor2,[{key:"init",value:function init(){var e=this,t=this.file,i=this.options;if(function isBlob2(e){return"undefined"!=typeof Blob&&(e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e))}(t)){var n=t.type;if(isImageType(n))if(ne&&ae){ie||(i.checkOrientation=!1,i.retainExif=!1);var s="image/jpeg"===n,b=s&&i.checkOrientation,w=s&&i.retainExif;if(!ne||b||w){var x=new ae;this.reader=x,x.onload=function(i){var s=i.target.result,x={},C=1;b&&(C=resetAndGetOrientation(s))>1&&_extends(x,function parseOrientation(e){var t=0,i=1,n=1;switch(e){case 2:i=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:n}}(C)),w&&(e.exif=function getExif(e){for(var t=toArray(new Uint8Array(e)),i=t.length,n=[],s=0;s+3<i;){var b=t[s],w=t[s+1];if(255===b&&218===w)break;if(255===b&&216===w)s+=2;else{var x=s+(256*t[s+2]+t[s+3])+2,C=t.slice(s,x);n.push(C),s=x}}return n.reduce((function(e,t){return 255===t[0]&&225===t[1]?e.concat(t):e}),[])}(s)),x.url=b||w?!ne||C>1?arrayBufferToDataURL(s,n):ne.createObjectURL(t):s,e.load(x)},x.onabort=function(){e.fail(new Error("Aborted to read the image with FileReader."))},x.onerror=function(){e.fail(new Error("Failed to read the image with FileReader."))},x.onloadend=function(){e.reader=null},b||w?x.readAsArrayBuffer(t):x.readAsDataURL(t)}else this.load({url:ne.createObjectURL(t)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function load(e){var t=this,i=this.file,n=this.image;n.onload=function(){t.draw(_objectSpread2(_objectSpread2({},e),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){t.fail(new Error("Aborted to load the image."))},n.onerror=function(){t.fail(new Error("Failed to load the image."))},Z.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Z.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=e.url}},{key:"draw",value:function draw(e){var t=this,i=e.naturalWidth,n=e.naturalHeight,s=e.rotate,b=void 0===s?0:s,w=e.scaleX,x=void 0===w?1:w,C=e.scaleY,O=void 0===C?1:C,M=this.file,j=this.image,P=this.options,I=document.createElement("canvas"),R=I.getContext("2d"),k=Math.abs(b)%180==90,U=("contain"===P.resize||"cover"===P.resize)&&J(P.width)&&J(P.height),S=Math.max(P.maxWidth,0)||1/0,D=Math.max(P.maxHeight,0)||1/0,T=Math.max(P.minWidth,0)||0,A=Math.max(P.minHeight,0)||0,E=i/n,B=P.width,L=P.height;if(k){var z=[D,S];S=z[0],D=z[1];var _=[A,T];T=_[0],A=_[1];var F=[L,B];B=F[0],L=F[1]}U&&(E=B/L);var H=getAdjustedSizes({aspectRatio:E,width:S,height:D},"contain");S=H.width,D=H.height;var W=getAdjustedSizes({aspectRatio:E,width:T,height:A},"cover");if(T=W.width,A=W.height,U){var V=getAdjustedSizes({aspectRatio:E,width:B,height:L},P.resize);B=V.width,L=V.height}else{var $=getAdjustedSizes({aspectRatio:E,width:B,height:L}),K=$.width;B=void 0===K?i:K;var Y=$.height;L=void 0===Y?n:Y}var X=-(B=Math.floor(normalizeDecimalNumber(Math.min(Math.max(B,T),S))))/2,q=-(L=Math.floor(normalizeDecimalNumber(Math.min(Math.max(L,A),D))))/2,G=B,Z=L,Q=[];if(U){var ee,te,re,oe,ie=getAdjustedSizes({aspectRatio:E,width:i,height:n},{contain:"cover",cover:"contain"}[P.resize]);re=ie.width,oe=ie.height,ee=(i-re)/2,te=(n-oe)/2,Q.push(ee,te,re,oe)}if(Q.push(X,q,G,Z),k){var ne=[L,B];B=ne[0],L=ne[1]}I.width=B,I.height=L,isImageType(P.mimeType)||(P.mimeType=M.type);var se="transparent";M.size>P.convertSize&&P.convertTypes.indexOf(P.mimeType)>=0&&(P.mimeType="image/jpeg");var ce="image/jpeg"===P.mimeType;if(ce&&(se="#fff"),R.fillStyle=se,R.fillRect(0,0,B,L),P.beforeDraw&&P.beforeDraw.call(this,R,I),!this.aborted&&(R.save(),R.translate(B/2,L/2),R.rotate(b*Math.PI/180),R.scale(x,O),R.drawImage.apply(R,[j].concat(Q)),R.restore(),P.drew&&P.drew.call(this,R,I),!this.aborted)){var he=function callback2(e){if(!t.aborted){var s=function done2(e){return t.done({naturalWidth:i,naturalHeight:n,result:e})};if(e&&ce&&P.retainExif&&t.exif&&t.exif.length>0){var b=function next2(e){return s(N(arrayBufferToDataURL(function insertExif(e,t){var i=toArray(new Uint8Array(e));if(255!==i[2]||224!==i[3])return e;var n=256*i[4]+i[5],s=[255,216].concat(t,i.slice(4+n));return new Uint8Array(s)}(e,t.exif),P.mimeType)))};if(e.arrayBuffer)e.arrayBuffer().then(b).catch((function(){t.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))}));else{var w=new ae;t.reader=w,w.onload=function(e){var t=e.target;b(t.result)},w.onabort=function(){t.fail(new Error("Aborted to read the compressed image with FileReader."))},w.onerror=function(){t.fail(new Error("Failed to read the compressed image with FileReader."))},w.onloadend=function(){t.reader=null},w.readAsArrayBuffer(e)}}else s(e)}};I.toBlob?I.toBlob(he,P.mimeType,P.quality):he(N(I.toDataURL(P.mimeType,P.quality)))}}},{key:"done",value:function done(e){var t=e.naturalWidth,i=e.naturalHeight,n=e.result,s=this.file,b=this.image,w=this.options;if(ne&&0===b.src.indexOf("blob:")&&ne.revokeObjectURL(b.src),n)if(w.strict&&!w.retainExif&&n.size>s.size&&w.mimeType===s.type&&!(w.width>t||w.height>i||w.minWidth>t||w.minHeight>i||w.maxWidth<t||w.maxHeight<i))n=s;else{var x=new Date;n.lastModified=x.getTime(),n.lastModifiedDate=x,n.name=s.name,n.name&&n.type!==s.type&&(n.name=n.name.replace(se,function imageTypeToExtension(e){var t=isImageType(e)?e.substr(6):"";return"jpeg"===t&&(t="jpg"),".".concat(t)}(n.type)))}else n=s;this.result=n,w.success&&w.success.call(this,n)}},{key:"fail",value:function fail(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function abort(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function noConflict(){return window.Compressor=ce,Compressor2}},{key:"setDefaults",value:function setDefaults(e){_extends(G,e)}}]),Compressor2}();var ue=Object.defineProperty,le=Object.getOwnPropertyDescriptor,__decorateClass=(e,t,i,n)=>{for(var s,b=n>1?void 0:n?le(t,i):t,w=e.length-1;w>=0;w--)(s=e[w])&&(b=(n?s(t,i,b):s(b))||b);return n&&b&&ue(t,i,b),b};let de=class extends t.Component{constructor(){super(...arguments),this.isUploading=!1,this.isCropping=!1,this.zoom=1,this.avatarEditorRef=t.createRef(),this.onDropAccepted=async e=>{this.isCropping=!0,this.file=e[0]},this.handleCrop=()=>{this.isUploading=!0,setTimeout(this.uploadImage,0)},this.uploadImage=async()=>{const e=this.avatarEditorRef.current?.getImage();O(e,"canvas is not defined");const t=M(e.toDataURL());try{const e=await(async(e,t)=>new Promise(((i,n)=>{new he(e,{...t,success:i,error:n})})))(t,{maxHeight:512,maxWidth:512}),i=await P(e,{name:this.file.name,preset:j.Avatar});this.props.onSuccess(i.url)}catch(i){this.props.onError(i.message)}finally{this.isUploading=!1,this.isCropping=!1}},this.handleClose=()=>{this.isUploading=!1,this.isCropping=!1},this.handleZoom=e=>{const t=e.target;t instanceof HTMLInputElement&&(this.zoom=parseFloat(t.value))}}renderCropping(){const{ui:e,submitText:t}=this.props;return I(R,{isOpen:!0,onRequestClose:this.handleClose,title:"",children:k(w,{auto:!0,column:!0,align:"center",justify:"center",children:[this.isUploading&&I(B,{}),I(pe,{children:I(_,{ref:this.avatarEditorRef,image:this.file,width:250,height:250,border:25,borderRadius:this.props.borderRadius,color:"light"===e.theme?[255,255,255,.6]:[0,0,0,.6],scale:this.zoom,rotate:0})}),I(fe,{type:"range",min:"0.1",max:"2",step:"0.01",defaultValue:"1",onChange:this.handleZoom}),I(ge,{onClick:this.handleCrop,disabled:this.isUploading,children:this.isUploading?"Uploading…":t})]})})}render(){return this.isCropping?this.renderCropping():I(E,{accept:U.avatarContentTypes.join(", "),onDropAccepted:this.onDropAccepted,children:({getRootProps:e,getInputProps:t})=>k("div",{...e(),children:[I("input",{...t()}),this.props.children]})})}};de.defaultProps={submitText:"Crop Image",borderRadius:150},__decorateClass([s],de.prototype,"isUploading",2),__decorateClass([s],de.prototype,"isCropping",2),__decorateClass([s],de.prototype,"zoom",2),__decorateClass([s],de.prototype,"file",2),de=__decorateClass([S],de);const pe=b(w).withConfig({componentId:"sc-1yyxgzl-0"})(["margin-bottom:30px;"]),fe=b.input.withConfig({componentId:"sc-1yyxgzl-1"})(["display:block;width:300px;margin-bottom:30px;height:4px;cursor:var(--pointer);color:inherit;border-radius:99999px;background-color:#dee1e3;appearance:none;&::-webkit-slider-thumb{-webkit-appearance:none;height:16px;width:16px;border-radius:50%;background:",";cursor:var(--pointer);}&:focus{outline:none;}"],x("text")),ge=b(C).withConfig({componentId:"sc-1yyxgzl-2"})(["width:300px;"]),me=L(de);function ImageInput({model:e,onSuccess:t,...i}){const{t:n}=D();return k(w,{gap:8,justify:"space-between",children:[I(be,{children:k(me,{onSuccess:t,...i,children:[I(ye,{model:e,size:T.Upload}),I(w,{auto:!0,align:"center",justify:"center",className:"upload",children:n("Upload")})]})}),e.avatarUrl&&I(C,{onClick:()=>t(null),neutral:!0,children:n("Remove")})]})}const ve=`\n  width: ${T.Upload}px;\n  height: ${T.Upload}px;\n`,ye=b(A).withConfig({componentId:"sc-1u4qzse-0"})(["border-radius:8px;"]),be=b(w).withConfig({componentId:"sc-1u4qzse-1"})(["",";position:relative;font-size:14px;border-radius:8px;box-shadow:0 0 0 1px ",";background:",";overflow:hidden;.upload{",";position:absolute;top:0;right:0;bottom:0;left:0;opacity:0;cursor:var(--pointer);transition:all 250ms;}&:hover .upload{opacity:1;background:rgba(0,0,0,0.75);color:",";}"],ve,x("backgroundSecondary"),x("background"),ve,(e=>e.theme.white));export{ImageInput as I};
