import{bb as e,bc as o,bd as t,be as n,n as i,F as a,C as s,a0 as r,a1 as l,j as c,bf as d,b as p,bg as u,d as m,A as h,bh as g,h as b,b4 as f,bi as C,a as x,bj as v,bk as y,r as w,bl as k,ak as j,bm as I,bn as S,z as P,a8 as E,bo as $,a2 as z}from"./index.mlCxaiYE.js";import{P as B}from"./Switch.3DOmHSIs.js";import{u as T,a as V}from"./InputSelectPermission.lb2lIKIy.js";import{D as L,G as O,i as q,l as F,F as H,s as A,E as D}from"./EmojiPanel.TJcM4M0j.js";import{P as G}from"./PopoverButton.AWtPNgE3.js";import{u as N,P as M}from"./PopoverDisclosure.OO70kItq.js";import{T as R,u as Q,a as W,b as U}from"./Emoji.r_ABO2XC.js";import"./DocumentContext.hhTeDqBR.js";import"./PlaceholderText.UNfhMHoO.js";import"./Scene.tZk0YIWv.js";import"./LoadingIndicatorBar.mGaD64ZX.js";import"./TeamLogo.qV1feKYB.js";import"./useBoolean.4JQO1FDN.js";import"./useCurrentUser.zlImhYTS.js";import"./Badge.sHfYRIgC.js";import"./Item.dGEOVRdT.js";import"./Time.rp9cc_zo.js";import"./index.esm.XsAbwjVB.js";import"./useCurrentTeam.fRZpnoZU.js";import"./usePolicy.wYF8wJNp.js";import"./SharedLayoutContext.2BBc39h7.js";var Y=t({as:"div",useHook:e({name:"TabList",compose:T,keys:R,useProps:function useProps(e,t){return o({role:"tablist","aria-orientation":e.orientation},t)}}),useCreateElement:function useCreateElement$1(e,o,t){return n(e,o,t)}});const ColorPicker=({width:e,activeColor:o,onSelect:t})=>{const[n,i]=p.useState(o),[a,s]=p.useState(d.includes(o)?0:1),r=p.useCallback((()=>{s(0===a?1:0)}),[a,s]),l=e>g.mobileLarge+12;return p.useEffect((()=>{i(o),s(d.includes(o)?0:1)}),[o]),m(_,l?{justify:"space-between",children:[c(ee,{activeColor:o,onClick:t}),c(oe,{value:n,setLocalValue:i,onValidHex:t})]}:{gap:12,children:[c(K,{align:"center",children:c(Z,{panel:a,onClick:r,children:0===a?"#":c(b.BackIcon,{})})}),0===a?c(BuiltinColors,{activeColor:o,onClick:t}):c(CustomColor,{value:n,setLocalValue:i,onValidHex:t})]})},BuiltinColors=({activeColor:e,onClick:o,className:t})=>c(a,{className:t,justify:"space-between",align:"center",auto:!0,children:d.map((t=>c(J,{$color:t,$active:t===e,onClick:()=>o(t),children:c(X,{})},t)))}),CustomColor=({value:e,setLocalValue:o,onValidHex:t,className:n})=>{const i=p.useCallback((e=>/(^#[0-9A-F]{1,6}$)/i.test(e)),[]),s=p.useCallback((e=>{const n=e.target.value;if(""===n||"#"===n)return void o("#");const a=n.toUpperCase();i(a)&&o(a),u(a)&&t(a)}),[o,i,t]);return m(a,{className:n,align:"center",gap:8,children:[c(h,{type:"tertiary",size:"small",children:"HEX"}),c(te,{maxLength:7,value:e,onChange:s})]})},_=i(a).withConfig({componentId:"sc-syl46v-0"})(["height:48px;padding:8px 12px;border-bottom:1px solid ",";"],s("inputBorder")),X=i.span.withConfig({componentId:"sc-syl46v-1"})(["width:10px;height:5px;border-left:2px solid white;border-bottom:2px solid white;transform:translateY(-25%) rotate(-45deg);"]),J=i(r).withConfig({componentId:"sc-syl46v-2"})(["display:inline-flex;justify-content:center;align-items:center;width:24px;height:24px;border-radius:50%;background-color:",";&:","{outline:2px solid "," !important;box-shadow:",";}& ","{display:",";}"],(({$color:e})=>e),l,s("menuBackground"),(({$color:e})=>`0px 0px 3px 3px ${e}`),X,(({$active:e})=>e?"block":"none")),K=i(a).withConfig({componentId:"sc-syl46v-3"})(["width:40px;border-right:1px solid ",";"],s("inputBorder")),Z=i(r).withConfig({componentId:"sc-syl46v-4"})(["display:inline-flex;justify-content:center;align-items:center;font-size:14px;border:1px solid ",";transition:all 100ms ease-in-out;&:","{border-color:",";}"],s("inputBorder"),l,s("inputBorderFocused")),ee=i(BuiltinColors).withConfig({componentId:"sc-syl46v-5"})(["max-width:380px;padding-right:8px;"]),oe=i(CustomColor).withConfig({componentId:"sc-syl46v-6"})(["padding-left:8px;border-left:1px solid ",";width:120px;"],s("inputBorder")),te=i.input.attrs((()=>({type:"text",autocomplete:"off"}))).withConfig({componentId:"sc-syl46v-7"})(["font-size:14px;color:",";background:transparent;border:0;outline:0;"],s("textSecondary")),ne=Object.keys(C.mapping).length,IconPanel=({panelWidth:e,initial:o,color:t,query:n,panelActive:i,onIconChange:s,onColorChange:r,onQueryChange:l})=>{const{t:d}=x(),u=p.useRef(null),h=p.useRef(null),{incrementIconCount:g,getFreqIcons:b}=(()=>{const[e,o]=y(q,{}),[t,n]=y(F,void 0);return{incrementIconCount:p.useCallback((t=>{e[t]=(e[t]??0)+1,o({...e}),n(t)}),[e,o,n]),getFreqIcons:p.useCallback((()=>{const n=Object.entries(e);n.length>H.Track&&(A(n).splice(H.Track),o(Object.fromEntries(n)));const i=A(n).slice(0,H.Get).map((([e,o])=>e)),a=i.includes(t??"");return t&&!a&&(i.pop(),i.push(t)),i}),[e,o,t])}})(),f=p.useMemo((()=>b()),[b]),w=f.length,k=p.useMemo((()=>C.findIcons(n)),[n]),j=""!==n,I=j?L.Search:L.All,S=250/(ne+w),P=p.useCallback((e=>{l(e.target.value)}),[l]),E=p.useCallback((({id:e,value:o})=>{s(o),g(e)}),[s,g]),$={category:I,icons:k.map(((e,n)=>({type:v.SVG,name:e,color:t,initial:o,delay:Math.round((n+w)*S),onClick:E})))},z=j?[$]:[{category:L.Frequent,icons:f.map(((e,n)=>({type:v.SVG,name:e,color:t,initial:o,delay:Math.round((n+w)*S),onClick:E})))},$];return p.useEffect((()=>{h.current&&(h.current.scrollTop=0),u.current?.focus()}),[i]),m(a,{column:!0,children:[c(ie,{align:"center",children:c(ae,{ref:u,value:n,placeholder:`${d("Search icons")}â€¦`,onChange:P})}),c(ColorPicker,{width:e,activeColor:t,onSelect:r}),c(O,{ref:h,width:e,height:314,data:z,onIconSelect:E})]})},ie=i(a).withConfig({componentId:"sc-c1zptx-0"})(["height:48px;padding:6px 12px 0px;"]),ae=i(f).withConfig({componentId:"sc-c1zptx-1"})(["flex-grow:1;"]),se="icon",re="emoji",le=i(b.SmileyIcon).withConfig({componentId:"sc-n2vt6v-0"})(["flex-shrink:0;@media print{display:none;}"]),ce=i(r).withConfig({componentId:"sc-n2vt6v-1"})(["width:auto;font-weight:500;font-size:14px;color:",";padding:8px 12px;transition:color 100ms ease-in-out;&:","{color:",";}"],s("textTertiary"),l,s("textSecondary")),de=i(a).withConfig({componentId:"sc-n2vt6v-2"})(["padding-left:12px;border-bottom:1px solid ",";"],s("inputBorder")),pe=i(W).withConfig({componentId:"sc-n2vt6v-3"})(["position:relative;font-weight:500;font-size:14px;cursor:var(--pointer);background:none;border:0;padding:8px 12px;user-select:none;color:",";transition:color 100ms ease-in-out;&:","{color:",";}",""],(({$active:e})=>s(e?"textSecondary":"textTertiary")),l,s("textSecondary"),(({$active:e})=>e&&z(['&:after{content:"";position:absolute;bottom:0;left:0;right:0;height:1px;background:',";}"],s("textSecondary")))),ue=i(U).withConfig({componentId:"sc-n2vt6v-4"})(["height:410px;overflow-y:auto;"]),me=w.memo((({icon:e,color:o,size:t=24,initial:n,className:i,popoverPosition:a,allowDelete:s,onChange:r,onOpen:l,onClose:d,borderOnHover:p})=>{const{t:u}=x(),{width:h}=k(),g=j(),[b,f]=w.useState(""),[C,y]=w.useState(o),z=w.useRef(null),T=I(e),L=w.useMemo((()=>T===v.Emoji?re:se),[T]),O=N({placement:a,modal:!0,unstable_offset:[0,0]}),{hide:q,show:F,visible:H}=O,A=Q({selectedId:L}),R=S(O.visible),W=g?h:408,U=g?h-16:W,_=w.useCallback((()=>{A.select(L)}),[L]),X=w.useCallback((e=>{q();const o=I(e)===v.SVG?C:null;r(e,o)}),[q,r,C]),J=w.useCallback((o=>{y(o);I(e)===v.SVG&&r(e,o)}),[e,r]),K=w.useCallback((()=>{q(),r(null,null)}),[q,r]),Z=w.useCallback((e=>{e.stopPropagation(),H?q():F()}),[q,F,H]);return w.useEffect((()=>{H&&!R?l?.():!H&&R&&(d?.(),f(""),_())}),[H,R,l,d,_]),V(z,(e=>{O.visible&&!O.unstable_disclosureRef.current?.contains(e.target)&&(e.stopPropagation(),e.preventDefault(),O.hide())}),{capture:!0}),m(P,{children:[c(M,{...O,children:a=>c(G,{...a,"aria-label":u("Show menu"),className:i,size:t,onClick:Z,$borderOnHover:p,children:T&&e?c(E,{value:e,color:o,size:t,initial:n}):c(le,{color:$.placeholder,size:t})})}),c(B,{...O,ref:z,width:W,shrink:!0,"aria-label":u("Icon Picker"),onClick:e=>e.stopPropagation(),hideOnClickOutside:!1,children:m(P,{children:[m(de,{justify:"space-between",align:"center",children:[m(Y,{...A,children:[c(pe,{...A,id:se,"aria-label":u("Icons"),$active:A.selectedId===se,children:u("Icons")}),c(pe,{...A,id:re,"aria-label":u("Emojis"),$active:A.selectedId===re,children:u("Emojis")})]}),s&&e&&c(ce,{onClick:K,children:u("Remove")})]}),c(ue,{...A,children:c(IconPanel,{panelWidth:U,initial:n??"?",color:C,query:b,panelActive:O.visible&&A.selectedId===se,onIconChange:X,onColorChange:J,onQueryChange:f})}),c(ue,{...A,children:c(D,{panelWidth:U,query:b,panelActive:O.visible&&A.selectedId===re,onEmojiChange:X,onQueryChange:f})})]})})]})}));export{me as default};
